/*! jindo-component - v1.14.0 - 2014-12-23
* http://jindo.dev.naver.com/jindo_home/Component.html
* Copyright (c) 2014 ; Licensed LGPL v2 */
jindo.Component=jindo.$Class({_htEventHandler:null,_htOption:null,$init:function(){this._htEventHandler={},this._htOption={},this._htOption._htSetter={},this.constructor.$count=(this.constructor.$count||0)+1},option:function(a,b){switch(typeof a){case"undefined":var c={};for(var d in this._htOption)"htCustomEventHandler"!=d&&"_htSetter"!=d&&(c[d]=this._htOption[d]);return c;case"string":if("undefined"==typeof b)return this._htOption[a];if("htCustomEventHandler"==a){if("undefined"!=typeof this._htOption[a])return this;this.attach(b)}this._htOption[a]=b,"function"==typeof this._htOption._htSetter[a]&&this._htOption._htSetter[a](b);break;case"object":for(var e in a){if("htCustomEventHandler"==e){if("undefined"!=typeof this._htOption[e])continue;this.attach(a[e])}"_htSetter"!==e&&(this._htOption[e]=a[e]),"function"==typeof this._htOption._htSetter[e]&&this._htOption._htSetter[e](a[e])}}return this},optionSetter:function(a,b){switch(typeof a){case"undefined":return this._htOption._htSetter;case"string":if("undefined"==typeof b)return this._htOption._htSetter[a];this._htOption._htSetter[a]=jindo.$Fn(b,this).bind();break;case"object":for(var c in a)this._htOption._htSetter[c]=jindo.$Fn(a[c],this).bind()}return this},fireEvent:function(a,b){b=b||{};var c=this["on"+a],d=this._htEventHandler[a]||[],e="function"==typeof c,f=d.length>0;if(!e&&!f)return!0;d=d.concat(),b.sType=a,"undefined"==typeof b._aExtend&&(b._aExtend=[],b.stop=function(){b._aExtend.length>0&&(b._aExtend[b._aExtend.length-1].bCanceled=!0)}),b._aExtend.push({sType:a,bCanceled:!1});var g,h,i=[b];for(g=2,h=arguments.length;h>g;g++)i.push(arguments[g]);if(e&&c.apply(this,i),f){var j;for(g=0,j;j=d[g];g++)j.apply(this,i)}return!b._aExtend.pop().bCanceled},attach:function(a,b){if(1==arguments.length)return jindo.$H(arguments[0]).forEach(jindo.$Fn(function(a,b){this.attach(b,a)},this).bind()),this;var c=this._htEventHandler[a];return"undefined"==typeof c&&(c=this._htEventHandler[a]=[]),c.push(b),this},detach:function(a,b){if(1==arguments.length)return jindo.$H(arguments[0]).forEach(jindo.$Fn(function(a,b){this.detach(b,a)},this).bind()),this;var c=this._htEventHandler[a];if(c)for(var d,e=0;d=c[e];e++)if(d===b){c=c.splice(e,1);break}return this},detachAll:function(a){var b=this._htEventHandler;if(arguments.length)return"undefined"==typeof b[a]?this:(delete b[a],this);for(var c in b)delete b[c];return this}}),jindo.Component.factory=function(a,b){var c,d=[];"undefined"==typeof b&&(b={});for(var e,f=0;e=a[f];f++)c=new this(e,b),d[d.length]=c;return d},jindo.Component.getInstance=function(){throw new Error("JC 1.11.0 or JMC 1.13.0 later, getInstance method of Component is not longer supported.")},jindo.Component.VERSION="1.14.0",jindo.AjaxHistory=jindo.$Class({_htEventHandler:{},_htHistoryData:{},_oAgent:null,_welIFrame:null,_nIntervalId:0,_sCheckType:"",_sComponentId:"",$static:{checkIFrameChange:function(a){var b=jindo.$S(a.search.substring(1)).parseString();this._aInstances[0]._checkLocationChange(encodeURIComponent(b.hash))}},$init:function(a){this._oAgent=jindo.$Agent().navigator(),this._sComponentId="AjaxHistory"+(new Date).getTime(),this.option({sIFrameUrl:"history.html",nCheckInterval:100}),this.option(a||{}),(this.constructor._aInstances=this.constructor._aInstances||[]).push(this)},initialize:function(){var a=this._getLocationHash();if(this._oAgent.ie&&(document.documentMode||this._oAgent.version)>=8&&"Standards"==jindo.$Document().renderingMode()||this._oAgent.firefox&&this._oAgent.version>=3.6||this._oAgent.chrome&&this._oAgent.version>3||this._oAgent.safari&&this._oAgent.version>=5||this._oAgent.opera&&this._oAgent.version>=10.6?(this._htEventHandler.hashchange=jindo.$Fn(this._checkLocationChange,this).attach(window,"hashchange"),this._sCheckType="hashchangeevent"):this._oAgent.ie?(this._welIFrame=jindo.$Element("<IFRAME>"),this._welIFrame.hide(),this._welIFrame.appendTo(document.body),this._sCheckType="iframe"):(this._nIntervalId=setInterval(jindo.$Fn(this._checkLocationChange,this).bind(),this.option("nCheckInterval")),this._sCheckType="setinterval"),a&&"%7B%7D"!=a)"iframe"==this._sCheckType?this._welIFrame.$value().src=this.option("sIFrameUrl")+"?hash="+a:(this._htHistoryData=this._getDecodedData(a),this.fireEvent("change",{htHistoryData:this._htHistoryData}));else{var b=this;if(this._oAgent.ie&&(document.documentMode||this._oAgent.version)<8){var c=this._welIFrame.$value();c.onreadystatechange=function(){"complete"==c.readyState&&(b.fireEvent("load"),c.onreadystatechange=function(){})},c.src=this.option("sIFrameUrl")}else setTimeout(function(){b.fireEvent("load")},0)}return this},getComponentId:function(){return this._sComponentId},_getLocationHash:function(){var a=jindo.$Agent().navigator();return a.firefox?encodeURIComponent(location.hash.substring(1)):location.hash.substring(1)||"%7B%7D"},_setLocationHash:function(a){location.hash="%7B%7D"==a?"":a},addHistory:function(a){if(a&&"object"==typeof a&&jindo.$H(a).length()>0){this._htHistoryData=jindo.$Json(jindo.$Json(a).toString()).toObject();var b=this._getEncodedData(a);return this._getLocationHash()!=b?(this._setLocationHash(b),"iframe"==this._sCheckType&&(this._welIFrame.$value().src=this.option("sIFrameUrl")+"?hash="+b),!0):!1}return!1},_checkLocationChange:function(a){a="undefined"==a?"%7B%7D":a,a=a&&"string"==typeof a?a:this._getLocationHash();var b=this._getDecodedData(a);this._compareData(this._htHistoryData,b)||(this._htHistoryData=b,"iframe"==this._sCheckType&&this._setLocationHash(a),this.fireEvent("change",{htHistoryData:this._htHistoryData}))},_getEncodedData:function(a){return a?encodeURIComponent("object"==typeof JSON&&"function"==typeof JSON.stringify?JSON.stringify(a):jindo.$Json(a).toString()):""},_getDecodedData:function(a){try{if(a){var b=decodeURIComponent(a);return"object"==typeof JSON&&"function"==typeof JSON.parse?JSON.parse(b):jindo.$Json(b).toObject()}}catch(c){}return{}},_compareData:function(a,b){if(!a||!b)return!1;var c=a instanceof Array?jindo.$A(a):jindo.$H(a),d=b instanceof Array?jindo.$A(b):jindo.$H(b);if(c.length()!=d.length())return!1;var e=!0,f=arguments.callee;return c.forEach(function(a,c){if("object"==typeof a){if(!f(a,b[c]))return void(e=!1)}else if(a!=b[c])return void(e=!1)}),e},destroy:function(){"hashchangeevent"==this._sCheckType?this._htEventHandler.hashchange.detach(window,"hashchange"):"iframe"==this._sCheckType?this._welIFrame.leave():clearInterval(this._nIntervalId),this._htEventHandler=null,this._htHistoryData=null,this._oAgent=null,this._welIFrame=null,this._nIntervalId=null,this._sCheckType=null,this._sComponentId=null;var a=this.constructor._aInstances||[],b=jindo.$A(a).indexOf(this);b>-1&&a.splice(b,1)}}).extend(jindo.Component),jindo.UIComponent=jindo.$Class({$init:function(){this._bIsActivating=!1},isActivating:function(){return this._bIsActivating},activate:function(){return this.isActivating()?this:(this._bIsActivating=!0,arguments.length>0?this._onActivate.apply(this,arguments):this._onActivate(),this)},deactivate:function(){return this.isActivating()?(this._bIsActivating=!1,arguments.length>0?this._onDeactivate.apply(this,arguments):this._onDeactivate(),this):this}}).extend(jindo.Component),jindo.Cache=jindo.$Class({$init:function(a){this._htCacheData={},this._htExpireTime={},this._waKeyList=jindo.$A(),this.option({nCacheLimit:50,nExpireTime:0}),this.option(a)},add:function(a,b,c){if(a&&b){this._checkCacheExpire(),this._checkCacheLimit();var d=this._makeKey(a);if(d)return this._htCacheData[d]=b,this._htExpireTime[d]=this._getExpireTime(c),this._waKeyList.push(d),!0}return!1},remove:function(a){if(a){var b=this._makeKey(a);if(this._htCacheData[b])return this._waKeyList=this._waKeyList.refuse(b),delete this._htExpireTime[b],delete this._htCacheData[b],!0}return!1},clear:function(){this._htCacheData={},this._htExpireTime={},this._waKeyList=jindo.$A()},get:function(a){if(a){var b=this._makeKey(a);if(this.check(a))return this._htCacheData[b]}return null},check:function(a){if(a){var b=this._makeKey(a);if(this._htCacheData[b]&&this._checkCacheExpire(b))return!0}return!1},_checkCacheLimit:function(){this._waKeyList.length()==this.option("nCacheLimit")&&this.remove(this._waKeyList.get(0))},_checkCacheExpire:function(a){if(a){var b=this._getTime();return 0===this._htExpireTime[a]||b<this._htExpireTime[a]?!0:(this.remove(jindo.$S(a).parseString()),!1)}for(var c=0,d=this._waKeyList.length();d>c;c++)return this._checkCacheExpire(this._waKeyList.get(c))},_getExpireTime:function(a){return a?this._getTime()+1e3*a:this.option("nExpireTime")?this._getTime()+1e3*this.option("nExpireTime"):0},_makeKey:function(a){if(!a)return"";if("string"==typeof a)return a;try{return jindo.$H(a).toQueryString()}catch(b){return""}},_getTime:function(){return+new Date},destroy:function(){this._waKeyList=null,this._htCacheData=null,this._htExpireTime=null}}).extend(jindo.Component),jindo.Calendar=jindo.$Class({$init:function(a,b){var c=this.constructor.getToday();this.setToday(c.nYear,c.nMonth,c.nDate),this._elLayer=jindo.$(a),this._htDefaultOption={sClassPrefix:"calendar-",nYear:this._htToday.nYear,nMonth:this._htToday.nMonth,nDate:this._htToday.nDate,sTitleFormat:"yyyy-mm",sYearTitleFormat:"yyyy",sMonthTitleFormat:"m",aMonthTitle:["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],bDrawOnload:!0},this.option(this._htDefaultOption),this.option(b||{}),this._assignHTMLElements(),this.activate(),this.setDate(this.option("nYear"),this.option("nMonth"),this.option("nDate")),this.option("bDrawOnload")&&this.draw()},getBaseElement:function(){return this._elLayer},getDate:function(){return this._htDate},getDateOfElement:function(a){var b=jindo.$A(this._aDateContainerElement).indexOf(a);return b>-1?this._aMetaData[b]:null},setToday:function(a,b,c){return this._htToday||(this._htToday={}),this._htToday.nYear=a,this._htToday.nMonth=b,this._htToday.nDate=c,this},getToday:function(){return{nYear:this._htToday.nYear,nMonth:this._htToday.nMonth,nDate:this._htToday.nDate}},setDate:function(a,b,c){this._htDate={nYear:a,nMonth:1*b,nDate:1*c}},getShownDate:function(){return this._getShownDate()},_getShownDate:function(){return this.htShownDate||this.getDate()},_setShownDate:function(a,b){this.htShownDate={nYear:a,nMonth:1*b,nDate:1}},_assignHTMLElements:function(){var a=this.option("sClassPrefix"),b=this.getBaseElement();(this.elBtnPrevYear=jindo.$$.getSingle("."+a+"btn-prev-year",b))&&(this.wfPrevYear=jindo.$Fn(function(a){a.stop(jindo.$Event.CANCEL_DEFAULT),this.draw(-1,0,!0)},this)),(this.elBtnPrevMonth=jindo.$$.getSingle("."+a+"btn-prev-mon",b))&&(this.wfPrevMonth=jindo.$Fn(function(a){a.stop(jindo.$Event.CANCEL_DEFAULT),this.draw(0,-1,!0)},this)),(this.elBtnNextMonth=jindo.$$.getSingle("."+a+"btn-next-mon",b))&&(this.wfNextMonth=jindo.$Fn(function(a){a.stop(jindo.$Event.CANCEL_DEFAULT),this.draw(0,1,!0)},this)),(this.elBtnNextYear=jindo.$$.getSingle("."+a+"btn-next-year",b))&&(this.wfNextYear=jindo.$Fn(function(a){a.stop(jindo.$Event.CANCEL_DEFAULT),this.draw(1,0,!0)},this)),this.elTitle=jindo.$$.getSingle("."+a+"title",b),this.elTitleYear=jindo.$$.getSingle("."+a+"title-year",b),this.elTitleMonth=jindo.$$.getSingle("."+a+"title-month",b);var c=jindo.$$.getSingle("."+a+"week",b);this.elWeekTemplate=c.cloneNode(!0),this.elWeekAppendTarget=c.parentNode},_setCalendarTitle:function(a,b,c){10>b&&(b=("0"+1*b).toString());var d,e=this.elTitle,f=this.option("sTitleFormat");if("undefined"!=typeof c)switch(c){case"year":e=this.elTitleYear,f=this.option("sYearTitleFormat"),d=f.replace(/yyyy/g,a).replace(/y/g,a.toString().substr(2,2));break;case"month":e=this.elTitleMonth,f=this.option("sMonthTitleFormat"),d=f.replace(/mm/g,b).replace(/m/g,1*b).replace(/M/g,this.option("aMonthTitle")[b-1])}else d=f.replace(/yyyy/g,a).replace(/y/g,a.toString().substr(2,2)).replace(/mm/g,b).replace(/m/g,1*b).replace(/M/g,this.option("aMonthTitle")[b-1]);jindo.$Element(e).text(d)},draw:function(a,b,c){var d=this.option("sClassPrefix"),e=this.getDate(),f=this._getShownDate();if(f&&"undefined"!=typeof c&&c){var g=this.constructor.getRelativeDate(a,b,0,f);a=g.nYear,b=g.nMonth}else"undefined"==typeof a&&"undefined"==typeof b&&"undefined"==typeof c?(a=e.nYear,b=e.nMonth):(a=a||f.nYear,b=b||f.nMonth);if(this.fireEvent("beforeDraw",{nYear:a,nMonth:b})){this.elTitle&&this._setCalendarTitle(a,b),this.elTitleYear&&this._setCalendarTitle(a,b,"year"),this.elTitleMonth&&this._setCalendarTitle(a,b,"month"),this._clear(jindo.Calendar.getWeeks(a,b)),this._setShownDate(a,b);var h,i,j,k,l,m,n,o,p,q=this.getToday(),r=this.constructor.getFirstDay(a,b),s=this.constructor.getLastDay(a,b),t=this.constructor.getLastDate(a,b),u=0,v=this.constructor.getRelativeDate(0,-1,0,{nYear:a,nMonth:b,nDate:1}),w=this.constructor.getRelativeDate(0,1,0,{nYear:a,nMonth:b,nDate:1}),x=this.constructor.getLastDate(v.nYear,v.nMonth),y=[],z=this.constructor.getWeeks(a,b);for(p=0;z>p;p++)o=this.elWeekTemplate.cloneNode(!0),jindo.$Element(o).appendTo(this.elWeekAppendTarget),this._aWeekElement.push(o);if(this._aDateElement=jindo.$$("."+d+"date",this.elWeekAppendTarget),this._aDateContainerElement=jindo.$$("."+d+"week > *",this.elWeekAppendTarget),r>0)for(p=x-r;x>p;p++)y.push(p+1);for(p=1;t+1>p;p++)y.push(p);for(n=y.length-1,p=1;7-s>p;p++)y.push(p);for(p=0;p<y.length;p++)h=!1,i=!1,j=jindo.$Element(this._aDateContainerElement[p]),k=a,l=b,r>p?(h=!0,j.addClass(d+"prev-mon"),k=v.nYear,l=v.nMonth):p>n?(i=!0,j.addClass(d+"next-mon"),k=w.nYear,l=w.nMonth):(k=a,l=b),0===u&&j.addClass(d+"sun"),6==u&&j.addClass(d+"sat"),k==q.nYear&&1*l==q.nMonth&&y[p]==q.nDate&&j.addClass(d+"today"),m={elDate:this._aDateElement[p],elDateContainer:j.$value(),nYear:k,nMonth:l,nDate:y[p],bPrevMonth:h,bNextMonth:i,sHTML:y[p]},jindo.$Element(m.elDate).html(m.sHTML.toString()),this._aMetaData.push({nYear:k,nMonth:l,nDate:y[p]}),u=(u+1)%7,this.fireEvent("draw",m);this.fireEvent("afterDraw",{nYear:a,nMonth:b})}},_clear:function(){this._aMetaData=[],this._aWeekElement=[],jindo.$Element(this.elWeekAppendTarget).empty()},attachEvent:function(){this.activate()},detachEvent:function(){this.deactivate()},_onActivate:function(){this.elBtnPrevYear&&this.wfPrevYear.attach(this.elBtnPrevYear,"click"),this.elBtnPrevMonth&&this.wfPrevMonth.attach(this.elBtnPrevMonth,"click"),this.elBtnNextMonth&&this.wfNextMonth.attach(this.elBtnNextMonth,"click"),this.elBtnNextYear&&this.wfNextYear.attach(this.elBtnNextYear,"click")},_onDeactivate:function(){this.elBtnPrevYear&&this.wfPrevYear.detach(this.elBtnPrevYear,"click"),this.elBtnPrevMonth&&this.wfPrevMonth.detach(this.elBtnPrevMonth,"click"),this.elBtnNextMonth&&this.wfNextMonth.detach(this.elBtnNextMonth,"click"),this.elBtnNextYear&&this.wfNextYear.detach(this.elBtnNextYear,"click")}}).extend(jindo.UIComponent),jindo.Calendar.setToday=function(a,b,c){return this._htToday||(this._htToday={}),this._htToday.nYear=a,this._htToday.nMonth=b,this._htToday.nDate=c,this},jindo.Calendar.getToday=function(){var a=this._htToday||this.getDateHashTable(new Date);return{nYear:a.nYear,nMonth:a.nMonth,nDate:a.nDate}},jindo.Calendar.getDateObject=function(a){return 3==arguments.length?new Date(arguments[0],arguments[1]-1,arguments[2]):new Date(a.nYear,a.nMonth-1,a.nDate)},jindo.Calendar.getDateHashTable=function(a){return 3==arguments.length?{nYear:arguments[0],nMonth:arguments[1],nDate:arguments[2]}:(arguments.length<=1&&(a=a||new Date),{nYear:a.getFullYear(),nMonth:a.getMonth()+1,nDate:a.getDate()})},jindo.Calendar.getTime=function(a){return this.getDateObject(a).getTime()},jindo.Calendar.getFirstDay=function(a,b){return new Date(a,b-1,1).getDay()},jindo.Calendar.getLastDay=function(a,b){return new Date(a,b,0).getDay()},jindo.Calendar.getLastDate=function(a,b){return new Date(a,b,0).getDate()},jindo.Calendar.getWeeks=function(a,b){var c=this.getFirstDay(a,b),d=this.getLastDate(a,b);return Math.ceil((c+d)/7)},jindo.Calendar.getRelativeDate=function(a,b,c,d){var e=jindo.$Date(new Date(d.nYear,d.nMonth,d.nDate)),f={1:31,2:28,3:31,4:30,5:31,6:30,7:31,8:31,9:30,10:31,11:30,12:31};e.isLeapYear()&&(f={1:31,2:29,3:31,4:30,5:31,6:30,7:31,8:31,9:30,10:31,11:30,12:31}),f[d.nMonth]==d.nDate&&(d.nDate=f[d.nMonth+b]);this.getDateHashTable(new Date(d.nYear+a,d.nMonth+b-1,d.nDate+c));return this.getDateHashTable(new Date(d.nYear+a,d.nMonth+b-1,d.nDate+c))},jindo.Calendar.isValidDate=function(a,b,c){return 12>=b&&c<=this.getLastDate(a,b)?!0:!1},jindo.Calendar.isPast=function(a,b){return this.getTime(a)<this.getTime(b)?!0:!1},jindo.Calendar.isFuture=function(a,b){return this.getTime(a)>this.getTime(b)?!0:!1},jindo.Calendar.isSameDate=function(a,b){return this.getTime(a)==this.getTime(b)?!0:!1},jindo.Calendar.isBetween=function(a,b,c){return this.isFuture(a,c)||this.isPast(a,b)?!1:!0};var G_vmlCanvasManager;document.createElement("canvas").getContext||!function(){function a(){return this.context_||(this.context_=new j(this))}function b(a,b){var c=x.call(arguments,2);return function(){return a.apply(b,c.concat(x.call(arguments)))}}function c(a){var b=a.srcElement;switch(a.propertyName){case"width":b.style.width=b.attributes.width.nodeValue+"px",b.getContext().clearRect();break;case"height":b.style.height=b.attributes.height.nodeValue+"px",b.getContext().clearRect()}}function d(a){var b=a.srcElement;b.firstChild&&(b.firstChild.style.width=b.clientWidth+"px",b.firstChild.style.height=b.clientHeight+"px")}function e(){return[[1,0,0],[0,1,0],[0,0,1]]}function f(a,b){for(var c=e(),d=0;3>d;d++)for(var f=0;3>f;f++){for(var g=0,h=0;3>h;h++)g+=a[d][h]*b[h][f];c[d][f]=g}return c}function g(a,b){b.fillStyle=a.fillStyle,b.lineCap=a.lineCap,b.lineJoin=a.lineJoin,b.lineWidth=a.lineWidth,b.miterLimit=a.miterLimit,b.shadowBlur=a.shadowBlur,b.shadowColor=a.shadowColor,b.shadowOffsetX=a.shadowOffsetX,b.shadowOffsetY=a.shadowOffsetY,b.strokeStyle=a.strokeStyle,b.globalAlpha=a.globalAlpha,b.arcScaleX_=a.arcScaleX_,b.arcScaleY_=a.arcScaleY_,b.lineScale_=a.lineScale_}function h(a){var b,c=1;if(a=String(a),"rgb"==a.substring(0,3)){var d=a.indexOf("(",3),e=a.indexOf(")",d+1),f=a.substring(d+1,e).split(",");b="#";for(var g=0;3>g;g++)b+=y[Number(f[g])];4==f.length&&"a"==a.substr(3,1)&&(c=f[3])}else b=a;return{color:b,alpha:c}}function i(a){switch(a){case"butt":return"flat";case"round":return"round";case"square":break;default:return"square"}}function j(a){this.m_=e(),this.mStack_=[],this.aStack_=[],this.currentPath_=[],this.strokeStyle="#000",this.fillStyle="#000",this.lineWidth=1,this.lineJoin="miter",this.lineCap="butt",this.miterLimit=1*v,this.globalAlpha=1,this.canvas=a;var b=a.ownerDocument.createElement("div");b.style.width=a.clientWidth+"px",b.style.height=a.clientHeight+"px",a.appendChild(b),this.element_=b,this.arcScaleX_=1,this.arcScaleY_=1,this.lineScale_=1}function k(a,b,c,d){a.currentPath_.push({type:"bezierCurveTo",cp1x:b.x,cp1y:b.y,cp2x:c.x,cp2y:c.y,x:d.x,y:d.y}),a.currentX_=d.x,a.currentY_=d.y}function l(a){for(var b=0;3>b;b++)for(var c=0;2>c;c++)if(!isFinite(a[b][c])||isNaN(a[b][c]))return!1;return!0}function m(a,b,c){if(l(b)&&(a.m_=b,c)){var d=b[0][0]*b[1][1]-b[0][1]*b[1][0];a.lineScale_=u(t(d))}}function n(a){this.type_=a,this.x0_=0,this.y0_=0,this.r0_=0,this.x1_=0,this.y1_=0,this.r1_=0,this.colors_=[]}function o(){}for(var p=Math,q=p.round,r=p.sin,s=p.cos,t=p.abs,u=p.sqrt,v=10,w=v/2,x=Array.prototype.slice,y=[],z=0;16>z;z++)for(var A=0;16>A;A++)y[16*z+A]=z.toString(16)+A.toString(16);var B={init:function(a){if(/MSIE/.test(navigator.userAgent)&&!window.opera){var c=a||document;c.createElement("canvas"),c.attachEvent("onreadystatechange",b(this.init_,this,c))}},init_:function(a){if(a.namespaces.g_vml_||a.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML"),a.namespaces.g_o_||a.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML"),!a.styleSheets.ex_canvas_){var b=a.createStyleSheet();b.owningElement.id="ex_canvas_",b.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}g_vml_\\:*{behavior:url(#default#VML)}g_o_\\:*{behavior:url(#default#VML)}"}for(var c=a.getElementsByTagName("canvas"),d=0;d<c.length;d++)this.initElement(c[d])},initElement:function(b){if(!b.getContext){b.getContext=a,b.innerHTML="",b.attachEvent("onpropertychange",c),b.attachEvent("onresize",d);var e=b.attributes;e.width&&e.width.specified?b.style.width=e.width.nodeValue+"px":b.width=b.clientWidth,e.height&&e.height.specified?b.style.height=e.height.nodeValue+"px":b.height=b.clientHeight}return b}};B.init();var C=j.prototype;C.clearRect=function(){this.element_.innerHTML=""},C.beginPath=function(){this.currentPath_=[]},C.moveTo=function(a,b){var c=this.getCoords_(a,b);this.currentPath_.push({type:"moveTo",x:c.x,y:c.y}),this.currentX_=c.x,this.currentY_=c.y},C.lineTo=function(a,b){var c=this.getCoords_(a,b);this.currentPath_.push({type:"lineTo",x:c.x,y:c.y}),this.currentX_=c.x,this.currentY_=c.y},C.bezierCurveTo=function(a,b,c,d,e,f){var g=this.getCoords_(e,f),h=this.getCoords_(a,b),i=this.getCoords_(c,d);k(this,h,i,g)},C.quadraticCurveTo=function(a,b,c,d){var e=this.getCoords_(a,b),f=this.getCoords_(c,d),g={x:this.currentX_+2/3*(e.x-this.currentX_),y:this.currentY_+2/3*(e.y-this.currentY_)},h={x:g.x+(f.x-this.currentX_)/3,y:g.y+(f.y-this.currentY_)/3};k(this,g,h,f)},C.arc=function(a,b,c,d,e,f){c*=v;var g=f?"at":"wa",h=a+s(d)*c-w,i=b+r(d)*c-w,j=a+s(e)*c-w,k=b+r(e)*c-w;h!=j||f||(h+=.125);var l=this.getCoords_(a,b),m=this.getCoords_(h,i),n=this.getCoords_(j,k);this.currentPath_.push({type:g,x:l.x,y:l.y,radius:c,xStart:m.x,yStart:m.y,xEnd:n.x,yEnd:n.y})},C.rect=function(a,b,c,d){this.moveTo(a,b),this.lineTo(a+c,b),this.lineTo(a+c,b+d),this.lineTo(a,b+d),this.closePath()},C.strokeRect=function(a,b,c,d){var e=this.currentPath_;this.beginPath(),this.moveTo(a,b),this.lineTo(a+c,b),this.lineTo(a+c,b+d),this.lineTo(a,b+d),this.closePath(),this.stroke(),this.currentPath_=e},C.fillRect=function(a,b,c,d){var e=this.currentPath_;this.beginPath(),this.moveTo(a,b),this.lineTo(a+c,b),this.lineTo(a+c,b+d),this.lineTo(a,b+d),this.closePath(),this.fill(),this.currentPath_=e},C.createLinearGradient=function(a,b,c,d){var e=new n("gradient");return e.x0_=a,e.y0_=b,e.x1_=c,e.y1_=d,e},C.createRadialGradient=function(a,b,c,d,e,f){var g=new n("gradientradial");return g.x0_=a,g.y0_=b,g.r0_=c,g.x1_=d,g.y1_=e,g.r1_=f,g},C.drawImage=function(a){var b,c,d,e,f,g,h,i,j=a.runtimeStyle.width,k=a.runtimeStyle.height;a.runtimeStyle.width="auto",a.runtimeStyle.height="auto";var l=a.width,m=a.height;if(a.runtimeStyle.width=j,a.runtimeStyle.height=k,3==arguments.length)b=arguments[1],c=arguments[2],f=g=0,h=d=l,i=e=m;else if(5==arguments.length)b=arguments[1],c=arguments[2],d=arguments[3],e=arguments[4],f=g=0,h=l,i=m;else{if(9!=arguments.length)throw Error("Invalid number of arguments");f=arguments[1],g=arguments[2],h=arguments[3],i=arguments[4],b=arguments[5],c=arguments[6],d=arguments[7],e=arguments[8]}var n=this.getCoords_(b,c),o=[],r=10,s=10;if(o.push(" <g_vml_:group",' coordsize="',v*r,",",v*s,'"',' coordorigin="0,0"',' style="width:',r,"px;height:",s,"px;position:absolute;"),1!=this.m_[0][0]||this.m_[0][1]){var t=[];t.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",q(n.x/v),",","Dy=",q(n.y/v),"");var u=n,w=this.getCoords_(b+d,c),x=this.getCoords_(b,c+e),y=this.getCoords_(b+d,c+e);u.x=p.max(u.x,w.x,x.x,y.x),u.y=p.max(u.y,w.y,x.y,y.y),o.push("padding:0 ",q(u.x/v),"px ",q(u.y/v),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",t.join(""),", sizingmethod='clip');")}else o.push("top:",q(n.y/v),"px;left:",q(n.x/v),"px;");o.push(' ">','<g_vml_:image src="',a.src,'"',' style="width:',v*d,"px;"," height:",v*e,'px;"',' cropleft="',f/l,'"',' croptop="',g/m,'"',' cropright="',(l-f-h)/l,'"',' cropbottom="',(m-g-i)/m,'"'," />","</g_vml_:group>"),this.element_.insertAdjacentHTML("BeforeEnd",o.join(""))},C.stroke=function(a){var b=[],c=h(a?this.fillStyle:this.strokeStyle),d=c.color,e=c.alpha*this.globalAlpha,f=10,g=10;b.push("<g_vml_:shape",' filled="',!!a,'"',' style="position:absolute;width:',f,"px;height:",g,'px;"',' coordorigin="0 0" coordsize="',v*f," ",v*g,'"',' stroked="',!a,'"',' path="');var j,k={x:null,y:null},l={x:null,y:null};for(j=0;j<this.currentPath_.length;j++){var m,n=this.currentPath_[j];switch(n.type){case"moveTo":m=n,b.push(" m ",q(n.x),",",q(n.y));break;case"lineTo":b.push(" l ",q(n.x),",",q(n.y));break;case"close":b.push(" x "),n=null;break;case"bezierCurveTo":b.push(" c ",q(n.cp1x),",",q(n.cp1y),",",q(n.cp2x),",",q(n.cp2y),",",q(n.x),",",q(n.y));break;case"at":case"wa":b.push(" ",n.type," ",q(n.x-this.arcScaleX_*n.radius),",",q(n.y-this.arcScaleY_*n.radius)," ",q(n.x+this.arcScaleX_*n.radius),",",q(n.y+this.arcScaleY_*n.radius)," ",q(n.xStart),",",q(n.yStart)," ",q(n.xEnd),",",q(n.yEnd))}n&&((null===k.x||n.x<k.x)&&(k.x=n.x),(null===l.x||n.x>l.x)&&(l.x=n.x),(null===k.y||n.y<k.y)&&(k.y=n.y),(null===l.y||n.y>l.y)&&(l.y=n.y))}if(b.push(' ">'),a)if("object"==typeof this.fillStyle){var o,r=this.fillStyle,s=0,t={x:0,y:0},u=0,w=1;if("gradient"==r.type_){var x=r.x0_/this.arcScaleX_,y=r.y0_/this.arcScaleY_,z=r.x1_/this.arcScaleX_,A=r.y1_/this.arcScaleY_;o=this.getCoords_(x,y);var B=this.getCoords_(z,A),C=B.x-o.x,D=B.y-o.y;s=180*Math.atan2(C,D)/Math.PI,0>s&&(s+=360),1e-6>s&&(s=0)}else{o=this.getCoords_(r.x0_,r.y0_);var E=l.x-k.x,F=l.y-k.y;t={x:(o.x-k.x)/E,y:(o.y-k.y)/F},E/=this.arcScaleX_*v,F/=this.arcScaleY_*v;var G=p.max(E,F);u=2*r.r0_/G,w=2*r.r1_/G-u}var H=r.colors_;H.sort(function(a,b){return a.offset-b.offset});var I=H.length,J=H[0].color,K=H[I-1].color,L=H[0].alpha*this.globalAlpha,M=H[I-1].alpha*this.globalAlpha,N=[];for(j=0;I>j;j++){var O=H[j];N.push(O.offset*w+u+" "+O.color)}b.push('<g_vml_:fill type="',r.type_,'"',' method="none" focus="100%"',' color="',J,'"',' color2="',K,'"',' colors="',N.join(","),'"',' opacity="',M,'"',' g_o_:opacity2="',L,'"',' angle="',s,'"',' focusposition="',t.x,",",t.y,'" />')}else b.push('<g_vml_:fill color="',d,'" opacity="',e,'" />');else{var P=this.lineScale_*this.lineWidth;1>P&&(e*=P),b.push("<g_vml_:stroke",' opacity="',e,'"',' joinstyle="',this.lineJoin,'"',' miterlimit="',this.miterLimit,'"',' endcap="',i(this.lineCap),'"',' weight="',P,'px"',' color="',d,'" />')}b.push("</g_vml_:shape>"),this.element_.insertAdjacentHTML("beforeEnd",b.join(""))},C.fill=function(){this.stroke(!0)},C.closePath=function(){this.currentPath_.push({type:"close"})},C.getCoords_=function(a,b){var c=this.m_;return{x:v*(a*c[0][0]+b*c[1][0]+c[2][0])-w,y:v*(a*c[0][1]+b*c[1][1]+c[2][1])-w}},C.save=function(){var a={};g(this,a),this.aStack_.push(a),this.mStack_.push(this.m_),this.m_=f(e(),this.m_)},C.restore=function(){g(this.aStack_.pop(),this),this.m_=this.mStack_.pop()},C.translate=function(a,b){var c=[[1,0,0],[0,1,0],[a,b,1]];m(this,f(c,this.m_),!1)},C.rotate=function(a){var b=s(a),c=r(a),d=[[b,c,0],[-c,b,0],[0,0,1]];m(this,f(d,this.m_),!1)},C.scale=function(a,b){this.arcScaleX_*=a,this.arcScaleY_*=b;var c=[[a,0,0],[0,b,0],[0,0,1]];m(this,f(c,this.m_),!0)},C.transform=function(a,b,c,d,e,g){var h=[[a,b,0],[c,d,0],[e,g,1]];m(this,f(h,this.m_),!0)},C.setTransform=function(a,b,c,d,e,f){var g=[[a,b,0],[c,d,0],[e,f,1]];m(this,g,!0)},C.clip=function(){},C.arcTo=function(){},C.createPattern=function(){return new o},n.prototype.addColorStop=function(a,b){b=h(b),this.colors_.push({offset:a,color:b.color,alpha:b.alpha})},G_vmlCanvasManager=B,CanvasRenderingContext2D=j,CanvasGradient=n,CanvasPattern=o}(),jindo.Canvas=jindo.$Class({$init:function(a){"undefined"==typeof a&&(a=jindo.Canvas.create()),this._el=a,this._elContainer=this._el.parentNode,this._oContext=jindo.Canvas.getContext(a)},getElement:function(){return this._el},getContainer:function(){return this._elContainer},width:function(a){return"number"==typeof a?(this._el.width=a,this):this._el.width},height:function(a){return"number"==typeof a?(this._el.height=a,this):this._el.height},getContext:function(){return this._oContext},clear:function(){return this._oContext.clearRect(0,0,this._el.width,this._el.height),this},_merge:function(a,b){for(var c in b)a[c]=b[c]},drawLine:function(a,b,c){var d,e=this._oContext,f=0,g=a.length;if(b=b||{},g>1){if("undefined"==typeof c&&(c=!0),e.save(),this._merge(e,b),e.beginPath(),c)if(e.lineWidth%2===1&&(f=.5),2===g)a[0][0]===a[1][0]&&(e.moveTo(Math.round(a[0][0])+f,a[0][1]),e.lineTo(Math.round(a[1][0])+f,a[1][1])),a[0][1]===a[1][1]&&(e.moveTo(a[0][0],Math.round(a[0][1])+f),e.lineTo(a[1][0],Math.round(a[1][1])+f));else for(e.moveTo(Math.round(a[0][0])+f,Math.round(a[0][1])+f),d=1;g>d;d++)e.lineTo(Math.round(a[d][0])+f,Math.round(a[d][1])+f);else for(e.moveTo(a[0][0],a[0][1]),d=1;g>d;d++)e.lineTo(a[d][0],a[d][1]);e.stroke(),e.closePath(),e.restore()}return this},drawFace:function(a,b){var c=this._oContext,d=a.length;if(b=b||{},d>2){c.save(),this._merge(c,b),c.beginPath(),c.moveTo(a[0][0],a[0][1]);for(var e=1;d>e;e++)c.lineTo(a[e][0],a[e][1]);c.fill(),c.closePath(),c.restore()}return this},_round:function(a,b){return b%2===1?Math.round(a)+.5:a},drawRect:function(a,b,c,d,e,f){var g=this._oContext,h="undefined"!=typeof e.fillStyle,i="undefined"!=typeof e.strokeStyle&&e.lineWidth>0;return e=e||{},(h||i)&&(g.save(),this._merge(g,e),h&&g.fillRect(a,b,c,d),i&&("undefined"==typeof f&&(f=!0),f&&(a=this._round(a,g.lineWidth),b=this._round(b,g.lineWidth),d=Math.round(d),c=Math.round(c)),g.strokeRect(a,b,c,d)),g.restore()),this}}),jindo.Canvas.create=function(a,b,c){var d=document.createElement("canvas");return d.setAttribute("width",a||300),d.setAttribute("height",b||150),"undefined"==typeof d.getContext&&G_vmlCanvasManager.initElement(d),c&&c.appendChild(d),d},jindo.Canvas.getContext=function(a){return a.getContext("2d")},jindo.HTMLComponent=jindo.$Class({sTagName:"",$init:function(){},paint:function(){return this._onPaint(),this},_onActivate:function(){(this.constructor._aInstances=this.constructor._aInstances||[]).push(this)},_onDeactivate:function(){var a=this.constructor._aInstances||[],b=jindo.$A(a).indexOf(this);b>-1&&a.splice(b,1)}}).extend(jindo.UIComponent),jindo.HTMLComponent.paint=function(){for(var a,b=this._aInstances||[],c=0;a=b[c];c++)a.paint()},jindo.HTMLComponent.getInstance=function(){return this._aInstances||[]},jindo.Effect=function(a){if(this instanceof arguments.callee)throw new Error("You can't create a instance of this");var b=/^(\-?[0-9\.]+)(%|\w+)?$/,c=/^rgb\(([0-9]+)\s?,\s?([0-9]+)\s?,\s?([0-9]+)\)$/i,d=/^rgba\(([0-9]+)\s?,\s?([0-9]+)\s?,\s?([0-9]+),\s?([0-9\.]+)\)$/i,e=/^hsl\(([0-9\.]+)\s?,\s?([0-9\.]+)%\s?,\s?([0-9\.]+)%\)$/i,f=/^hsla\(([0-9\.]+)\s?,\s?([0-9\.]+)%\s?,\s?([0-9\.]+)%,\s?([0-9\.]+)\)$/i,g=/^#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i,h=/^#([0-9A-F])([0-9A-F])([0-9A-F])$/i,i=function(a){var i,j=a;if(b.test(a))j=parseFloat(a),i=RegExp.$2||"";else if(c.test(a))j={rgb:[parseInt(RegExp.$1,10),parseInt(RegExp.$2,10),parseInt(RegExp.$3,10),1]},i="color";else if(d.test(a))j={rgb:[parseInt(RegExp.$1,10),parseInt(RegExp.$2,10),parseInt(RegExp.$3,10),parseFloat(RegExp.$4)]},i="color";else if(e.test(a))j={hsl:[parseFloat(RegExp.$1),parseFloat(RegExp.$2)/100,parseFloat(RegExp.$3)/100,1]},j.rgb=m.apply(this,j.hsl),i="color";else if(f.test(a))j={hsl:[parseFloat(RegExp.$1),parseFloat(RegExp.$2)/100,parseFloat(RegExp.$3)/100,parseFloat(RegExp.$4)]},j.rgb=m.apply(this,j.hsl),i="color";else{if(!g.test(a=a.replace(h,"#$1$1$2$2$3$3")))throw new Error("unit error ("+a+")");j={rgb:[parseInt(RegExp.$1,16),parseInt(RegExp.$2,16),parseInt(RegExp.$3,16),1]},i="color"}return{nValue:j,sUnit:i}},j=function(a){var b=[];return a.replace(/([^\s]+\([^\)]*\)|[^\s]+)\s?/g,function(a,c){b.push(c)}),b},k=function(a){for(var b=j(a?a+"":"0"),c=[],d=0,e=b.length;e>d;d++)c.push(i(b[d]));return c},l=function(a){return"object"==typeof a?{nValue:a.nValue,sUnit:a.sUnit}:a},m=function(a,b,c,d){a=a%360/60;var e=(1-Math.abs(2*c-1))*b,f=e*(1-Math.abs(a%2-1)),g=0,h=0,i=0;a>=5||1>a?(g=e,i=f):a>=4?(g=f,i=e):a>=3?(h=f,i=e):a>=2?(h=e,i=f):a>=1&&(g=f,h=e);var j=c-e/2;return[Math.round(255*(g+j)),Math.round(255*(h+j)),Math.round(255*(i+j)),d]
};return function(b,c){var d,e,f=function(){var a=!1;if(g.start!==b&&(d=k(g.start),b=g.start,a=!0),g.end!==c&&(e=k(g.end),c=g.end,a=!0),a){var f,h,i=Math.max(d.length,e.length);if(d.length!==e.length&&i>1){switch(d.length){case 1:d[1]=l(d[0]);case 2:d[2]=l(d[0]);case 3:d[3]=l(d[1])}switch(e.length){case 1:e[1]=l(e[0]);case 2:e[2]=l(e[0]);case 3:e[3]=l(e[1])}}for(var j=0;i>j;j++)if(f=d[j],h=e[j],0===f.nValue?f.sUnit=h.sUnit:0===h.nValue&&(h.sUnit=f.sUnit),f.sUnit!=h.sUnit)throw new Error("unit error ("+b+" ~ "+c+")")}},g=function(b){var c=[];f();for(var g,h,i,j,k,l,m=0,n=Math.max(d.length,e.length);n>m;m++){g=d[m],h=e[m],i=g.nValue,j=h.nValue,k=g.sUnit;var o=a(b),p=function(a,b,c){return Math.round(1e6*((b-a)*o+a))/1e6+(c||0)};if("color"===k)if(i.hsl&&j.hsl){i=i.hsl,j=j.hsl;var q=Math.round(p(i[0],j[0])),r=100*Math.max(0,Math.min(1,p(i[1],j[1]))),s=100*Math.max(0,Math.min(1,p(i[2],j[2])));l=p(i[3],j[3]),c.push(1===l?"hsl("+[q,r+"%",s+"%"].join(",")+")":"hsla("+[q,r+"%",s+"%",l].join(",")+")")}else{i=i.rgb,j=j.rgb;var t=Math.max(0,Math.min(255,Math.round(p(i[0],j[0])))),u=Math.max(0,Math.min(255,Math.round(p(i[1],j[1])))),v=Math.max(0,Math.min(255,Math.round(p(i[2],j[2]))));if(l=p(i[3],j[3]),1===l){var w=(t<<16|u<<8|v).toString(16).toUpperCase();c.push("#"+Array(7-w.length).join("0")+w)}else c.push("rgba("+[t,u,v,l].join(",")+")")}else c.push(p(i,j,k))}return c.join(" ")};switch(arguments.length){case 0:break;case 1:c=b||"0",b="0",g.setStart=function(a){this.start=a}}return g.start=b,g.end=c,g.effectConstructor=arguments.callee,b=c=null,arguments.length>1&&f(),g}},jindo.Effect.linear=jindo.Effect(function(a){return a}),jindo.Effect.linear.toString=function(){return"linear"},jindo.Effect.easeInSine=jindo.Effect(function(a){return 1==a?1:-Math.cos(a*(Math.PI/2))+1}),jindo.Effect.easeOutSine=jindo.Effect(function(a){return Math.sin(a*(Math.PI/2))}),jindo.Effect.easeInOutSine=jindo.Effect(function(a){return.5>a?.5*jindo.Effect.easeInSine(0,1)(2*a):.5*jindo.Effect.easeOutSine(0,1)(2*a-1)+.5}),jindo.Effect.easeOutInSine=jindo.Effect(function(a){return.5>a?.5*jindo.Effect.easeOutSine(0,1)(2*a):.5*jindo.Effect.easeInSine(0,1)(2*a-1)+.5}),jindo.Effect.easeInQuad=jindo.Effect(function(a){return a*a}),jindo.Effect.easeOutQuad=jindo.Effect(function(a){return-(a*(a-2))}),jindo.Effect.easeInOutQuad=jindo.Effect(function(a){return.5>a?.5*jindo.Effect.easeInQuad(0,1)(2*a):.5*jindo.Effect.easeOutQuad(0,1)(2*a-1)+.5}),jindo.Effect.easeOutInQuad=jindo.Effect(function(a){return.5>a?.5*jindo.Effect.easeOutQuad(0,1)(2*a):.5*jindo.Effect.easeInQuad(0,1)(2*a-1)+.5}),jindo.Effect.easeInCubic=jindo.Effect(function(a){return Math.pow(a,3)}),jindo.Effect.easeOutCubic=jindo.Effect(function(a){return Math.pow(a-1,3)+1}),jindo.Effect.easeInOutCubic=jindo.Effect(function(a){return.5>a?.5*jindo.Effect.easeIn(0,1)(2*a):.5*jindo.Effect.easeOut(0,1)(2*a-1)+.5}),jindo.Effect.easeOutInCubic=jindo.Effect(function(a){return.5>a?.5*jindo.Effect.easeOut(0,1)(2*a):.5*jindo.Effect.easeIn(0,1)(2*a-1)+.5}),jindo.Effect.easeInQuart=jindo.Effect(function(a){return Math.pow(a,4)}),jindo.Effect.easeOutQuart=jindo.Effect(function(a){return-(Math.pow(a-1,4)-1)}),jindo.Effect.easeInOutQuart=jindo.Effect(function(a){return.5>a?.5*jindo.Effect.easeInQuart(0,1)(2*a):.5*jindo.Effect.easeOutQuart(0,1)(2*a-1)+.5}),jindo.Effect.easeOutInQuart=jindo.Effect(function(a){return.5>a?.5*jindo.Effect.easeOutQuart(0,1)(2*a):.5*jindo.Effect.easeInQuart(0,1)(2*a-1)+.5}),jindo.Effect.easeInQuint=jindo.Effect(function(a){return Math.pow(a,5)}),jindo.Effect.easeOutQuint=jindo.Effect(function(a){return Math.pow(a-1,5)+1}),jindo.Effect.easeInOutQuint=jindo.Effect(function(a){return.5>a?.5*jindo.Effect.easeInQuint(0,1)(2*a):.5*jindo.Effect.easeOutQuint(0,1)(2*a-1)+.5}),jindo.Effect.easeOutInQuint=jindo.Effect(function(a){return.5>a?.5*jindo.Effect.easeOutQuint(0,1)(2*a):.5*jindo.Effect.easeInQuint(0,1)(2*a-1)+.5}),jindo.Effect.easeInCircle=jindo.Effect(function(a){return-(Math.sqrt(1-a*a)-1)}),jindo.Effect.easeOutCircle=jindo.Effect(function(a){return Math.sqrt(1-(a-1)*(a-1))}),jindo.Effect.easeInOutCircle=jindo.Effect(function(a){return.5>a?.5*jindo.Effect.easeInCircle(0,1)(2*a):.5*jindo.Effect.easeOutCircle(0,1)(2*a-1)+.5}),jindo.Effect.easeOutInCircle=jindo.Effect(function(a){return.5>a?.5*jindo.Effect.easeOutCircle(0,1)(2*a):.5*jindo.Effect.easeInCircle(0,1)(2*a-1)+.5}),jindo.Effect.easeInBack=jindo.Effect(function(a){var b=1.70158;return 1==a?1:a/1*(a/1)*((1+b)*a-b)}),jindo.Effect.easeOutBack=jindo.Effect(function(a){var b=1.70158;return 0===a?0:(a=a/1-1)*a*((b+1)*a+b)+1}),jindo.Effect.easeInOutBack=jindo.Effect(function(a){return.5>a?.5*jindo.Effect.easeInBack(0,1)(2*a):.5*jindo.Effect.easeOutBack(0,1)(2*a-1)+.5}),jindo.Effect.easeInElastic=jindo.Effect(function(a){var b,c=0,d=0;return 0===a?0:1==(a/=1)?1:(c||(c=.3),!d||1>d?(d=1,b=c/4):b=c/(2*Math.PI)*Math.asin(1/d),-(d*Math.pow(2,10*(a-=1))*Math.sin(2*(a-1)*Math.PI/c)))}),jindo.Effect.easeOutElastic=jindo.Effect(function(a){var b,c=0,d=0;return 0===a?0:1==(a/=1)?1:(c||(c=.3),!d||1>d?(d=1,b=c/4):b=c/(2*Math.PI)*Math.asin(1/d),d*Math.pow(2,-10*a)*Math.sin(2*(a-b)*Math.PI/c)+1)}),jindo.Effect.easeInOutElastic=jindo.Effect(function(a){var b,c=0,d=0;return 0===a?0:2==(a/=.5)?1:(c||(c=.3*1.5),!d||1>d?(d=1,b=c/4):b=c/(2*Math.PI)*Math.asin(1/d),1>a?-.5*d*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/c):d*Math.pow(2,-10*(a-=1))*Math.sin(2*(a-b)*Math.PI/c)*.5+1)}),jindo.Effect.easeOutBounce=jindo.Effect(function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}),jindo.Effect.easeInBounce=jindo.Effect(function(a){return 1-jindo.Effect.easeOutBounce(0,1)(1-a)}),jindo.Effect.easeInOutBounce=jindo.Effect(function(a){return.5>a?.5*jindo.Effect.easeInBounce(0,1)(2*a):.5*jindo.Effect.easeOutBounce(0,1)(2*a-1)+.5}),jindo.Effect.easeInExpo=jindo.Effect(function(a){return 0===a?0:Math.pow(2,10*(a-1))}),jindo.Effect.easeOutExpo=jindo.Effect(function(a){return 1==a?1:-Math.pow(2,-10*a/1)+1}),jindo.Effect.easeInOutExpo=jindo.Effect(function(a){return.5>a?.5*jindo.Effect.easeInExpo(0,1)(2*a):.5*jindo.Effect.easeOutExpo(0,1)(2*a-1)+.5}),jindo.Effect.easeOutInExpo=jindo.Effect(function(a){return.5>a?.5*jindo.Effect.easeOutExpo(0,1)(2*a):.5*jindo.Effect.easeInExpo(0,1)(2*a-1)+.5}),jindo.Effect._cubicBezier=function(a,b,c,d){return function(e){function f(a){return((l*a+k)*a+j)*a}function g(a){return((o*a+n)*a+m)*a}function h(a){return(3*l*a+2*k)*a+j}function i(a,b){var c,d,e,g,i,j;for(e=a,j=0;8>j;j++){if(g=f(e)-a,Math.abs(g)<b)return e;if(i=h(e),Math.abs(i)<1e-6)break;e-=g/i}if(c=0,d=1,e=a,c>e)return c;if(e>d)return d;for(;d>c;){if(g=f(e),Math.abs(g-a)<b)return e;a>g?c=e:d=e,e=.5*(d-c)+c}return e}var j=3*a,k=3*(c-a)-j,l=1-j-k,m=3*b,n=3*(d-b)-m,o=1-m-n;return g(i(e,.005))}},jindo.Effect.cubicBezier=function(a,b,c,d){var e=jindo.Effect(jindo.Effect._cubicBezier(a,b,c,d)),f="cubic-bezier("+[a,b,c,d].join(",")+")";return e.toString=function(){return f},e},jindo.Effect.cubicEase=jindo.Effect.cubicBezier(.25,.1,.25,1),jindo.Effect.cubicEase.toString=function(){return"ease"},jindo.Effect.cubicEaseIn=jindo.Effect.cubicBezier(.42,0,1,1),jindo.Effect.cubicEaseIn.toString=function(){return"ease-in"},jindo.Effect.cubicEaseOut=jindo.Effect.cubicBezier(0,0,.58,1),jindo.Effect.cubicEaseOut.toString=function(){return"ease-out"},jindo.Effect.cubicEaseInOut=jindo.Effect.cubicBezier(.42,0,.58,1),jindo.Effect.cubicEaseInOut.toString=function(){return"ease-in-out"},jindo.Effect.cubicEaseOutIn=jindo.Effect.cubicBezier(0,.42,1,.58),jindo.Effect.overphase=jindo.Effect(function(a){return a/=.652785,(Math.sqrt((2-a)*a)+.1*a).toFixed(5)}),jindo.Effect.sinusoidal=jindo.Effect(function(a){return-Math.cos(a*Math.PI)/2+.5}),jindo.Effect.mirror=jindo.Effect(function(a){return jindo.Effect.sinusoidal(0,1)(.5>a?2*a:1-2*(a-.5))}),jindo.Effect.pulse=function(a){return jindo.Effect(function(b){return-Math.cos(b*(a-.5)*2*Math.PI)/2+.5})},jindo.Effect.wave=function(a,b){return jindo.Effect(function(c){return(b||1)*Math.sin(360*a*c*Math.PI/180).toFixed(5)})},jindo.Effect.stepStart=jindo.Effect(function(a){return 0===a?0:1}),jindo.Effect.stepEnd=jindo.Effect(function(a){return 1===a?1:0}),jindo.Effect.easeIn=jindo.Effect.easeInCubic,jindo.Effect.easeOut=jindo.Effect.easeOutCubic,jindo.Effect.easeInOut=jindo.Effect.easeInOutCubic,jindo.Effect.easeOutIn=jindo.Effect.easeOutInCubic,jindo.Effect.bounce=jindo.Effect.easeOutBounce,jindo.Effect.elastic=jindo.Effect.easeInElastic,jindo.Clipboard=jindo.$Class({_aElement:null,_aData:null,_elOvered:null,_bFailed:!0,$init:function(a){this._sFlashURL=a;{var b=jindo.Clipboard;this._sUnique="S"+(new Date).getTime()+parseInt(1e9*Math.random(),10)}"undefined"==typeof b._callbacks&&(b._callbacks={}),b._callbacks[this._sUnique]={click:jindo.$Fn(this._onFlashClick,this).bind(),mouseover:jindo.$Fn(this._onFlashMouseOver,this).bind(),mouseout:jindo.$Fn(this._onFlashMouseOut,this).bind(),mousedown:jindo.$Fn(this._onFlashMouseDown,this).bind(),mouseup:jindo.$Fn(this._onFlashMouseUp,this).bind(),load:jindo.$Fn(this._onFlashLoad,this).bind()},this._aElement=[],this._aData=[],this._agent=jindo.$Agent(),this._initFlash(),this._wfHandler=jindo.$Fn(function(a){this._initFlash();var b=a.element,c=jindo.$Element(b).offset();this._setFlashPosSize(c.left,c.top,b.offsetWidth,b.offsetHeight),this._setClipboard(b,this._getData(b)),this._elOvered=b},this)},_initFlash:function(){if(!this._elDummy){var a=this._elDummy=jindo.$("<div>"),b=this._sUnique;a.style.cssText="position:absolute !important; border:0 !important; padding:0 !important; margin:0 !important; overflow:visible !important; z-index:32000 !important;",document.body.insertBefore(a,document.body.firstChild),this._agent.flash().version>=11&&this._agent.navigator().ie&&(this._sFlashURL+="?"+Math.floor(1e4*Math.random()));var c=this._getFlashHTML("CLIPBOARD"+b,this._sFlashURL,1,1,{flashVars:{sUniq:b},wmode:"transparent"});a.innerHTML=c,jindo.$Fn(this._checkFailed,this).attach(a,"click")}},_getFlashHTML:function(a,b,c,d,e){var f="https:"==location.protocol?"https:":"http:",g='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"';e=e||{},e.allowScriptAccess=e.allowScriptAccess||"always";var h,i=[],j=[];for(var k in e)e.hasOwnProperty(k)&&(h=e[k],"flashVars"===k&&(h=jindo.$H(h).toQueryString()),i.push('<param name="'+k+'" value="'+h+'" />'),j.push(" "+k+'="'+h+'"'));return['<object tabindex="-1" id="'+a+'" width="'+c+'" height="'+d+'" '+g+' codebase="'+f+'//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0">','<param name="movie" value="'+b+'" />',i.join(""),'<embed tabindex="-1" name="'+a+'" src="'+b+'"',' type="application/x-shockwave-flash" pluginspage="'+f+'://www.macromedia.com/go/getflashplayer"',j.join(""),' width="'+c+'" height="'+d+'">',"</embed>","</object>"].join("")},_getFlash:function(){return document["CLIPBOARD"+this._sUnique]||document.all["CLIPBOARD"+this._sUnique]},_setFlashPosSize:function(a,b,c,d){var e=this._elDummy;e.style.left=a+"px",e.style.top=b+"px";var f=this._getFlash();f.width=c,f.height=d,f.style.width=c+"px",f.style.height=d+"px"},setData:function(a,b){a=jindo.$(a);var c=jindo.$A(this._aElement).indexOf(a),d=-1!=c;return d&&!b&&""!==b?(this._wfHandler.detach(a,"mousemove"),this._aElement.splice(c,1),this._aData.splice(c,1),void this._setFlashPosSize(0,0,1,1)):(d?this._aData[c]=b:(this._wfHandler.attach(a,"mousemove"),this._aElement.push(a),this._aData.push(b)),void this._setClipboard(a,b))},_getData:function(a){var b=jindo.$A(this._aElement).indexOf(a);return this._aData[b]},_setClipboard:function(a,b){var c=this._getFlash(),d=(jindo.$Element(a).css("cursor")||"").toUpperCase(),e="POINTER"==d||"HAND"==d;try{c.setClipboardData(b),c.setClipboardOptions({cursor:e?"pointer":"default"}),this._sAppliedData=b,this._bFailed=!1}catch(f){this._bFailed=!0}},_checkFailed:function(){this._bFailed&&this.fireEvent("failure",{element:this._elOvered,data:this._lastestData})},_onFlashClick:function(a){this.fireEvent("copy",{element:this._elOvered,data:a})},_onFlashMouseOver:function(){this.fireEvent("over",{element:this._elOvered})},_onFlashMouseOut:function(){this.fireEvent("out",{element:this._elOvered})},_onFlashMouseDown:function(){this.fireEvent("down",{element:this._elOvered})},_onFlashMouseUp:function(){this.fireEvent("up",{element:this._elOvered})},_onFlashLoad:function(){this.fireEvent("load")}}).extend(jindo.Component),jindo.BrowseButton=jindo.$Class({$init:function(a,b){this.option({sClassPrefix:"browse-",bActivateOnload:!0}),this.option(b||{}),this._el=jindo.$(a),this.option("bActivateOnload")&&this.activate()},_onActivate:function(){this._assignHTMLElement(),this._attachEvents()},_onDeactivate:function(){this._detachEvents(),this._unassignHTMLElement()},_assignHTMLElement:function(){var a=this.option("sClassPrefix");this._elBox=jindo.$$.getSingle("."+a+"box",this._el),this._elFileSelect=jindo.$$.getSingle("."+a+"file-input",this._el),this._elBrowseButton=jindo.$$.getSingle("."+a+"button",this._el),this._sTmpFileSelectCssText=this._elFileSelect.style.cssText,this._elFileSelect.style.cssText="top:-.5em !important; height:500px !important;",jindo.$Element(this._elBrowseButton).addClass(a+"applied")},_unassignHTMLElement:function(){var a=this.option("sClassPrefix");this._elFileSelect.style.cssText=this._sTmpFileSelectCssText,jindo.$Element(this._elBrowseButton).removeClass(a+"applied")},_adjustFileSelectPos:function(a){this.getFileSelect().style.right=jindo.$Element(this.getBox()).offset().left+jindo.$Element(this.getBox()).width()-a-20+"px"},_attachEvents:function(){var a=this.getBrowseButton(),b=jindo.$Element(a),c=this.getBox(),d=this.getFileSelect();this._wfHoverOnBrowseButton=jindo.$Fn(function(a){b.addClass(this.option("sClassPrefix")+"over"),this.fireEvent("over"),this._adjustFileSelectPos(a.pos().pageX)},this),this._wfRestore=jindo.$Fn(function(){b.removeClass(this.option("sClassPrefix")+"over"),d.style.right="0px",this.fireEvent("out")},this),this._wfMouseMoveOnFloat=jindo.$Fn(function(a){this._adjustFileSelectPos(a.pos().pageX)},this),this._wfChange=jindo.$Fn(function(){this.fireEvent("sourceChange")},this),this._wfHoverOnBrowseButton.attach(c,"mouseover"),this._wfMouseMoveOnFloat.attach(c,"mousemove"),this._wfRestore.attach(c,"mouseout"),this._wfChange.attach(this.getFileSelect(),"change")},_detachEvents:function(){{var a=this.getBrowseButton(),b=(jindo.$Element(a),this.getBox());this.getFileSelect()}this._wfHoverOnBrowseButton.detach(b,"mouseover"),this._wfMouseMoveOnFloat.detach(b,"mousemove"),this._wfRestore.detach(b,"mouseout"),this._wfChange.detach(this.getFileSelect(),"change")},getBox:function(){return this._elBox},getFileSelect:function(){return this._elFileSelect},getBrowseButton:function(){return this._elBrowseButton}}).extend(jindo.UIComponent),jindo.DataBridge=jindo.$Class({_htEvent:{},$static:{log:function(a,b){a&&b?this.getComponentInstance(a)._onLog(b):alert("Parameter is wrong!!")},onReceive:function(a,b,c){a&&b&&c?this.getComponentInstance(a)._onReceiveData(b,c):alert("Parameter is wrong!!")},getComponentInstance:function(a){for(var b=this._aInstances,c=0;c<b.length;c++)if(a==b[c].getFlashObjectId())return b[c]}},$init:function(a){(this.constructor._aInstances=this.constructor._aInstances||[]).push(this),this.option({sSwfPath:"data_bridge.swf",nRetryLimit:3}),this.option(a),this._attachEvent(),this._createFlashObject()},_attachEvent:function(){this._htEvent.beforeunload=jindo.$Fn(this.destroy,this).attach(window,"beforeunload")},_createFlashObject:function(){this._sFlashId="data_bridge_"+(new Date).getMilliseconds()+Math.floor(1e5*Math.random());var a=jindo.$Element('<div style="position:absolute;top:-1000px;left:0px">'),b="serviceId="+this.option("sServiceId")+"&logHandler=jindo.DataBridge.log&onReceiveHandler=jindo.DataBridge.onReceive&flashId="+this._sFlashId+"&retryLimit="+this.option("nRetryLimit");a.appendTo(document.body),a.html('<object id="'+this._sFlashId+'" width="1" height="1" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0"><param name="flashvars" value="'+b+'"><param name="movie" value="'+this.option("sSwfPath")+'"><param name = "allowScriptAccess" value = "always" /><embed name="'+this._sFlashId+'" src="'+this.option("sSwfPath")+'" flashvars="'+b+'" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" width="1" height="1" allowScriptAccess="always" swLiveConnect="true"></embed></object>')},_getFlashObject:function(){return document[this._sFlashId]||jindo.$(this._sFlashId)},getFlashObjectId:function(){return this._sFlashId},getClientId:function(){return this.option("sServiceId")+"_"+this._sFlashId},send:function(a){if(a)try{this._getFlashObject().send(a)}catch(b){alert("Flash object is not ready!!")}else alert("vData parameter is null!!");return this},_onReceiveData:function(a,b){this.fireEvent("receive",{sSenderId:a,vData:b})},_onLog:function(a){this.fireEvent("log",{sMessage:a})},_close:function(){this._getFlashObject().close()},_detachEvent:function(){this._htEvent.beforeunload.detach(window,"beforeunload")},getLocalData:function(){},setLocalData:function(){},resetLocalData:function(){},destroy:function(){this._close(),this._detachEvent(),this._htEvent={},jindo.$Element(this._getFlashObject()).leave();var a=this.constructor._aInstances||[],b=jindo.$A(a).indexOf(this);b>-1&&a.splice(b,1)}}).extend(jindo.Component),jindo.LayerPosition=jindo.$Class({$init:function(a,b,c){this.option({sPosition:"outside-bottom",sAlign:"left",sValign:"",nTop:0,nLeft:0,bAuto:!1,bPositionOnload:!0,bActivateOnload:!0}),this.option(c||{}),this.setElement(a),b&&this.setLayer(b),this._wfSetPosition=jindo.$Fn(function(){var a=this._elLayer;a&&this._welLayer.visible()&&this.fireEvent("beforeAdjust",{elLayer:a,htCurrentPosition:this.getCurrentPosition(),htAdjustedPosition:this._adjustPosition(this.getCurrentPosition())})&&(this.setPosition(),this.fireEvent("adjust",{elLayer:a,htCurrentPosition:this.getCurrentPosition()}))},this),this.option("bPositionOnload")&&this._wfSetPosition.bind().call(),this.option("bActivateOnload")&&this.activate()},_onActivate:function(){this.option("bAuto")&&(this._wfSetPosition.attach(window,"scroll").attach(window,"resize"),this._attached=!0)},_onDeactivate:function(){this._attached&&(this._wfSetPosition.detach(window,"scroll").detach(window,"resize"),this._attached=!1)},getElement:function(){return this._el},setElement:function(a){return this._wel=this._el=jindo.$(a),this._el&&(this._wel=jindo.$Element(a)),this},getLayer:function(){return this._elLayer},setLayer:function(a){return this._elLayer=jindo.$(a),this._welLayer=jindo.$Element(a),this._elLayer.parentNode!=document.body&&document.body.insertBefore(this._elLayer,document.body.firstChild),this},_isPosition:function(a,b){return a.sPosition.indexOf(b)>-1?!0:!1},_setLeftRight:function(a,b){var c=this.getElement(),d=this.getLayer(),e=c.offsetWidth,f=d.offsetWidth;c==document.body&&(e=jindo.$Document().clientSize().width);var g=this._isPosition(a,"left"),h=this._isPosition(a,"right"),i=this._isPosition(a,"inside");return g?i?b.nLeft+=a.nLeft:(b.nLeft-=f,b.nLeft-=a.nLeft):h?(b.nLeft+=e,i?(b.nLeft-=f,b.nLeft-=a.nLeft):b.nLeft+=a.nLeft):("left"==a.sAlign&&(b.nLeft+=a.nLeft),"center"==a.sAlign&&(b.nLeft+=(e-f)/2),"right"==a.sAlign&&(b.nLeft+=e-f,b.nLeft-=a.nLeft)),b},_setVerticalAlign:function(a,b){var c=this.getElement(),d=this.getLayer(),e=c.offsetHeight,f=d.offsetHeight;switch(c==document.body&&(e=jindo.$Document().clientSize().height),a.sValign){case"top":b.nTop+=a.nTop;break;case"middle":b.nTop+=(e-f)/2;break;case"bottom":b.nTop+=e-f-a.nTop}return b},_adjustScrollPosition:function(a){if(this.getElement()==document.body){var b=jindo.$Document().scrollPosition();a.nTop+=b.top,a.nLeft+=b.left}return a},getPosition:function(a){"object"!=typeof a&&(a=this.option()),"undefined"==typeof a.nTop&&(a.nTop=0),"undefined"==typeof a.nLeft&&(a.nLeft=0);var b,c=this._isPosition(a,"center"),d=this._isPosition(a,"inside"),e=this._isPosition(a,"top"),f=this._isPosition(a,"bottom"),g=this._isPosition(a,"left"),h=this._isPosition(a,"right");g&&(b="left"),h&&(b="right"),e&&(b="top"),f&&(b="bottom"),c&&(b="center");var i,j=this.getElement(),k=jindo.$Element(j),l=this.getLayer(),m=jindo.$Element(l),n=k.offset(),o=j.offsetWidth,p=j.offsetHeight,q=l.offsetWidth,r=l.offsetHeight,s={nTop:n.top,nLeft:n.left};switch(j==document.body&&(i=jindo.$Document().clientSize(),o=i.width,p=i.height),q+=parseInt(m.css("marginLeft"),10)+parseInt(m.css("marginRight"),10)||0,r+=parseInt(m.css("marginTop"),10)+parseInt(m.css("marginBottom"),10)||0,b){case"center":s.nTop+=(p-r)/2,s.nTop+=a.nTop,s.nLeft+=(o-q)/2,s.nLeft+=a.nLeft;break;case"top":d?s.nTop+=a.nTop:s.nTop-=a.nTop+r,s=this._setLeftRight(a,s);break;case"bottom":s.nTop+=p,d?s.nTop-=a.nTop+r:s.nTop+=a.nTop,s=this._setLeftRight(a,s);break;case"left":d?s.nLeft+=a.nLeft:s.nLeft-=a.nLeft+q,s=this._setVerticalAlign(a,s);break;case"right":s.nLeft+=o,d?s.nLeft-=a.nLeft+q:s.nLeft+=a.nLeft,s=this._setVerticalAlign(a,s)}if(s=this._adjustScrollPosition(s),jindo.$Agent().navigator().ie&&jindo.$Agent().navigator().version<8&&window.external)try{var t=window!=top&&window.frameElement&&!window.frameElement.frameBorder;t&&(s.nLeft-=2,s.nTop-=2)}catch(u){}return s},setPosition:function(a){var b=jindo.$Element(this.getLayer()),c=b.visible();return c||b.show(),b.css("left","-9999px").css("top","0px"),"undefined"==typeof a&&(a=this.getPosition()),this.option("bAuto")&&(a=this._adjustPosition(a)),b.css("left",a.nLeft+"px").css("top",a.nTop+"px"),c||b.hide(),this},getCurrentPosition:function(){var a=jindo.$Element(this.getLayer());return{nTop:parseInt(a.css("top"),10),nLeft:parseInt(a.css("left"),10)}},_getScoreFullyVisible:function(a){var b=0,c=this.getLayer(),d=jindo.$Element(c),e=jindo.$Document().scrollPosition(),f=e.top,g=e.left,h=jindo.$Document().clientSize(),i=c.offsetWidth+(parseInt(d.css("marginLeft"),10)+parseInt(d.css("marginRight"),10)||0),j=c.offsetHeight+(parseInt(d.css("marginTop"),10)+parseInt(d.css("marginBottom"),10)||0);return a.nLeft>=0&&h.width>=a.nLeft-g+i&&b++,a.nTop>=0&&h.height>=a.nTop-f+j&&b++,b},_mirrorHorizontal:function(a){if("center"==a.sAlign||"inside-center"==a.sPosition)return a;var b={};for(var c in a)b[c]=a[c];return this._isPosition(b,"right")?b.sPosition=b.sPosition.replace(/right/,"left"):this._isPosition(b,"left")?b.sPosition=b.sPosition.replace(/left/,"right"):"right"==b.sAlign?b.sAlign="left":"left"==b.sAlign&&(b.sAlign="right"),b},_mirrorVertical:function(a){if("middle"==a.sValign||"inside-center"==a.sPosition)return a;var b={};for(var c in a)b[c]=a[c];return this._isPosition(b,"top")?b.sPosition=b.sPosition.replace(/top/,"bottom"):this._isPosition(b,"bottom")?b.sPosition=b.sPosition.replace(/bottom/,"top"):"top"==b.sValign?b.sValign="bottom":"bottom"==b.sValign&&(b.sValign="top"),b},_adjustPosition:function(a){var b=this.option(),c=[],d=a;c.push(a),c.push(this.getPosition(this._mirrorHorizontal(b))),c.push(this.getPosition(this._mirrorVertical(b))),c.push(this.getPosition(this._mirrorVertical(this._mirrorHorizontal(b))));for(var e,f,g=0,h=0;f=c[h];h++)e=this._getScoreFullyVisible(f),e>g&&(d=f,g=e);return d}}).extend(jindo.UIComponent),jindo.DefaultTextValue=jindo.$Class({$init:function(a,b){this.option({sValue:"",bActivateOnload:!0}),this.option(b||{}),this._elBaseTarget=jindo.$(a),this._wfOnFocusAndBlur=jindo.$Fn(this._onFocusAndBlur,this),this.option("bActivateOnload")&&this.activate()},getBaseElement:function(){return this._elBaseTarget},setDefault:function(){return this.getBaseElement().value=this.option("sValue"),this},setDefaultValue:function(a){var b=this.option("sValue");return this.option("sValue",a),this.getBaseElement().value==b&&this.setDefault(),this},getDefaultValue:function(){return this.option("sValue")},paint:function(){return this},_onActivate:function(){var a=this.getBaseElement();""==a.value&&this.setDefault(),this._wfOnFocusAndBlur.attach(a,"focus").attach(a,"blur")},_onDeactivate:function(){var a=this.getBaseElement();this._wfOnFocusAndBlur.detach(a,"focus").detach(a,"blur")},_onFocusAndBlur:function(a){var b=this._elBaseTarget,c=b.value;switch(a.type){case"focus":c.replace(/\r\n/g,"\n")==this.getDefaultValue()&&(b.value="",b.select());break;case"blur":""==jindo.$S(c).trim().$value()&&this.setDefault()}}}).extend(jindo.UIComponent),jindo.Dialog=jindo.$Class({$init:function(a){var b={sClassPrefix:"dialog-",LayerPosition:{sPosition:"inside-center",bAuto:!0}};this.option(b),this.option(a||{}),this._bIsEventAttached=!1,this._bIsShown=!1,this._assignHTMLElements(),this._initLayerPosition()},_assignHTMLElements:function(){this._elLayer=jindo.$('<div class="'+this.option("sClassPrefix")+'layer"></div>'),this._welLayer=jindo.$Element(this._elLayer),this._wfClick=jindo.$Fn(this._onClick,this),jindo.$Element.prototype.preventTapHighlight&&this._welLayer.preventTapHighlight(!0)},_initLayerPosition:function(){this._oLayerPosition=new jindo.LayerPosition(document.body,this._elLayer,this.option("LayerPosition"))},getLayer:function(){return this._elLayer},getLayerPosition:function(){return this._oLayerPosition},setLayerTemplate:function(a){this._sTemplate=a,this._template=jindo.$Template(this._sTemplate)},getLayerTemplate:function(){return this._sTemplate},show:function(a,b){if(!this.isShown()){this.attach(b),document.body.appendChild(this._elLayer),this._welLayer.html(this._template.process(a));var c={elLayer:this._elLayer};this.fireEvent("beforeShow",c)&&(this._welLayer.show(),this._attachEvents(),this.getLayerPosition().setPosition(),this._bIsShown=!0,this.fireEvent("show",c))}},hide:function(){if(this.isShown()){var a={elLayer:this._elLayer};this.fireEvent("beforeHide",a)&&(this.detachAll("close").detachAll("confirm").detachAll("cancel"),this._detachEvents(),this._welLayer.hide(),this._welLayer.leave(),this._bIsShown=!1,this.fireEvent("hide",a))}},isShown:function(){return this._bIsShown},_isEventAttached:function(){return this._bIsEventAttached},_attachEvents:function(){return this._isEventAttached()||(this._wfClick.attach(this._elLayer,"click"),this._bIsEventAttached=!0),this},_detachEvents:function(){return this._isEventAttached()&&(this._wfClick.detach(this._elLayer,"click"),this._bIsEventAttached=!1),this},_onClick:function(a){var b,c,d,e=this.option("sClassPrefix");(b=this._getClosest("."+e+"close",a.element))?this.fireEvent("close")&&this.hide():(c=this._getClosest("."+e+"confirm",a.element))?this.fireEvent("confirm")&&this.hide():(d=this._getClosest("."+e+"cancel",a.element))&&this.fireEvent("cancel")&&this.hide()},_getClosest:function(a,b){return jindo.$$.test(b,a)?b:jindo.$$.getSingle("! "+a,b)}}).extend(jindo.Component),jindo.DragArea=jindo.$Class({$init:function(a,b){this.option({sClassName:"draggable",bFlowOut:!0,bSetCapture:!0,nThreshold:0}),this.option(b||{}),this._el=a,this._bIE=jindo.$Agent().navigator().ie,this._htDragInfo={bIsDragging:!1,bPrepared:!1,bHandleDown:!1,bForceDrag:!1},this._wfOnMouseDown=jindo.$Fn(this._onMouseDown,this),this._wfOnMouseMove=jindo.$Fn(this._onMouseMove,this),this._wfOnMouseUp=jindo.$Fn(this._onMouseUp,this),this._wfOnDragStart=jindo.$Fn(this._onDragStart,this),this._wfOnSelectStart=jindo.$Fn(this._onSelectStart,this),this.activate()},_findDraggableElement:function(a){if(1===a.nodeType&&jindo.$$.test(a,"input[type=text], textarea, select"))return null;var b=this,c="."+this.option("sClassName"),d=function(a){return null===a?!1:b._el===document||b._el===a?!0:jindo.$Element(b._el).isParentOf(a)},e=jindo.$$.test(a,c)?a:jindo.$$.getSingle("! "+c,a);return d(e)||(e=null),e},isDragging:function(){var a=this._htDragInfo;return a.bIsDragging&&!a.bPrepared},stopDragging:function(){return this._stopDragging(!0),this},_stopDragging:function(a){if(this._wfOnMouseMove.detach(document,"mousemove"),this._wfOnMouseUp.detach(document,"mouseup"),this.isDragging()){var b=this._htDragInfo,c=jindo.$Element(b.elDrag);b.bIsDragging=!1,b.bForceDrag=!1,b.bPrepared=!1,this._bIE&&this._elSetCapture&&(this._elSetCapture.releaseCapture(),this._elSetCapture=null),this.fireEvent("dragEnd",{elArea:this._el,elHandle:b.elHandle,elDrag:b.elDrag,nX:parseInt(c.css("left"),10)||0,nY:parseInt(c.css("top"),10)||0,bInterupted:a})}},_onActivate:function(){this._wfOnMouseDown.attach(this._el,"mousedown"),this._wfOnDragStart.attach(this._el,"dragstart"),this._wfOnSelectStart.attach(this._el,"selectstart")},_onDeactivate:function(){this.stopDragging(),this._wfOnMouseDown.detach(this._el,"mousedown"),this._wfOnDragStart.detach(this._el,"dragstart"),this._wfOnSelectStart.detach(this._el,"selectstart")},attachEvent:function(){this.activate()},detachEvent:function(){this.deactivate()},isEventAttached:function(){return this.isActivating()},startDragging:function(a){var b=this._findDraggableElement(a);return b?(this._htDragInfo.bForceDrag=!0,this._htDragInfo.bPrepared=!0,this._htDragInfo.elHandle=b,this._htDragInfo.elDrag=b,this._wfOnMouseMove.attach(document,"mousemove"),this._wfOnMouseUp.attach(document,"mouseup"),!0):!1},_onMouseDown:function(a){var b=a.mouse(!0);if(/^mouse/.test(a.type)&&(!b.left||b.right||b.scrollbar))return void this._stopDragging(!0);var c=this._findDraggableElement(a.element);if(c){var d=a.pos(),e=this._htDragInfo;e.bHandleDown=!0,e.bPrepared=!0,e.nButton=a._event.button,e.elHandle=c,e.elDrag=c,e.nPageX=d.pageX,e.nPageY=d.pageY,this.fireEvent("handleDown",{elHandle:c,elDrag:c,weEvent:a})&&this._wfOnMouseMove.attach(document,"mousemove"),this._wfOnMouseUp.attach(document,"mouseup"),a.stop(jindo.$Event.CANCEL_DEFAULT)}},_onMouseMove:function(a){var b,c,d=this._htDragInfo,e=a.pos(),f={nX:e.pageX-d.nPageX,nY:e.pageY-d.nPageY};if(d.bPrepared){var g=this.option("nThreshold"),h={};if(!d.bForceDrag&&g){h.nPageX=e.pageX-d.nPageX,h.nPageY=e.pageY-d.nPageY;var i=Math.sqrt(h.nPageX*h.nPageX+h.nPageY*h.nPageY);if(g>i)return}if(this._bIE&&this.option("bSetCapture")&&(this._elSetCapture=this._el===document?document.body:this._findDraggableElement(a.element),this._elSetCapture&&this._elSetCapture.setCapture(!1)),b={elArea:this._el,elHandle:d.elHandle,elDrag:d.elDrag,htDiff:h,weEvent:a},d.bIsDragging=!0,d.bPrepared=!1,!this.fireEvent("dragStart",b))return void(d.bPrepared=!0);var j=jindo.$Element(b.elDrag),k=j.offset();d.elHandle=b.elHandle,d.elDrag=b.elDrag,d.nX=parseInt(j.css("left"),10)||0,d.nY=parseInt(j.css("top"),10)||0,d.nClientX=k.left+j.width()/2,d.nClientY=k.top+j.height()/2}if(d.bForceDrag&&(f.nX=e.clientX-d.nClientX,f.nY=e.clientY-d.nClientY),b={elArea:this._el,elFlowOut:d.elDrag.parentNode,elHandle:d.elHandle,elDrag:d.elDrag,weEvent:a,nX:d.nX+f.nX,nY:d.nY+f.nY,nGapX:f.nX,nGapY:f.nY},this.fireEvent("beforeDrag",b)){var l=d.elDrag;if(this.option("bFlowOut")===!1){var m=b.elFlowOut,n=[l.offsetWidth,l.offsetHeight],o=0,p=0;m==document.body&&(o=document.body.scrollLeft||document.documentElement.scrollLeft,p=document.body.scrollTop||document.documentElement.scrollTop,m=null);var q=m&&{w:Math.max(m.offsetWidth,m.scrollWidth),h:Math.max(m.offsetHeight,m.scrollHeight)};if(m&&n[0]<=q.w&&n[1]<=q.h)c={nWidth:m.clientWidth,nHeight:m.clientHeight},o=m.scrollLeft,p=m.scrollTop;else{var r=jindo.$Document().clientSize();c={nWidth:r.width,nHeight:r.height}}null!==b.nX&&(b.nX=Math.max(b.nX,o),b.nX=Math.min(b.nX,c.nWidth-n[0]+o)),null!==b.nY&&(b.nY=Math.max(b.nY,p),b.nY=Math.min(b.nY,c.nHeight-n[1]+p))}null!==b.nX&&(l.style.left=b.nX+"px"),null!==b.nY&&(l.style.top=b.nY+"px"),this.fireEvent("drag",b)}else d.bIsDragging=!1},_onMouseUp:function(a){this._stopDragging(!1);var b=this._htDragInfo;b.bHandleDown=!1,this.fireEvent("handleUp",{weEvent:a,elHandle:b.elHandle,elDrag:b.elDrag})},_onDragStart:function(a){this._findDraggableElement(a.element)&&a.stop(jindo.$Event.CANCEL_DEFAULT)},_onSelectStart:function(a){(this.isDragging()||this._findDraggableElement(a.element))&&a.stop(jindo.$Event.CANCEL_DEFAULT)
}}).extend(jindo.UIComponent),jindo.DropArea=jindo.$Class({$init:function(a,b){this._el=jindo.$(a),this._wel=jindo.$Element(this._el),this.option({sClassName:"droppable",oDragInstance:null}),this.option(b||{}),this._waOveredDroppableElement=jindo.$A([]),this._elHandle=null,this._elDragging=null,this._wfMouseMove=jindo.$Fn(this._onMouseMove,this),this._wfMouseOver=jindo.$Fn(this._onMouseOver,this),this._wfMouseOut=jindo.$Fn(this._onMouseOut,this);var c=this.option("oDragInstance");if(c){var d=this;c.attach({handleDown:function(a){d._elHandle=a.elHandle,d._waOveredDroppableElement.empty()},dragStart:function(a){d._reCalculate(),d.fireEvent(a.sType,a),d._wfMouseMove.attach(document,"mousemove")},drag:function(a){d._elDragging=a.elDrag},dragEnd:function(a){var b={};for(var c in a)b[c]=a[c];b.aDrop=d.getOveredLists().concat(),d._clearOveredDroppableElement(a.weEvent,a.bInterupted),d.fireEvent(a.sType,b),d._wfMouseMove.detach(document,"mousemove")},handleUp:function(){d._elDragging=null,d._elHandle=null}})}},_addOveredDroppableElement:function(a){-1==this._waOveredDroppableElement.indexOf(a)&&(this._waOveredDroppableElement.push(a),this.fireEvent("over",{elHandle:this._elHandle,elDrag:this._elDragging,elDrop:a}))},_fireMoveEvent:function(a,b,c,d){var e=(c.pageX-b.nLeft)/(b.nRight-b.nLeft),f=(c.pageY-b.nTop)/(b.nBottom-b.nTop);this.fireEvent("move",{weEvent:d,elHandle:this._elHandle,elDrag:this._elDragging,elDrop:a,nRatioX:e,nRatioY:f})},_removeOveredDroppableElement:function(a){var b=this._waOveredDroppableElement.indexOf(a);-1!=b&&(this._waOveredDroppableElement.splice(b,1),this.fireEvent("out",{elHandle:this._elHandle,elDrag:this._elDragging,elDrop:a}))},_clearOveredDroppableElement:function(a,b){if(b)return void this._waOveredDroppableElement.empty();for(var c;c=this._waOveredDroppableElement.$value()[0];)this._waOveredDroppableElement.splice(0,1),this.fireEvent("drop",{weEvent:a,elHandle:this._elHandle,elDrag:this._elDragging,elDrop:c})},getOveredLists:function(){return this._waOveredDroppableElement?this._waOveredDroppableElement.$value():[]},_isChildOfDropArea:function(a){return this._el===document||this._el===a?!0:this._wel.isParentOf(a)},_findDroppableElement:function(a){if(!a)return null;var b="."+this.option("sClassName"),c=jindo.$$.test(a,b)?a:jindo.$$.getSingle("! "+b,a);return this._isChildOfDropArea(a)||(c=null),c},_isDragging:function(){var a=this.option("oDragInstance");return a&&a.isDragging()},_onMouseMove:function(a){if(this._isDragging()){var b=a.pos();if(a.element==this._elDragging||jindo.$Element(this._elDragging).isParentOf(a.element))for(var c,d,e=this._aItem,f=this._aItemRect,g=0;(c=f[g])&&(d=e[g]);g++)c.nLeft<=b.pageX&&b.pageX<=c.nRight&&c.nTop<=b.pageY&&b.pageY<=c.nBottom?(this._addOveredDroppableElement(d),this._fireMoveEvent(d,c,b,a)):this._removeOveredDroppableElement(d);else{var h=this._findDroppableElement(a.element);if(this.elPrevMove&&this.elPrevMove!=h&&(this._removeOveredDroppableElement(this.elPrevMove),this.elPrevMove=null),h==a.element||!h&&document.elementFromPoint){var i=[document.documentElement.scrollLeft||document.body.scrollLeft,document.documentElement.scrollTop||document.body.scrollTop];h=this._findDroppableElement(document.elementFromPoint(b.pageX-i[0],b.pageY-i[1]))}if(!h)return;this.elPrevMove=h,this._addOveredDroppableElement(h);var j=jindo.$Element(h).offset(),k={nLeft:j.left,nTop:j.top,nRight:j.left+h.offsetWidth,nBottom:j.top+h.offsetHeight};k.nLeft<=b.pageX&&b.pageX<=k.nRight&&k.nTop<=b.pageY&&b.pageY<=k.nBottom&&this._fireMoveEvent(h,k,b,a)}}},_onMouseOver:function(a){if(this._isDragging()){var b=this._findDroppableElement(a.element);b&&this._addOveredDroppableElement(b)}},_onMouseOut:function(a){if(this._isDragging()){var b=this._findDroppableElement(a.element);b&&a.relatedElement&&!jindo.$Element(a.relatedElement).isChildOf(a.element)&&this._removeOveredDroppableElement(b)}},_getRectInfo:function(a){var b=jindo.$Element(a).offset();return{nLeft:b.left,nTop:b.top,nRight:b.left+a.offsetWidth,nBottom:b.top+a.offsetHeight}},_reCalculate:function(){var a=jindo.$$("."+this.option("sClassName"),this._el);this._el.tagName&&jindo.$$.test(this._el,"."+this.option("sClassName"))&&a.push(this._el),this._aItem=a,this._aItemRect=[];for(var b,c=0;b=a[c];c++)this._aItemRect.push(this._getRectInfo(b))},refresh:function(){return this._reCalculate(),this}}).extend(jindo.Component),jindo.Tree=jindo.$Class({_bIsActivating:!1,_sTemplate:null,_htNodeData:null,_el:null,_elSelectedNode:null,$init:function(a,b){this.option({sClassPrefix:"tree-",sEventSelect:"click",sEventExpand:"dblclick",bExpandOnSelect:!0,bActivateOnload:!0}),this.option(b||{});var c=this.option("sClassPrefix");this.htClassName={sNode:c+"node",sLastNode:c+"last-node",sHasChild:c+"has-child",sButton:c+"button",sLabel:c+"label",sSelected:c+"selected",sCollapsed:c+"collapsed"},this.setNodeTemplate('<li class="{=sNodeClass}{if bLastNode} {=sLastNodeClass}{/if}"><div{if bHasChild} class="{=sHasChildClass}"{/if}><button class="{=sButtonClass}">+</button><span class="{=sLabelClass}" unselectable="on">{=sText}</span></div></li>'),this._htNodeData={},a=jindo.$(a),this._setRootList(a),this._wfSelectHandler=jindo.$Fn(this._onSelectEvent,this),this._wfExpandHandler=jindo.$Fn(this._onExpandEvent,this),this._makeNodeDataKeyFromHTML(),this.paintAllNodes();var d=jindo.$$.getSingle("."+this.htClassName.sNode+" > ."+this.htClassName.sSelected,this.getRootList());d&&this._setSelectedNode(this.getNode(d)),this.option("bActivateOnload")&&this.activate()},_onActivate:function(){var a=this.getRootList();jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(a).preventTapHighlight(!0),this._wfSelectHandler.attach(a,this.option("sEventSelect")),this._wfExpandHandler.attach(a,this.option("sEventExpand"))},_onDeactivate:function(){var a=this.getRootList();jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(a).preventTapHighlight(!1),this._wfSelectHandler.detach(a,this.option("sEventSelect")),this._wfExpandHandler.detach(a,this.option("sEventExpand"))},_onSelectEvent:function(a){var b=a.element,c=this.getNode(b);if(c){var d=jindo.$$.test(b,"."+this.htClassName.sButton)?b:jindo.$$.getSingle("! ."+this.htClassName.sButton,b);if(d)return void(this.isCollapsed(c)?this.expandNode(c):this.collapseNode(c));var e=jindo.$$.test(b,"."+this.htClassName.sLabel)?b:jindo.$$.getSingle("! ."+this.htClassName.sLabel,b);if(e){var f=this.getPartsOfNode(c);f.elItem&&this.fireEvent(a.type,{element:c,weEvent:a})&&this.selectNode(c)}}},_onExpandEvent:function(a){var b=a.element,c=this.getNode(b);if(c&&this.hasChild(c)){var d=jindo.$$.test(b,"."+this.htClassName.sLabel)?b:jindo.$$.getSingle("! ."+this.htClassName.sLabel,b);if(d){var e={element:c,weEvent:a},f=this.getPartsOfNode(c);f.elItem&&jindo.$Element(f.elItem).visible()&&(this.isCollapsed(c)?this.fireEvent(a.type,e)&&this.expandNode(c):this._bExpandOnSelect||this.fireEvent(a.type,e)&&this.collapseNode(c))}}},paintNode:function(a,b){if("undefined"==typeof b&&(b=!0),this._paintNode(a),b)for(var c=this.getChildNodes(a),d=0;d<c.length;d++)this.paintNode(c[d]);return this},paintAllNodes:function(a){return this.paintNode(a||this.getRootNode()),this},_paintNode:function(a){if(a){var b=this.getPartsOfNode(a),c=this.getChildNodes(a),d=this.getNodeData(a),e=jindo.$Element(a),f=jindo.$Element(b.elItem);if(delete d._aChildren,this.hasChild(a)){f.addClass(this.htClassName.sHasChild),d.bHasChild=!0,d._aChildren=[];var g=this;jindo.$A(c).forEach(function(a){d._aChildren.push(g.getNodeData(a))})}else d.bHasChild=!1,f.removeClass(this.htClassName.sHasChild),b.elChild&&b.elChild.parentNode.removeChild(b.elChild);d.bLastNode=jindo.$$.getSingle("~ ."+this.htClassName.sNode,a)?!1:!0,d.bLastNode?e.addClass(this.htClassName.sLastNode):e.removeClass(this.htClassName.sLastNode),a.parentNode.style.zoom=1}},getNodeTemplate:function(){return this._sTemplate},setNodeTemplate:function(a){return this._sTemplate=a,this},getChildListOfNode:function(a){return jindo.$$.getSingle("ul",a)},getRootList:function(){return this._el},_setRootList:function(a){this._el=a},getNode:function(a){var b=jindo.$$.test(a,"."+this.htClassName.sNode)?a:jindo.$$.getSingle("! ."+this.htClassName.sNode,a);return b&&jindo.$Element(b).isChildOf(this.getRootList())?b:null},getPartsOfNode:function(a){var b=jindo.$$("> *",a);return{elItem:b[0],elChild:b[1]}},getNodeType:function(a){return a===this.getRootNode()?"root":this.getChildNodes(a).length>0?"internal":"leaf"},getRootNode:function(){return this._elRootNode?this._elRootNode:(this._elRootNode=jindo.$$.getSingle("."+this.htClassName.sNode,this.getRootList()),this._elRootNode)},getAllNodes:function(){return jindo.$$("."+this.htClassName.sNode,this.getRootList())},getChildNodes:function(a){var b=this.getChildListOfNode(a);return b?jindo.$$("> ."+this.htClassName.sNode,b):[]},hasChild:function(a){var b=this.getPartsOfNode(a);return b.elChild&&b.elChild.getElementsByTagName("li")[0]?!0:!1},getParentNode:function(a){var b=this.getRootNode();return a===b?null:this.getNode(a.parentNode)},getPreviousNode:function(a){var b=jindo.$$.getSingle("!~ ."+this.htClassName.sNode,a);return b?this.getNode(b):null},getNextNode:function(a){var b=jindo.$$.getSingle("~ ."+this.htClassName.sNode,a);return b?this.getNode(b):null},getSelectedNode:function(){return this._elSelectedNode},_setSelectedNode:function(a){this._elSelectedNode=a},isCollapsed:function(a){return jindo.$Element(a).hasClass(this.htClassName.sCollapsed)},getNodeDepth:function(a){for(var b=-1;a&&a!=this.getRootList();a=a.parentNode)jindo.$$.test(a,"."+this.htClassName.sNode)&&b++;return b},setNodeData:function(a,b){var c=this._getNodeDataKey(a);delete b._aChildren,delete b.sLabel;for(var d in b)this._htNodeData[c][d]=b[d];return this},getNodeLabelElement:function(a){return jindo.$$.getSingle("."+this.htClassName.sLabel,a)},getNodeLabel:function(a){return jindo.$Element(this.getNodeLabelElement(a)).html()},setNodeLabel:function(a,b){var c=this._getNodeDataKey(a);return this._htNodeData[c].sLabel=b,jindo.$Element(this.getNodeLabelElement(a)).html(b),this},_makeNodeDataKeyFromHTML:function(){for(var a=this.getAllNodes(),b=0;b<a.length;b++){var c=a[b];this._makeNodeDataKey(c),this._makeNodeData(c)}},_makeNodeDataKey:function(a){var b=jindo.$Element(a),c=this._getNodeDataKey(a);if(c)return!1;var d=this.option("sClassPrefix"),e=("data-"+(new Date).getTime()+parseInt(1e7*Math.random(),10)).toString(),f=d+e;b.addClass(f);var g=this._getNodeDataKey(a);return this._htNodeData[g]={},g},_makeNodeData:function(a){var b=this.getNodeData(a);b.element=a,b.sLabel=jindo.$Element(this.getNodeLabelElement(a)).text(),b.bLastNode=jindo.$$.getSingle("~ ."+this.htClassName.sNode,a)?!1:!0},_getNodeDataKey:function(a){var b=a.className,c=this.option("sClassPrefix"),d=new RegExp("("+c+"data-[0-9]+)");return d.test(b)?RegExp.$1:null},getNodeData:function(a){return a?this._htNodeData[this._getNodeDataKey(a)]:this._htNodeData},_clearNodeData:function(a){var b=this.getParentNode(a),c=this.getNodeData(a),d=this._getNodeDataKey(a);if(b){var e=this.getNodeData(b);if(e){var f=jindo.$A(e._aChildren).indexOf(c);f>-1&&e._aChildren.splice(f,1)}}var g=this;this.hasChild(a)&&jindo.$A(this.getChildNodes(a)).forEach(function(a){g._clearNodeData(a)}),delete this._htNodeData[d]},expandNode:function(a,b){if(this.fireEvent("beforeExpand",{element:a})){var c=this.getPartsOfNode(a),d=[];jindo.$$.test(c.elItem,"."+this.htClassName.sHasChild)&&d.push(a),b&&(d=d.concat(jindo.$$("."+this.htClassName.sHasChild,a)));for(var e,f=0;e=d[f];f++){var g=this.getNode(e);jindo.$Element(g).removeClass(this.htClassName.sCollapsed),this.fireEvent("expand",{element:g})}return this}},collapseNode:function(a,b){if(this.fireEvent("beforeCollapse",{element:a})){var c=this.getPartsOfNode(a),d=[];jindo.$$.test(c.elItem,"."+this.htClassName.sHasChild)&&d.push(a),b&&(d=d.concat(jindo.$$("."+this.htClassName.sHasChild,a)));for(var e,f=0;e=d[f];f++){var g=this.getNode(e);jindo.$Element(g).addClass(this.htClassName.sCollapsed),this.fireEvent("collapse",{element:g})}return this}},selectNode:function(a){var b=this.getPartsOfNode(a),c=this.getSelectedNode(),d=b.elItem;if(!this.fireEvent("beforeSelect",{element:a}))return!1;if(c!=a&&(this.deselectNode(),jindo.$Element(d).addClass(this.htClassName.sSelected),this._setSelectedNode(a)),this.fireEvent("select",{element:a}),this.option("bExpandOnSelect")&&c!=a&&this.isCollapsed(a)){var e=this;this._bExpandOnSelect=!0,setTimeout(function(){e._bExpandOnSelect=!1},500),this.expandNode(a)}return!0},deselectNode:function(){var a=this.getSelectedNode();return a&&jindo.$Element(this.getPartsOfNode(a).elItem).removeClass(this.htClassName.sSelected),this._setSelectedNode(null),this},_createChild:function(a){var b=this.getChildListOfNode(a);b||(b=jindo.$("<ul>"),a.appendChild(b));try{return b}finally{b=null}},removeNode:function(a){if(!a||a===this.getRootNode())return this.clearNode(a),this;var b=this.getNodeData(a),c=b.bLastNode?this.getPreviousNode(a):null,d=1==a.parentNode.childNodes.length,e=this.getParentNode(a);if(this._clearNodeData(a),a.parentNode.removeChild(a),this.selectNode(e),this._paintNode(c),d){var f=this.getNodeData(e);f.bHasChild=!1}return this._paintNode(e),this},clearNode:function(a){var b=this.getChildListOfNode(a);if(b){for(var c,d=b.getElementsByTagName("li"),e=0;c=d[e];e++)this._clearNodeData(c);b.parentNode.removeChild(b);var f=this.getNodeData(a);return f.bHasChild=!1,this._paintNode(a),!0}return!1},clearTree:function(){return this.clearNode(this.getRootNode()),this},_moveNodes:function(a,b,c){for(var d,e=0;d=b[e];e++)c(d)},appendNode:function(a,b){if(!(b instanceof Array))return arguments.callee.call(this,a,[b]);var c=this,d=this._createChild(a);return this._moveNodes(a,b,function(a){var b=null;b=c.getParentNode(a),d.appendChild(a),b&&(c.paintNode(b,!1),jindo.$A(c.getChildNodes(b)).forEach(function(a){c.paintNode(a,!1)}))}),this.paintNode(a,!1),jindo.$A(this.getChildNodes(a)).forEach(function(a){c.paintNode(a,!1)}),this},insertNodeBefore:function(a,b){if(a!=this.getRootNode()){if(!(b instanceof Array))return arguments.callee.call(this,a,[b]);var c=this,d=a.parentNode;return this._moveNodes(a,b,function(b){var e=null;e=c.getNode(d),d.insertBefore(b,a),e&&jindo.$A(c.getChildNodes(e)).forEach(function(a){c.paintNode(a,!1)})}),this}},insertNodeAfter:function(a,b){if(a!=this.getRootNode()){if(!(b instanceof Array))return arguments.callee.call(this,a,[b]);var c=this,d=a.parentNode,e=a;return this._moveNodes(a,b,function(a){var b=null;b=c.getNode(d),d.insertBefore(a,e.nextSibling),e=a,b&&jindo.$A(c.getChildNodes(b)).forEach(function(a){c.paintNode(a,!1)})}),this}},_getCode:function(a){if(a instanceof Array){for(var b=[],c=this.getNodeTemplate(),d=0;d<a.length;d++){var e=a[d],f={sTemplate:c,htData:e};this.fireEvent("beforeProcessData",f);var g={sNodeClass:this.htClassName.sNode,bLastNode:d==a.length-1?!0:!1,sLastNodeClass:this.htClassName.sLastNode,bHasChild:"undefined"!=typeof e._aChildren&&e._aChildren.length>0?!0:!1,sHasChildClass:this.htClassName.sHasChild,sCollapsedClass:this.htClassName.sCollapsed,sButtonClass:this.htClassName.sButton,sLabelClass:this.htClassName.sLabel,sText:e.sLabel,htData:e},h=jindo.$Template(f.sTemplate).process(g);h=this._getChildCode(e._aChildren,h),b.push(h)}return b.join("\n")}},_getChildCode:function(a,b){var c=a?this._getCode(a):"";if(c){var d=!1;b=b.replace(/(<ul(\s[^>]*)*>)(<\/ul>)/i,function(a,b,e,f){return d=!0,b+c+f}),d||(b=b.replace(/<\/li>/i,function(a){return"\n<ul>"+c+"</ul>\n"+a}))}return b},_setData:function(a,b){for(var c=jindo.$$("> ."+this.htClassName.sNode,a),d=0,e=c.length;e>d;d++){var f=c[d],g=b[d],h=this._makeNodeDataKey(f);g.bLastNode=d===e-1,this._htNodeData[h]=g;var i=g.bHasChild="undefined"!=typeof g._aChildren&&g._aChildren.length||g.bHasChild?!0:!1;i&&this._setData(this.getChildListOfNode(f),g._aChildren)}},createNode:function(a){var b=jindo.$("<ul>");b.innerHTML=this._getCode(a);var c=jindo.$$("> ."+this.htClassName.sNode,b);return this._setData(b,a),c},getNodeRawData:function(a){return this.getNodeData(a)},getSelectCount:function(){return this}}).extend(jindo.UIComponent),jindo.Timer=jindo.$Class({$init:function(){this._nTimer=null,this._nLatest=null,this._nRemained=0,this._nDelay=null,this._fRun=null,this._bIsRunning=!1},start:function(a,b){return this.abort(),this._nRemained=0,this._nDelay=b,this._fRun=a,this._bIsRunning=!0,this._nLatest=this._getTime(),this.fireEvent("wait"),this._excute(this._nDelay,!1),!0},isRunning:function(){return this._bIsRunning},_getTime:function(){return(new Date).getTime()},_clearTimer:function(){var a=!1;return this._nTimer&&(clearTimeout(this._nTimer),this._bIsRunning=!1,a=!0),this._nTimer=null,a},abort:function(){return this._clearTimer(),this._fRun?(this.fireEvent("abort"),this._fRun=null,!0):!1},pause:function(){var a=this._getTime()-this._nLatest;return this._nRemained=Math.max(this._nDelay-a,0),this._clearTimer()},_excute:function(a){var b=this;this._clearTimer(),this._bIsRunning=!0;var c=function(a){if(b._fRun&&(b._nTimer||a)){b.fireEvent("run");var c=b._fRun();if(b._nLatest=b._getTime(),!c)return a||clearTimeout(b._nTimer),b._nTimer=null,b._bIsRunning=!1,void b.fireEvent("end");b.fireEvent("wait"),b._excute(b._nDelay,!1)}};a>-1?this._nTimer=setTimeout(c,a):c(!0)},resume:function(){return!this._fRun||this.isRunning()?!1:(this._bIsRunning=!0,this.fireEvent("wait"),this._excute(this._nRemained,!0),this._nRemained=0,!0)}}).extend(jindo.Component),jindo.FileUploader=jindo.$Class({_bIsActivating:!1,_aHiddenInput:[],$init:function(a,b){var c={sUrl:"",sCallback:"",htData:{},sFiletype:"*",sMsgNotAllowedExt:"업로드가 허용되지 않는 파일형식입니다",bAutoUpload:!1,bAutoReset:!0,bActivateOnload:!0};this.option(c),this.option(b||{}),this._el=jindo.$(a),this._wel=jindo.$Element(this._el),this._elForm=this._el.form,this._aHiddenInput=[],this.constructor._oCallback={},this._wfChange=jindo.$Fn(this._onFileSelectChange,this),this._sFunctionName=null,this.option("bActivateOnload")&&this.activate()},_appendIframe:function(){var a="tmpFrame_"+this._makeUniqueId();this._welIframe=jindo.$Element(jindo.$('<iframe name="'+a+'" src="">')).css({position:"absolute",width:"1px",height:"1px",left:"-100px",top:"-100px"}),document.body.appendChild(this._welIframe.$value())},_removeIframe:function(){this._welIframe&&this._welIframe.leave()},getBaseElement:function(){return this.getFileSelect()},getFileSelect:function(){return this._el},getFormElement:function(){return this._elForm},upload:function(){this._appendIframe();var a=this.getFormElement(),b=jindo.$Element(a),c=this._welIframe.attr("name"),d=this._sFunctionName=c+"_func",e=this.option("sUrl");b.attr({target:c,action:e}),this._aHiddenInput.push(this._createElement("input",{type:"hidden",name:"callback",value:this.option("sCallback")})),this._aHiddenInput.push(this._createElement("input",{type:"hidden",name:"callback_func",value:d}));for(var f in this.option("htData"))this._aHiddenInput.push(this._createElement("input",{type:"hidden",name:f,value:this.option("htData")[f]}));for(var g=0;g<this._aHiddenInput.length;g++)a.appendChild(this._aHiddenInput[g]);this.constructor._oCallback[d+"_success"]=jindo.$Fn(function(a){this.option("bAutoReset")&&this.reset(),this._revertFormAttr(),this.fireEvent("success",{htResult:a}),this._clear()},this).bind(),this.constructor._oCallback[d+"_error"]=jindo.$Fn(function(a){this.option("bAutoReset")&&this.reset(),this._revertFormAttr(),this.fireEvent("error",{htResult:a}),this._clear()},this).bind(),a.submit()},reset:function(){var a=jindo.$("<form>");this._wel.wrap(a),a.reset(),jindo.$Element(a).replace(this._el);var b=jindo.$Agent().navigator();if(b.ie&&b.version<=10){var c=this.getFormElement();c.type="radio",c.type="file"}return this._clear(),this},_revertFormAttr:function(){var a=this.getFormElement(),b=jindo.$Element(a);b.attr({target:this._sPrevTarget,action:this._sAction})},_onActivate:function(){var a=this.getFormElement(),b=jindo.$Element(a);this._sPrevTarget=b.attr("target"),this._sAction=b.attr("action"),this._el.value="",this._wfChange.attach(this._el,"change")},_onDeactivate:function(){this._wfChange.detach(this._el,"change")},_makeUniqueId:function(){return(new Date).getMilliseconds()+Math.floor(1e5*Math.random())},_createElement:function(a,b){var c=jindo.$("<"+a+">"),d=jindo.$Element(c);for(var e in b)d.attr(e,b[e]);return c},_checkExtension:function(a){for(var b,c=this.option("sFiletype").split(";"),d=0;d<c.length;d++)if(b="*.*"==c[d]?"*":c[d],b=b.replace(/^\s+|\s+$/,""),b=b.replace(/\./g,"\\."),b=b.replace(/\*/g,"[^\\/]+"),new RegExp(b+"$","gi").test(a))return!0;return!1},_onFileSelectChange:function(a){var b=a.element.value,c=this._checkExtension(b),d={sValue:b,bAllowed:c,sMsgNotAllowedExt:this.option("sMsgNotAllowedExt")};b.length&&this.fireEvent("select",d)&&(c?this.option("bAutoUpload")&&this.upload():alert(d.sMsgNotAllowedExt))},_clear:function(){null!=this._sFunctionName&&(delete this.constructor._oCallback[this._sFunctionName+"_success"],delete this.constructor._oCallback[this._sFunctionName+"_error"],this._sFunctionName=null);for(var a=0,b=this._aHiddenInput.length;b>a;a++)jindo.$Element(this._aHiddenInput[a]).leave();this._aHiddenInput.length=0,this._removeIframe()}}).extend(jindo.UIComponent),jindo.Transition=jindo.$Class({_nFPS:30,_aTaskQueue:null,_oTimer:null,_bIsWaiting:!0,_bIsPlaying:!1,$init:function(a){this._aTaskQueue=[],this._oTimer=new jindo.Timer,this._oSleepTimer=new jindo.Timer,this.option({fEffect:jindo.Effect.linear,bCorrection:!1}),this.option(a||{})},fps:function(a){return arguments.length>0?(this._nFPS=a,this):this._nFPS},isPlaying:function(){return this._bIsPlaying},abort:function(){return this._aTaskQueue=[],this._oTimer.abort(),this._oSleepTimer.abort(),this._bIsPlaying&&this.fireEvent("abort"),this._bIsWaiting=!0,this._bIsPlaying=!1,this._htTaskToDo=null,this},start:function(){return arguments.length>0&&this.queue.apply(this,arguments),this._prepareNextTask(),this},queue:function(a){var b;if("function"==typeof arguments[0])b={sType:"function",fTask:arguments[0]};else{var c=[];if(arguments[1]instanceof Array)c=arguments[1];else{var d=[];jindo.$A(arguments).forEach(function(a,b){b>0&&(d.push(a),b%2===0&&(c.push(d.concat()),d=[]))})}b={sType:"task",nDuration:a,aList:[]};for(var e=0,f=c.length;f>e;e++){var g,h=[],i=c[e][1];for(var j in i)g=i[j],h.push(/^(@|style\.)(\w+)/i.test(j)?["style",RegExp.$2,g]:["attr",j,g]);b.aList.push({elTarget:c[e][0],aValue:h})}}return this._queueTask(b),this},pause:function(){return this._oTimer.abort()&&this.fireEvent("pause"),this},resume:function(){if(this._htTaskToDo){this._bIsWaiting===!1&&this._bIsPlaying===!0&&this.fireEvent("resume"),this._doTask(),this._bIsWaiting=!1,this._bIsPlaying=!0;var a=this;this._oTimer.start(function(){var b=!a._doTask();return b&&(a._bIsWaiting=!0,setTimeout(function(){a._prepareNextTask()},0)),!b},this._htTaskToDo.nInterval)}return this},precede:function(){return this.start.apply(this,arguments),this},sleep:function(a,b){return"undefined"==typeof b&&(b=function(){}),this._queueTask({sType:"sleep",nDuration:a,fCallback:b}),this._prepareNextTask(),this},_queueTask:function(a){this._aTaskQueue.push(a)},_dequeueTask:function(){var a=this._aTaskQueue.shift();if(a){if("task"==a.sType)for(var b=a.aList,c=0,d=b.length;d>c;c++)for(var e=b[c].elTarget,f=null,g=0,h=b[c].aValue,i=h.length;i>g;g++){var j=h[g][0],k=h[g][1],l=h[g][2];if("function"!=typeof l){var m=this.option("fEffect");l=l instanceof Array?m(l[0],l[1]):m(l),h[g][2]=l}if(l.setStart)if(this._isHTMLElement(e))switch(f=f||jindo.$Element(e),j){case"style":l.setStart(f.css(k));break;case"attr":l.setStart(f.$value()[k])}else l.setStart(e.getter(k))}return a}return null},_prepareNextTask:function(){if(this._bIsWaiting){var a=this._dequeueTask();if(a)switch(a.sType){case"task":this._bIsPlaying||this.fireEvent("start");var b=1e3/this._nFPS,c=b/a.nDuration;this._htTaskToDo={aList:a.aList,nRatio:0,nInterval:b,nGap:c,nStep:0,nTotalStep:Math.ceil(a.nDuration/b)},this.resume();break;case"function":this._bIsPlaying||this.fireEvent("start"),a.fTask(),this._prepareNextTask();break;case"sleep":this._bIsPlaying&&(this.fireEvent("sleep",{nDuration:a.nDuration}),a.fCallback());var d=this;this._oSleepTimer.start(function(){d.fireEvent("awake"),d._prepareNextTask()},a.nDuration)}else this._bIsPlaying&&(this._bIsPlaying=!1,this.abort(),this.fireEvent("end"))}},_isHTMLElement:function(a){return"tagName"in a},_doTask:function(){for(var a=this._htTaskToDo,b=parseFloat(a.nRatio.toFixed(5),1),c=a.nStep,d=a.nTotalStep,e=a.aList,f={},g=this.option("bCorrection"),h=0,i=e.length;i>h;h++)for(var j=e[h].elTarget,k=null,l=0,m=e[h].aValue,n=m.length;n>l;l++){var o=m[l][0],p=m[l][1],q=m[l][2](b);if(this._isHTMLElement(j)){if(g){var r=/^\-?[0-9\.]+(%|[\w]+)?$/.test(q)&&RegExp.$1||"";if(r){var s=parseFloat(q);s+=f[p]||0,s=parseFloat(s.toFixed(5)),h==i-1?q=Math.round(s)+r:(f[p]=s-Math.floor(s),q=parseInt(s,10)+r)}}switch(k=k||jindo.$Element(j),o){case"style":k.css(p,q);break;case"attr":k.$value()[p]=q}}else j.setter(p,q);this._bIsPlaying&&this.fireEvent("playing",{element:j,sKey:p,sValue:q,nStep:c,nTotalStep:d})}return a.nRatio=Math.min(a.nRatio+a.nGap,1),a.nStep+=1,1!=b}}).extend(jindo.Component),function(){var a=jindo.$Element.prototype.css;jindo.$Element.prototype.css=function(b,c){return"opacity"==b?"undefined"!=typeof c?this.opacity(parseFloat(c)):this.opacity():"undefined"!=typeof c?a.call(this,b,c):a.call(this,b)}}(),jindo.Foggy=jindo.$Class({_elFog:null,_bFogAppended:!1,_oExcept:null,_bFogVisible:!1,_bFogShowing:!1,_oTransition:null,$init:function(a){this.option({sClassName:"fog",nShowDuration:200,nShowOpacity:.5,nHideDuration:200,nHideOpacity:0,fShowEffect:jindo.Effect.linear,fHideEffect:jindo.Effect.linear,nFPS:15,nZIndex:32e3}),this.option(a||{}),this._elFog=jindo.$('<div class="'+this.option("sClassName")+'">'),this._welFog=jindo.$Element(this._elFog),document.body.insertBefore(this._elFog,document.body.firstChild),this._welFog.opacity(this.option("nHideOpacity")),this._welFog.hide(),this._oExcept={},this._oTransition=(new jindo.Transition).fps(this.option("nFPS")),this._fOnResize=jindo.$Fn(this._fitFogToDocument,this),this._fOnScroll=jindo.$Fn(this._fitFogToDocumentScrollSize,this)},_getScroll:function(a){return{top:window.pageYOffset||document[a._docKey].scrollTop,left:window.pageXOffset||document[a._docKey].scrollLeft}},_fitFogToDocument:function(){var a=jindo.$Document();this._elFog.style.left=this._getScroll(a).left+"px",this._elFog.style.width="100%";var b=this;clearTimeout(this._nTimer),this._nTimer=null,this._nTimer=setTimeout(function(){var c=a.clientSize();b._elFog.style.top=b._getScroll(a).top+"px",b._elFog.style.height=c.height+"px",b._elFog.style.left=b._getScroll(a).left+"px"},100)},_fitFogToDocumentScrollSize:function(){var a=jindo.$Document().scrollSize();this._elFog.style.left="0",this._elFog.style.top="0",this._elFog.style.width=a.width+"px",this._elFog.style.height=a.height+"px"},getFog:function(){return this._elFog},isShown:function(){return this._bFogVisible},isShowing:function(){return this._bFogShowing},show:function(a){if(!this._bFogVisible&&this.fireEvent("beforeShow")){if(a){this._oExcept.element=a;var b=jindo.$Element(a).css("position");"static"==b&&(a.style.position="relative"),this._oExcept.position=a.style.position,this._oExcept.zIndex=a.style.zIndex,a.style.zIndex=this.option("nZIndex")+1}this._elFog.style.zIndex=this.option("nZIndex"),this._elFog.style.display="none",this._fitFogToDocument(),this._fOnResize.attach(window,"resize"),this._fOnScroll.attach(window,"scroll"),this._elFog.style.display="block",a&&(a.style.zoom=1,a.style.zoom="");var c=this;this._bFogShowing=!0,this._oTransition.abort().start(this.option("nShowDuration"),this._elFog,{"@opacity":this.option("fShowEffect")(this.option("nShowOpacity"))}).start(function(){c._bFogVisible=!0,c._bFogShowing=!1,c.fireEvent("show")})}},hide:function(){if((this._bFogVisible||this._bFogShowing)&&this.fireEvent("beforeHide")){var a=this;this._oTransition.abort().start(this.option("nHideDuration"),this._elFog,{"@opacity":this.option("fHideEffect")(this.option("nHideOpacity"))}).start(function(){a._elFog.style.display="none";var b=a._oExcept.element;b&&(b.style.position=a._oExcept.position,b.style.zIndex=a._oExcept.zIndex),a._oExcept={},a._fOnResize.detach(window,"resize"),a._fOnScroll.detach(window,"scroll"),a._bFogVisible=!1,a.fireEvent("hide")})}}}).extend(jindo.Component),jindo.TextRange=jindo.$Class({$init:function(a,b){this.option({bActivateOnload:!0}),this.option(b||{}),this._el=jindo.$(a),this._bFocused=!1,this._wfFocus=jindo.$Fn(function(){this._bFocused=!0},this),this._wfBlur=jindo.$Fn(function(){this._bFocused=!1},this),this.option("bActivateOnload")&&this.activate()},_onActivate:function(){this._wfFocus.attach(this._el,"focus").attach(this._el,"keydown"),this._wfBlur.attach(this._el,"blur")},_onDeactivate:function(){this._wfFocus.detach(this._el,"focus").detach(this._el,"keydown"),this._wfBlur.detach(this._el,"blur")},hasFocus:function(){return this._bFocused},getSelection:function(){var a,b,c,d,e,f,g=this._el;if(isNaN(this._el.selectionStart)){var h=document.selection.createRange();h&&h.parentElement()==g&&(f=g.value.length,a=g.value.replace(/\r\n/g,"\n"),b=g.createTextRange(),b.moveToBookmark(h.getBookmark()),c=g.createTextRange(),c.collapse(!1),b.compareEndPoints("StartToEnd",c)>-1?d=e=f:(d=-b.moveStart("character",-f),d+=a.slice(0,d).split("\n").length-1,b.compareEndPoints("EndToEnd",c)>-1?e=f:(e=-b.moveEnd("character",-f),e+=a.slice(0,e).split("\n").length-1)))}else d=g.selectionStart,e=g.selectionEnd;return[d,e]},setSelection:function(a,b){var c=this._el;if("undefined"==typeof b&&(b=a),c.setSelectionRange)c.setSelectionRange(a,b);else if(c.createTextRange){var d=c.createTextRange();d.collapse(!0),d.moveStart("character",a),d.moveEnd("character",b-a),d.select()}},copy:function(){this._bFocused||this._el.focus();var a=this.getSelection();return this._el.value.substring(a[0],a[1])},paste:function(a){this._bFocused||this._el.focus();var b=this._el,c=this.getSelection(),d=b.value,e=d.substr(0,c[0]),f=d.substr(c[1]);d=e+a+f,b.value=d,this.setSelection(c[0]+a.length)},cut:function(){var a=this.copy();return this.paste(""),a}}).extend(jindo.UIComponent),jindo.CheckBox=jindo.$Class({sTagName:"input[type=checkbox]",$init:function(a,b){this.option({sClassPrefix:"checkbox-"}),this.option(b||{}),this._elWrapper=jindo.$(a),this._welWrapper=jindo.$Element(a),this._assignHTMLElements(),this.wfOnClickInput=jindo.$Fn(this._onClickInput,this),this.wfOnClickWrapper=jindo.$Fn(this._onClickWrapper,this),this.wfOnFocusInput=jindo.$Fn(this._onFocusInput,this),this.wfOnBlurInput=jindo.$Fn(this._onBlurInput,this),this.activate(),this.paint()},_assignHTMLElements:function(){var a=this._elWrapper;this._elInput=jindo.$$.getSingle("input",a),"radio"==this._elInput.type&&(this.sTagName="input[type=radio]",this.option("sClassPrefix","radio-"));var b=this.option("sClassPrefix");this._elSubstitute=jindo.$$.getSingle("."+b+"mark",a),this._welSubstitute=jindo.$Element(this._elSubstitute)},getInput:function(){return this._elInput},getChecked:function(){return this.getInput().checked},setChecked:function(a,b){"undefined"==typeof b&&(b=!0);var c=this.getInput(),d=c.checked;if(d!=a){switch(c.checked=a,c.type){case"checkbox":this.paint();break;case"radio":;jindo.$A(this.constructor._aInstances).forEach(function(a){a.getInput().name==c.name&&a.paint()})}b&&this._fireChangeEvent(a)}return this},_fireChangeEvent:function(a){this.fireEvent("change",{bChecked:a})},enable:function(){return this.getInput().disabled=!1,this.paint(),this},disable:function(){return this.getInput().disabled=!0,this.paint(),this},_onClickInput:function(a){a.stop(jindo.$Event.CANCEL_DEFAULT);var b=this;setTimeout(function(){b._welWrapper.fireEvent("click")},1)},_onClickWrapper:function(a){var b=this._elInput;b.disabled||a.element===b||(b.focus(),this.fireEvent("beforeChange",{bChecked:b.checked})&&this.setChecked("radio"==b.type?!0:!b.checked))
},_onFocusInput:function(){this._welWrapper.addClass(this.option("sClassPrefix")+"focused")},_onBlurInput:function(){this._welWrapper.removeClass(this.option("sClassPrefix")+"focused")},_onActivate:function(){this.$super._onActivate(),this._welWrapper.addClass(this.option("sClassPrefix")+"applied"),this.wfOnClickInput.attach(this._elInput,"click"),this.wfOnClickWrapper.attach(this._elWrapper,"click"),this.wfOnFocusInput.attach(this._elInput,"focus"),this.wfOnBlurInput.attach(this._elInput,"blur")},_onDeactivate:function(){this._welWrapper.removeClass(this.option("sClassPrefix")+"applied"),this.wfOnClickInput.detach(this._elInput,"click"),this.wfOnClickWrapper.detach(this._elWrapper,"click"),this.wfOnFocusInput.detach(this._elInput,"focus"),this.wfOnBlurInput.detach(this._elInput,"blur"),this.$super._onDeactivate()},_onPaint:function(){var a=this.option("sClassPrefix");this._elInput.disabled?this._welWrapper.addClass(a+"disabled"):this._welWrapper.removeClass(a+"disabled"),this._elInput.checked?this._welSubstitute.addClass(a+"checked"):this._welSubstitute.removeClass(a+"checked")}}).extend(jindo.HTMLComponent),jindo.InlineTextEdit=jindo.$Class({_bIsEditing:!1,$init:function(a){var b={elInput:jindo.$('<input type="text">'),bHandleBlur:!0,bHandleKeyDown:!0};this.option(b),this.option(a||{}),this._wfBlur=jindo.$Fn(this._onBlur,this),this._wfKeyDown=jindo.$Fn(this._onKeyDown,this)},getTextInput:function(){return this._getTextInput().$value()},_getTextInput:function(){return this._welInput&&this._welInput.$value()?this._welInput:this._welInput=jindo.$Element(this.option("elInput"))},_resize:function(a,b){var c=jindo.$Element(a),d=jindo.$Element(b);d.width(c.width()).height(c.height())},isEditing:function(){return this._bIsEditing},edit:function(a,b){var c=jindo.$Element(a),d=this._getTextInput(),e=d.$value();return this._welHidden=c,c.after(e),this._resize(b||a,e),c.hide(),e.value=c.text(),e.focus(),this._bIsEditing=!0,this.option("bHandleBlur")&&this._wfBlur.attach(e,"blur"),this.option("bHandleKeyDown")&&this._wfKeyDown.attach(e,"keydown"),this},apply:function(){if(this.isEditing()){var a=this._getTextInput(),b=a.$value(),c=b.value,d={sText:c,elInput:b,elText:this._welHidden.$value()};this._welHidden.text()!=c&&this.fireEvent("beforeChange",d)?(this._welHidden.text(d.sText).show(),this._bIsEditing=!1,this.fireEvent("change",d)):this._welHidden.show(),this._wfBlur.detach(b,"blur").detach(b,"keydown"),a.leave()}return this},cancel:function(){if(this.isEditing()){var a=this._getTextInput(),b=a.$value();this._welHidden.show(),this._bIsEditing=!1,this._wfBlur.detach(b,"blur").detach(b,"keydown"),a.leave()}return this},_onBlur:function(){this.apply()},_onKeyDown:function(a){switch(a.key().keyCode){case 27:this.cancel();break;case 13:"input"==this.getTextInput().tagName.toLowerCase()&&this.apply()}}}).extend(jindo.Component),jindo.Keyframe=jindo.$Class({$init:function(a){this._nCurFrame=null,this._nCurIdx=null,this._aKeyframeLists=[],this._oPreprocessed=null,this._bPreprocessed=!1,this._oRAF=null;var b=jindo.$Agent(),c=b.os(),d=b.navigator();this._bHasTransformRenderBug=c.ios&&5===parseInt(c.version,10)&&d.msafari,this.option({fEffect:jindo.Effect.linear,nAnimationDuration:0}),this.option(a||{}),this._fDefaultEffect=this.option("fEffect")()},_loop:function(a,b,c,d){!function e(f){return c(f),++f<b?void(a?(window.requestAnimationFrame||window.setTimeout)(function(){e(f)},1e3/60):e(f)):void d()}(0)},_preprocessKeyframes:function(a){if(this._bPreprocessed)return void this.fireEvent("preprocessEnd");if(!this._oPreprocessed){this._oPreprocessed={objs:{},frames:null};var b=this._aKeyframeLists.sort(function(a,b){return a.frame-b.frame}),c={},d=[],e={},f={},g=this,h=function(){g._loop(a,b.length,function(a){var h,i=b[a],j=i.frame,k=g._toPropObj(i.propLists),l=c[j]={frame:j,dynamic:{},"static":{}};d.push(l);for(h in k)if(k.hasOwnProperty(h)){var m=j,n=k[h],o=g._fDefaultEffect;"function"==typeof n&&(o=n,n=n.end);var p=e[h];p&&(p.effect=o,p.frames[1]=m,p.vals[1]=n,o.effectConstructor===jindo.Effect.stepEnd&&(p.vals[1]=p.vals[0])),h in f||(f[h]=n),e[h]={effect:null,frames:[m],vals:[n]}}for(h in e)e.hasOwnProperty(h)&&(c[j].dynamic[h]=e[h])},i)},i=function(){g._loop(a,d.length,function(a){var b=d[a];for(var c in f)if(f.hasOwnProperty(c)){if(c in b.dynamic)continue;b["static"][c]=f[c]}},j)},j=function(){g._oPreprocessed.frames=d;var a=g._oPreprocessed.objs;for(var b in a)if(a.hasOwnProperty(b))try{delete a[b].__KEYFRAME_UNIQ}catch(e){a[b].__KEYFRAME_UNIQ=void 0}c=null,g._bPreprocessed=!0,g.fireEvent("preprocessEnd")};h()}},preprocess:function(a){return this._preprocessKeyframes(!!a),this},_getPropLists:function(a,b){for(var c,d=this._oPreprocessed.frames,e=d.length-1,f=0;c=d[f];f++)if(c.frame>a){e=Math.max(0,f-1);break}var g=d[e],h={};return h=this._getDynamicProps(h,a,g),(b||this._nCurIdx!==e)&&(h=this._getStaticProps(h,a,g)),this._nCurIdx=e,h},_get:function(a,b){if(!this._bPreprocessed)throw new Error("First, you need to call preprocess().");var c,d,e=this._getPropLists(a,b),f=this._oPreprocessed.objs,g=[];for(var h in e)e.hasOwnProperty(h)&&(c=f[h],d=e[h],g.push(c,d));return g},get:function(a){return this._get(a,!0)},frame:function(a,b){var c=this,d=this._nCurFrame;if(b||a!==d){this._nCurFrame=a,this._oRAF&&(cancelAnimationFrame(this._oRAF),this._oRAF=null),c._bPlaying&&c._frame(d,b);var e=this.option("nAnimationDuration");if(e&&null!==d){var f=jindo.Effect.easeOut(Math.round(1e6*d)/1e6,Math.round(1e6*a)/1e6),g=(new Date).getTime(),h=!0;return c._bPlaying=!0,void function i(){c._oRAF=requestAnimationFrame(function(){var a=Math.max(0,Math.min(1,(new Date-g)/e));return c._frame(f(a),h),h=!1,c.oRAF=null,1>a?i():void(c._bPlaying=!1)})}()}return this._frame(a,b)}},_frame:function(a,b){for(var c,d,e,f,g=this._bHasTransformRenderBug,h=this._get(a,b),i=null,j=this,k=0,l=h.length;l>k;k+=2)if(c=h[k],c="function"==typeof c?c():c,d=h[k+1],i=i||function(a,b){e=jindo.$Element(a);for(var c in b)b.hasOwnProperty(c)&&(f=b[c],/^@(.*)$/.test(c)?(c=RegExp.$1,/transition/.test(c)&&(f=j._getCSSVal(f)),g&&"@transform"===c&&("@left"in b||"@top"in b)&&a.clientHeight,e.$value().style[j._getCSSKey(c)]=f):a[c]=f)},c instanceof Array)for(var m=0,n=c.length;n>m;m++)i(c[m],d);else i(c,d)},_getStaticProps:function(a,b,c){var d=c["static"];for(var e in d)if(/^(.+):(.+)$/.test(e)){var f=RegExp.$1,g=RegExp.$2,h=d[e];a[f]=a[f]||{},a[f][g]=h}return a},_getDynamicProps:function(a,b,c){var d=c.dynamic,e=c["static"],f=[];for(var g in d)if(/^(.+):(.+)$/.test(g)){var h=RegExp.$1,i=RegExp.$2,j=d[g],k=j.effect,l=j.vals[0],m=j.vals[1];if(!k||l===m){e[g]=l,f.push(g);continue}k.start=l,k.end=m,/^@transform/.test(i)&&(k=this._getTransformFunction(k));var n=Math.max(0,Math.min(1,(b-j.frames[0])/(j.frames[1]-j.frames[0])));try{j=k(n)}catch(o){if(!/^unit error/.test(o.message))throw o;e[g]=l,f.push(g);continue}a[h]=a[h]||{},a[h][i]=j}for(var p=0,q=f.length;q>p;p++)delete d[f[p]];return f.length=null,a},_toPropObj:function(a){function b(a){var b;if("object"==typeof a)b=a.__KEYFRAME_UNIQ=a.__KEYFRAME_UNIQ||Math.floor(Math.random()*(new Date).getTime())+"";else{for(var c in d)if(d.hasOwnProperty(c)&&d[c]===a)return c;b=Math.floor(Math.random()*(new Date).getTime())+""}return d[b]=a,b}for(var c={},d=this._oPreprocessed.objs,e=0,f=a.length;f>e;e+=2){var g=a[e];if(g){var h=a[e+1],i=b(g);for(var j in h)h.hasOwnProperty(j)&&(c[i+":"+j]=h[j])}}return c},set:function(a,b){if("number"==typeof a)return this._aKeyframeLists.push({frame:a,propLists:b}),this._oPreprocessed=null,this._bPreprocessed=!1,this._nCurIdx=null,this;var c,d=a,e=b,f={},g=null;for(var h in e)if(e.hasOwnProperty(h)){g=g||(isNaN(h)?1:2);var i=e[h];for(var j in i)i.hasOwnProperty(j)&&(a=1===g?j:h,c=1===g?h:j,f[a]=f[a]||{},f[a][c]=i[j])}for(var k in f)f.hasOwnProperty(k)&&(a=1*k,this.set(a,[d,f[k]]));return this},_oProperPrefix:{},_getProperPrefix:function(a){var b=this._oProperPrefix;if(a in b)return b[a];for(var c,d,e=document.body.style,f=["webkit","","Moz","O","ms"],g=function(a){return a.toUpperCase()},h=0,i=f.length;i>h;h++)if(c=f[h],d=c+(c?a.replace(/^[a-z]/,g):a),d in e)return b[a]=c;return b[a]=""},_getCSSKey:function(a){var b=this,c="",d=a.replace(/^(\-(webkit|o|moz|ms)\-)?([a-z]+)/,function(a,d,e,f){return c=e||b._getProperPrefix(f),c&&(f=f.replace(/^[a-z]/,function(a){return a.toUpperCase()})),f}).replace(/\-(\w)/g,function(a,b){return b.toUpperCase()});return({o:"O",moz:"Moz",webkit:"Webkit"}[c]||c)+d},_getCSSVal:function(a){var b=this,c=a.replace(/(^|\s)(\-(webkit|moz|o|ms)\-)?([a-z]+)/g,function(a,c,d,e,f){return e=e||b._getProperPrefix(f),c+(e&&"-"+e+"-")+f});return c},_parseTransformText:function(a){a=a||"";var b={};return a.replace(/([\w\-]+)\(([^\)]*)\)/g,function(a,c,d){var e=d.split(/\s*,\s*/);switch(c){case"translate3d":case"scale3d":case"skew3d":c=c.replace(/3d$/,""),b[c+"Z"]=e[2];case"translate":case"scale":case"skew":b[c+"X"]=e[0],"undefined"==typeof e[1]?"scale"===c&&(b[c+"Y"]=e[0]):b[c+"Y"]=e[1];break;default:b[c]=e.join(",")}}),b},_getTransformFunction:function(a){var b,c=a.start,d=a.end,e=this._parseTransformText(c),f=this._parseTransformText(d),g={};for(b in e)e.hasOwnProperty(b)&&(g[b]=[e[b],f[b]||(/^scale/.test(b)?1:0)]);for(b in f)!f.hasOwnProperty(b)||b in e||(g[b]=[e[b]||(/^scale/.test(b)?1:0),f[b]]);var h=function(b){var c=[],d=[a.start,a.end];for(var e in g)g.hasOwnProperty(e)&&(a.start=g[e][0],a.end=g[e][1],c.push(e+"("+a(b)+")"));return a.start=d[0],a.end=d[1],c.join(" ")};return h.start=c,h.end=d,h}}).extend(jindo.Component),jindo.LayerEffect=jindo.$Class({$init:function(a){this.setLayer(a);var b=this;this._htTransitionGetterSetter={getter:function(a){return jindo.$Element(b._el)[a]()},setter:function(a,c){jindo.$Element(b._el)[a](parseFloat(c))}}},getLayer:function(){return this._el},setLayer:function(a){this._el=jindo.$(a),this._wel=jindo.$Element(a);var b=this._el.cloneNode(!0),c=jindo.$Element(b);c.opacity(0),this._wel.after(c),c.show(),this._sLayerCSSPosition=c.css("position");var d=c.offset();c.css({position:"absolute",top:"0px",left:"0px"});var e=c.offset();return this._sLayerCSSLeft=d.left-e.left+"px",this._sLayerCSSTop=d.top-e.top+"px",this._sLayerBGColor=c.css("backgroundColor"),this._nLayerWidth=c.width(),this._nLayerHeight=c.height(),c.width(this._nLayerWidth),c.height(this._nLayerHeight),this._sLayerCSSWidth=c.css("width"),this._sLayerCSSHeight=c.css("height"),this._sLayerCSSOverflowX=this._wel.css("overflowX"),this._sLayerCSSOverflowY=this._wel.css("overflowY"),this._sLayerCSSFontSize=this._wel.css("fontSize"),this._sLayerCSSFontSizeUnit=this._sLayerCSSFontSize.match(/^\-?[0-9\.]+(%|px|pt|em)?$/i)[1],c.css({overflow:"hidden",width:0,height:0}),this._nSlideMinWidth=c.width()+1,this._nSlideMinHeight=c.height()+1,c.leave(),this},_transform:function(){this._wel.css({overflowX:"hidden",overflowY:"hidden"})},_restore:function(){this._wel.css({position:this._sLayerCSSPosition,overflowX:this._sLayerCSSOverflowX,overflowY:this._sLayerCSSOverflowY})},_fireEventBefore:function(a){return a&&this._transform(),this.fireEvent("before",{elLayer:this.getLayer()})},_fireEventAppear:function(){this.fireEvent("appear",{elLayer:this.getLayer()})},_fireEventEnd:function(){this._restore(),this.fireEvent("end",{elLayer:this.getLayer()})},_getTransition:function(){return this._oTransition?this._oTransition:this._oTransition=new jindo.Transition({bCorrection:!0})},_afterHide:function(){this._wel.hide().opacity(1),this._wel.css({top:this._sLayerCSSTop,left:this._sLayerCSSLeft,width:this._sLayerCSSWidth,height:this._sLayerCSSHeight,fontSize:this._sLayerCSSFontSize})},_onShowTransitionEnd:function(){this._getTransition().detach("end",arguments.callee),this._fireEventEnd()},_onHideTransitionEnd:function(){this._getTransition().detach("end",arguments.callee),this._afterHide(),this._fireEventEnd()},_getOption:function(a,b){for(var c in b)a[c]=b[c];return a},fadeIn:function(a){a=this._getOption({nFPS:30,nDuration:500},a||{});var b=this._wel.visible()&&this._wel.opacity()>0;if(b?a.nDuration*=(1-this._wel.opacity())/1:(this._wel.opacity(0),this._wel.show()),a.nDuration>0){this._fireEventBefore(!0);var c=this,d=this._getTransition().fps(a.nFPS).abort().detachAll();d.attach({playing:function(a){1===a.nStep&&(this.detach("playing",arguments.callee),b||c._fireEventAppear())},end:jindo.$Fn(this._onShowTransitionEnd,this).bind(this)}).queue(a.nDuration,this._wel.$value(),{"@opacity":jindo.Effect.linear(1)}),a.fCallback&&d.queue(jindo.$Fn(a.fCallback,this).bind(this)),d.start()}return this},fadeOut:function(a){a=this._getOption({nFPS:30,nDuration:500},a||{});var b=this._wel.visible()&&this._wel.opacity()>0;if(b){this._fireEventBefore(),a.nDuration*=this._wel.opacity()/1;var c=this._getTransition().fps(a.nFPS).abort().detachAll();c.attach({end:jindo.$Fn(this._onHideTransitionEnd,this).bind(this)}).queue(a.nDuration,this._wel.$value(),{"@opacity":jindo.Effect.linear(0)}),a.fCallback&&c.queue(jindo.$Fn(a.fCallback,this).bind(this)),c.start()}return this},slideDown:function(a){a=this._getOption({nFPS:30,nDuration:500},a||{});var b=this._wel.visible();if(Math.ceil(this._wel.height())<this._nLayerHeight&&this._fireEventBefore(!0)){b?a.nDuration=Math.ceil(a.nDuration*((this._nLayerHeight-this._wel.height())/(this._nLayerHeight-this._nSlideMinHeight))):this._wel.css("height",0).show().height(this._nSlideMinHeight);var c=this,d=this._getTransition().fps(a.nFPS).abort().detachAll();d.attach({playing:function(a){1===a.nStep&&(this.detach("playing",arguments.callee),b||c._fireEventAppear())},end:jindo.$Fn(this._onShowTransitionEnd,this).bind(this)}).queue(a.nDuration,this._htTransitionGetterSetter,{height:jindo.Effect.cubicEaseOut(this._nLayerHeight)}),a.fCallback&&d.queue(jindo.$Fn(a.fCallback,this).bind(this)),d.start()}return this},slideUp:function(a){a=this._getOption({nFPS:30,nDuration:500},a||{});var b=this._wel.visible();if(b&&this._fireEventBefore(!0)){a.nDuration=Math.ceil(a.nDuration*(this._wel.height()/this._nLayerHeight));var c=this._getTransition().fps(a.nFPS).abort().detachAll();c.attach({end:jindo.$Fn(this._onHideTransitionEnd,this).bind(this)}).queue(a.nDuration,this._htTransitionGetterSetter,{height:jindo.Effect.cubicEaseOut(this._nSlideMinHeight)}),a.fCallback&&c.queue(jindo.$Fn(a.fCallback,this).bind(this)),c.start()}return this},grow:function(a){a=this._getOption({nFPS:30,nDuration:500},a||{});var b=this._wel.visible();if(Math.ceil(this._wel.height())<this._nLayerHeight&&this._fireEventBefore(!0)){b?a.nDuration=Math.ceil(a.nDuration*((this._nLayerHeight-this._wel.height())/(this._nLayerHeight-this._nSlideMinHeight))):this._wel.css({width:0,height:0}).show().width(this._nSlideMinWidth).height(this._nSlideMinHeight);var c=this,d=this._getTransition().fps(a.nFPS).abort().detachAll();d.attach({playing:function(a){1===a.nStep&&(this.detach("playing",arguments.callee),b||c._fireEventAppear())},end:jindo.$Fn(this._onShowTransitionEnd,this).bind(this)}).queue(a.nDuration,this._htTransitionGetterSetter,{width:jindo.Effect.cubicEaseOut(this._nLayerWidth),height:jindo.Effect.cubicEaseOut(this._nLayerHeight)}),a.fCallback&&d.queue(jindo.$Fn(a.fCallback,this).bind(this)),d.start()}return this},shrink:function(a){a=this._getOption({nFPS:30,nDuration:500},a||{});var b=this._wel.visible();if(b&&this._fireEventBefore(!0)){a.nDuration=Math.ceil(a.nDuration*(this._wel.height()/this._nLayerHeight));var c=this._getTransition().fps(a.nFPS).abort().detachAll();c.attach({end:jindo.$Fn(this._onHideTransitionEnd,this).bind(this)}).queue(a.nDuration,this._htTransitionGetterSetter,{width:jindo.Effect.cubicEaseOut(this._nSlideMinWidth),height:jindo.Effect.cubicEaseOut(this._nSlideMinHeight)}),a.fCallback&&c.queue(jindo.$Fn(a.fCallback,this).bind(this)),c.start()}return this},unfold:function(a){a=this._getOption({nFPS:30,nDuration:500,nWidth:this._nSlideMinWidth,nHeight:this._nSlideMinHeight},a||{});var b,c,d=this._wel.visible();if(d?(b=a.nDuration/2*(this._nLayerWidth-this._wel.width())/this._nLayerWidth,c=a.nDuration/2*(this._nLayerHeight-this._wel.height())/this._nLayerHeight):(this._wel.css({width:0,height:0}).show().width(Math.max(a.nWidth,this._nSlideMinWidth)).height(Math.max(a.nHeight,this._nSlideMinHeight)),b=a.nDuration/2,c=b),c>0){var e=this;if(this._fireEventBefore(!0)){var f=this._getTransition().fps(a.nFPS).abort().detachAll();f.attach({playing:function(a){1===a.nStep&&(this.detach("playing",arguments.callee),d||e._fireEventAppear())},end:jindo.$Fn(this._onShowTransitionEnd,this).bind(this)}).queue(b,this._htTransitionGetterSetter,{width:jindo.Effect.cubicEaseOut(this._nLayerWidth)}).queue(c,this._htTransitionGetterSetter,{height:jindo.Effect.cubicEaseOut(this._nLayerHeight)}),a.fCallback&&f.queue(jindo.$Fn(a.fCallback,this).bind(this)),f.start()}}return this},fold:function(a){a=this._getOption({nFPS:30,nDuration:500,nWidth:this._nSlideMinWidth,nHeight:this._nSlideMinHeight},a||{});var b,c,d=this._wel.visible();if(d&&(c=a.nDuration/2*this._wel.height()/this._nLayerHeight,b=a.nDuration/2*this._wel.width()/this._nLayerWidth,b>0&&this._fireEventBefore(!0))){var e=this._getTransition().fps(a.nFPS).abort().detachAll();e.attach({end:jindo.$Fn(this._onHideTransitionEnd,this).bind(this)}).queue(c,this._htTransitionGetterSetter,{height:jindo.Effect.cubicEaseOut(Math.max(a.nHeight,this._nSlideMinHeight))}).queue(b,this._htTransitionGetterSetter,{width:jindo.Effect.cubicEaseOut(Math.max(a.nWidth,this._nSlideMinWidth))}),a.fCallback&&e.queue(jindo.$Fn(a.fCallback,this).bind(this)),e.start()}return this},pullUp:function(a){a=this._getOption({nFPS:30,nDuration:500},a||{});var b=this._wel.visible();if(Math.ceil(this._wel.height())<this._nLayerHeight&&this._fireEventBefore(!0)){this._wel.css("position","absolute"),b?a.nDuration=Math.ceil(a.nDuration*((this._nLayerHeight-this._wel.height())/(this._nLayerHeight-this._nSlideMinHeight))):this._wel.css({height:0,top:parseInt(this._sLayerCSSTop,10)+this._nLayerHeight-this._nSlideMinHeight+"px"}).show().height(this._nSlideMinHeight);var c=this,d=this._getTransition().fps(a.nFPS).abort().detachAll();d.attach({playing:function(a){1===a.nStep&&(this.detach("playing",arguments.callee),b||c._fireEventAppear())},end:jindo.$Fn(this._onShowTransitionEnd,this).bind(this)}).attach({playing:function(){c._wel.css("top",parseInt(c._sLayerCSSTop,10)+c._nLayerHeight-c._wel.height()+"px")}}).queue(a.nDuration,this._htTransitionGetterSetter,{height:jindo.Effect.cubicEaseOut(this._nLayerHeight)}),a.fCallback&&d.queue(jindo.$Fn(a.fCallback,this).bind(this)),d.start()}return this},pushDown:function(a){a=this._getOption({nFPS:30,nDuration:500},a||{});var b=this._wel.visible();if(b&&this._fireEventBefore(!0)){this._wel.css("position","absolute"),a.nDuration=Math.ceil(a.nDuration*(this._wel.height()/this._nLayerHeight));var c=this,d=this._getTransition().fps(a.nFPS).abort().detachAll();d.attach({playing:function(){c._wel.css("top",parseInt(c._sLayerCSSTop,10)+c._nLayerHeight-c._wel.height()+"px")},end:jindo.$Fn(this._onHideTransitionEnd,this).bind(this)}).queue(a.nDuration,this._htTransitionGetterSetter,{height:jindo.Effect.cubicEaseOut(this._nSlideMinHeight)}),a.fCallback&&d.queue(jindo.$Fn(a.fCallback,this).bind(this)),d.start()}return this},condense:function(a){a=this._getOption({nFPS:30,nDuration:500,nScale:2},a||{});var b=this._wel.visible()&&this._wel.opacity()>0;if(b?a.nDuration*=(1-this._wel.opacity())/1:(this._wel.opacity(0),this._wel.show(),this._wel.css({left:parseInt(this._sLayerCSSLeft,10)-this._nLayerWidth/2+"px",top:parseInt(this._sLayerCSSTop,10)-this._nLayerHeight/2+"px",width:parseInt(this._sLayerCSSWidth,10)*a.nScale+"px",height:parseInt(this._sLayerCSSHeight,10)*a.nScale+"px",fontSize:parseInt(this._sLayerCSSFontSize,10)*a.nScale+this._sLayerCSSFontSizeUnit})),a.nDuration>0&&this._fireEventBefore(!0)){this._wel.css("position","absolute");var c=this,d=c.getLayer(),e=this._getTransition().fps(a.nFPS).abort().detachAll();e.attach({playing:function(a){1===a.nStep&&(this.detach("playing",arguments.callee),b||c._fireEventAppear())},end:jindo.$Fn(this._onShowTransitionEnd,this).bind(this)}).queue(a.nDuration,this._htTransitionGetterSetter,{width:jindo.Effect.cubicEaseOut(this._nLayerWidth),height:jindo.Effect.cubicEaseOut(this._nLayerHeight)},d,{"@left":jindo.Effect.cubicEaseOut(this._sLayerCSSLeft),"@top":jindo.Effect.cubicEaseOut(this._sLayerCSSTop),"@fontSize":jindo.Effect.cubicEaseOut(this._sLayerCSSFontSize),"@opacity":jindo.Effect.linear(1)}),a.fCallback&&e.queue(jindo.$Fn(a.fCallback,this).bind(this)),e.start()}return this},expand:function(a){if(a=this._getOption({nFPS:30,nDuration:500,nScale:2},a||{}),this._wel.visible()&&this._wel.opacity()>0&&this._fireEventBefore(!0)){a.nDuration*=this._wel.opacity()/1,this._wel.css("position","absolute"),"auto"==this._wel.css("left")&&this._wel.css("left",this._sLayerCSSLeft),"auto"==this._wel.css("top")&&this._wel.css("top",this._sLayerCSSTop);var b=this._getTransition().fps(a.nFPS).abort().detachAll();b.attach({end:jindo.$Fn(this._onHideTransitionEnd,this).bind(this)}).queue(a.nDuration,this._htTransitionGetterSetter,{width:jindo.Effect.cubicEaseOut(this._nLayerWidth*a.nScale),height:jindo.Effect.cubicEaseOut(this._nLayerHeight*a.nScale)},this.getLayer(),{"@left":jindo.Effect.cubicEaseOut(parseInt(this._sLayerCSSLeft,10)-parseInt(this._sLayerCSSWidth,10)/2+"px"),"@top":jindo.Effect.cubicEaseOut(parseInt(this._sLayerCSSTop,10)-parseInt(this._sLayerCSSHeight,10)/2+"px"),"@fontSize":jindo.Effect.cubicEaseOut(parseInt(this._sLayerCSSFontSize,10)+this._sLayerCSSFontSizeUnit,2*parseInt(this._sLayerCSSFontSize,10)+this._sLayerCSSFontSizeUnit),"@opacity":jindo.Effect.linear(0)}),a.fCallback&&b.queue(jindo.$Fn(a.fCallback,this).bind(this)),b.start()}return this},shake:function(a){if(a=this._getOption({nFPS:30,nDuration:500,nWidth:20,nCount:3},a||{}),this._wel.visible()&&this._fireEventBefore()){this._wel.css("position","absolute");var b=this,c=this._getTransition().fps(a.nFPS).abort().detachAll();c.attach({end:jindo.$Fn(this._onShowTransitionEnd,this).bind(this),abort:function(){b._wel.css("left",this._sLayerCSSLeft)}}).queue(a.nDuration,this.getLayer(),{"@left":jindo.Effect.wave(a.nCount)(this._sLayerCSSLeft,a.nWidth+"px")}),a.fCallback&&c.queue(jindo.$Fn(a.fCallback,this).bind(this)),c.start()}return this},blink:function(a){if(a=this._getOption({nFPS:30,nDuration:500,nOpacity:0,nCount:1},a||{}),this._wel.visible()&&this._fireEventBefore()){var b=this,c=this._getTransition().fps(a.nFPS).abort().detachAll();c.attach({end:jindo.$Fn(this._onShowTransitionEnd,this).bind(this),abort:function(){b._wel.opacity(1)}}).queue(a.nDuration,this.getLayer(),{"@opacity":jindo.Effect.wave(a.nCount)(1,a.nOpacity)}),a.fCallback&&c.queue(jindo.$Fn(a.fCallback,this).bind(this)),c.start()}return this},flicker:function(a){a=this._getOption({nFPS:30,nDuration:500,sBackgroundColor:"#ffff00"},a||{});var b="transparent"==this._sLayerBGColor||"rgba(0, 0, 0, 0)"==this._sLayerBGColor?"#ffffff":this._sLayerBGColor;if(this._wel.visible()&&this._fireEventBefore()){var c=this,d=this._getTransition().fps(a.nFPS).abort().detachAll();d.attach({end:jindo.$Fn(this._onShowTransitionEnd,this).bind(this),abort:function(){c._wel.css("backgroundColor",c._sLayerBGColor)}}).queue(a.nDuration,this.getLayer(),{"@backgroundColor":jindo.Effect.cubicEaseIn(a.sBackgroundColor,b)}).queue(function(){c._wel.css("backgroundColor",c._sLayerBGColor)}),a.fCallback&&d.queue(jindo.$Fn(a.fCallback,this).bind(this)),d.start()}return this},bounce:function(a){if(a=this._getOption({nFPS:30,nDuration:500,nHeight:50},a||{}),this._wel.visible()&&this._fireEventBefore()){this._wel.css("position","absolute");var b=this,c=this._getTransition().fps(a.nFPS).abort().detachAll();c.attach({end:jindo.$Fn(this._onShowTransitionEnd,this).bind(this),abort:function(){b._wel.css("top",b._sLayerCSSTop)}}).queue(a.nDuration/5,this.getLayer(),{"@top":jindo.Effect.easeOut(this._sLayerCSSTop,parseInt(this._sLayerCSSTop,10)-a.nHeight+"px")}).queue(a.nDuration/5*4,this.getLayer(),{"@top":jindo.Effect.bounce(this._sLayerCSSTop)}),a.fCallback&&c.queue(jindo.$Fn(a.fCallback,this).bind(this)),c.start()}return this}}).extend(jindo.Component),jindo.LayerManager=jindo.$Class({_bIsActivating:!1,_bIsHiding:!1,_bIsShowing:!1,_aLink:null,$init:function(a,b){this.option({sCheckEvent:"click",nCheckDelay:100,nShowDelay:0,nHideDelay:100}),this.option(b||{}),this.setLayer(a),this._aLink=[],this._oShowTimer=new jindo.Timer,this._oHideTimer=new jindo.Timer,this._oEventTimer=new jindo.Timer,this._wfOnEvent=jindo.$Fn(this._onEvent,this),this.getVisible(),this.activate()},_onActivate:function(){this._wfOnEvent.attach(document,this.option("sCheckEvent"))},_onDeactivate:function(){this._wfOnEvent.detach(document,this.option("sCheckEvent"))},getVisible:function(){return this._wel.visible()},_check:function(a){for(var b,c,d=jindo.$Element(a),e=0;b=this._aLink[e];e++)if(c=jindo.$Element(b),c&&(b=c.$value(),b&&d&&(a==b||d.isChildOf(b))))return!0;return!1},_find:function(a){for(var b,c=0;b=this._aLink[c];c++)if(b==a)return c;return-1},getLayer:function(){return this._el},setLayer:function(a){return this._el=jindo.$(a),this._wel=jindo.$Element(a),this},getLinks:function(){return this._aLink},setLinks:function(a){return this._aLink=jindo.$A(a).unique().$value(),this},link:function(a){if(arguments.length>1){for(var b=0,c=arguments.length;c>b;b++)this.link(arguments[b]);return this}return-1!=this._find(a)?this:(this._aLink.push(a),this)},unlink:function(a){if(arguments.length>1){for(var b=0,c=arguments.length;c>b;b++)this.unlink(arguments[b]);return this}var d=this._find(a);return d>-1&&this._aLink.splice(d,1),this},_fireEventBeforeShow:function(){return this.fireEvent("beforeShow",{elLayer:this.getLayer(),aLinkedElement:this.getLinks()})},_fireEventShow:function(){this._bIsShowing=!1,this.fireEvent("show",{elLayer:this.getLayer(),aLinkedElement:this.getLinks()})},_fireEventBeforeHide:function(){var a=this.fireEvent("beforeHide",{elLayer:this.getLayer(),aLinkedElement:this.getLinks()});return a||(this._bIsHiding=!1),a},_fireEventHide:function(){this._bIsHiding=!1,this.fireEvent("hide",{elLayer:this.getLayer(),aLinkedElement:this.getLinks()})},_show:function(a,b){var c=this;this._oEventTimer.abort(),this._bIsShowing=!0,this._bIsHiding=!1,0>=b&&c._oHideTimer.abort(),this._oShowTimer.start(function(){a()},b)},_hide:function(a,b){var c=this;this._bIsShowing=!1,this._bIsHiding=!0,0>=b&&c._oShowTimer.abort(),this._oHideTimer.start(function(){a()},b)},show:function(a){"undefined"==typeof a&&(a=this.option("nShowDelay"));var b=this;return this._show(function(){b.getVisible()||b._fireEventBeforeShow()&&(b._wel.show(),b._fireEventShow())},a),this},hide:function(a){"undefined"==typeof a&&(a=this.option("nHideDelay"));var b=this;return this._hide(function(){b.getVisible()&&b._fireEventBeforeHide()&&(b._wel.hide(),b._fireEventHide())},a),this},toggle:function(a){return!this.getVisible()||this._bIsHiding?this.show(a||this.option("nShowDelay")):this.hide(a||this.option("nHideDelay")),this},_onEvent:function(a){var b=a.element,c=this;this._oEventTimer.start(function(){!c._bIsHiding&&c.getVisible()&&(c._check(b)?c._bIsShowing||(c.fireEvent("ignore",{sCheckEvent:c.option("sCheckEvent")}),c._oHideTimer.abort(),c._bIsHiding=!1):"undefined"!=typeof b.tagName&&"OPTION"!==b.tagName&&c.hide())},this.option("nCheckDelay"))}}).extend(jindo.UIComponent),jindo.DatePicker=jindo.$Class({_aDatePickerSet:null,_htSelectedDatePickerSet:null,$init:function(a,b){var c=new Date;this.option({bUseLayerPosition:!0,Calendar:{sClassPrefix:"calendar-",nYear:c.getFullYear(),nMonth:c.getMonth()+1,nDate:c.getDate(),sTitleFormat:"yyyy-mm",aMonthTitle:["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"]},LayerManager:{sCheckEvent:"click",nShowDelay:0,nHideDelay:0},LayerPosition:{sPosition:"outside-bottom",sAlign:"left",nTop:0,nLeft:0,bAuto:!1}}),this.option(b),this._aDatePickerSet=[],this._elCalendarLayer=jindo.$(a),this._initCalendar(),this._initLayerManager(),this._initLayerPosition(),this._wfFocusInput=jindo.$Fn(this._onFocusInput,this),this._wfClickLinkedElement=jindo.$Fn(this._onClickLinkedElement,this),this._wfMouseOverDate=jindo.$Fn(this._onMouseOverDate,this),this._wfMouseOutDate=jindo.$Fn(this._onMouseOutDate,this),this._wfClickDate=jindo.$Fn(this._onClickDate,this);var d=jindo.$Element(this._elCalendarLayer);isNaN(1*d.css("zIndex"))&&d.css("zIndex",1),this.activate()},addDatePickerSet:function(a){var b=(this.option(),this.getCalendar().option()),c={nYear:b.nYear,nMonth:b.nMonth,nDate:b.nDate,bDefaultSet:!0,bReadOnly:!0,sDateFormat:"yyyy-mm-dd",htSelectableDateFrom:{nYear:1900,nMonth:1,nDate:1},htSelectableDateTo:{nYear:2100,nMonth:12,nDate:31}};if("undefined"!=typeof a.htOption)for(var d in a.htOption)"undefined"!=typeof c[d]&&(c[d]=a.htOption[d]);a.htOption=c,this._aDatePickerSet.push(a);var e=this.getLayerManager();return"undefined"!=typeof a.elInput&&(e.link(a.elInput),a.htOption.bReadOnly&&(a.elInput.readOnly=!0),this._wfFocusInput.attach(a.elInput,"focus"),this._wfClickLinkedElement.attach(a.elInput,"click")),"undefined"!=typeof a.elButton&&(e.link(a.elButton),this._wfClickLinkedElement.attach(a.elButton,"click")),a.htOption.bDefaultSet&&this._setDate(a,a.htOption),this},removeDatePickerSet:function(a){for(var b=-1,c=0,d=this._aDatePickerSet.length;d>c;c++)if(this._aDatePickerSet[c].elInput==a.elInput||this._aDatePickerSet[c].elButton==a.elButton){b=c;break}var e=this._aDatePickerSet[b],f=this.getLayerManager();return"undefined"!=typeof e.elButton&&(f.unlink(e.elButton),this._wfClickLinkedElement.detach(e.elButton,"click")),"undefined"!=typeof e.elInput&&(this._wfFocusInput.detach(e.elInput,"focus"),this._wfClickLinkedElement.detach(e.elInput,"click"),e.elInput.readOnly=!1),e==this._htSelectedDatePickerSet&&(this._htSelectedDatePickerSet=null),this._aDatePickerSet.splice(c,1),this},getDatePickerSet:function(a){if("undefined"==typeof a)return this._aDatePickerSet;for(var b=0,c=this._aDatePickerSet.length;c>b;b++)if(this._aDatePickerSet[b].elInput==a||this._aDatePickerSet[b].elButton==a)return this._aDatePickerSet[b];return!1},getCalendarLayer:function(){return this._elCalendarLayer},_initCalendar:function(){var a=this;this._oCalendar=new jindo.Calendar(this.getCalendarLayer(),this.option("Calendar")).attach({beforeDraw:function(b){a.fireEvent("beforeDraw",b)||b.stop()},draw:function(b){var c=this.option("sClassPrefix"),d=a._htSelectedDatePickerSet;a.isSelectable(d,b)?(b.bSelectable=!0,jindo.Calendar.isSameDate(b,d)&&jindo.$Element(b.elDateContainer).addClass(c+"selected")):(b.bSelectable=!1,jindo.$Element(b.elDateContainer).addClass(this.option("sClassPrefix")+"unselectable")),a.fireEvent("draw",b)||b.stop()},afterDraw:function(b){a.fireEvent("afterDraw",b)}})},getCalendar:function(){return this._oCalendar},_initLayerManager:function(){var a=this,b=this.getCalendarLayer();this._oLayerManager=new jindo.LayerManager(b,this.option("LayerManager")).attach({show:function(){a._oTimerDatePickerSet&&(clearTimeout(a._oTimerDatePickerSet),a._oTimerDatePickerSet=null),a.fireEvent("showCalendar")},hide:function(){a._oTimerDatePickerSet=setTimeout(function(){a._htSelectedDatePickerSet=null,a._oTimerDatePickerSet=null},0),a.fireEvent("hideCalendar")}}).link(b)},getLayerManager:function(){return this._oLayerManager},_initLayerPosition:function(){this.option("bUseLayerPosition")&&(this._oLayerPosition=new jindo.LayerPosition(null,this.getCalendarLayer(),this.option("LayerPosition")))},getLayerPosition:function(){return this._oLayerPosition},getInput:function(a){return"undefined"!=typeof a?a.elInput||null:this._htSelectedDatePickerSet?this._htSelectedDatePickerSet.elInput||null:null},getDate:function(a){return{nYear:a.nYear,nMonth:a.nMonth,nDate:a.nDate}},_setDate:function(a,b){a.nYear=1*b.nYear,a.nMonth=1*b.nMonth,a.nDate=1*b.nDate,"undefined"!=typeof a.elInput&&(a.elInput.value=this._getDateFormat(a,b))},isSelectable:function(a,b){return jindo.Calendar.isBetween(b,a.htOption.htSelectableDateFrom,a.htOption.htSelectableDateTo)
},setDate:function(a,b){if(this.isSelectable(a,b)){var c=this._getDateFormat(a,b),d={sText:c,nYear:b.nYear,nMonth:b.nMonth,nDate:b.nDate};return this.fireEvent("beforeSelect",d)&&(this._setDate(a,b),this.getLayerManager().hide(),this.fireEvent("select",d)),!0}return!1},_getDateFormat:function(a,b){var c=b.nYear,d=b.nMonth,e=b.nDate;10>d&&(d=("0"+1*d).toString()),10>e&&(e=("0"+1*e).toString());var f=a.htOption.sDateFormat;return f=f.replace(/yyyy/g,c).replace(/y/g,c.toString().substr(2,2)).replace(/mm/g,d).replace(/m/g,1*d).replace(/M/g,this.getCalendar().option("aMonthTitle")[d-1]).replace(/dd/g,e).replace(/d/g,1*e)},_linkOnly:function(a){var b=this.getLayerManager();b.setLinks([this.getCalendarLayer()]),"undefined"!=typeof a.elInput&&b.link(a.elInput),"undefined"!=typeof a.elButton&&b.link(a.elButton)},_onActivate:function(){var a=this.getCalendarLayer();jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(a).preventTapHighlight(!0),this._wfMouseOverDate.attach(a,"mouseover"),this._wfMouseOutDate.attach(a,"mouseout"),this._wfClickDate.attach(a,"click"),this.getLayerManager().activate(),this.getCalendar().activate()},_onDeactivate:function(){var a=this.getCalendarLayer();jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(a).preventTapHighlight(!1),this._wfMouseOverDate.detach(a,"mouseover"),this._wfMouseOutDate.detach(a,"mouseout"),this._wfClickDate.detach(a,"click").detach(a,"mouseover").detach(a,"mouseout"),this.getLayerManager().deactivate(),this.getCalendar().deactivate()},_onFocusInput:function(a){this.fireEvent("focus",{element:a.element})},_onClickLinkedElement:function(a){if(a.stop(jindo.$Event.CANCEL_DEFAULT),this.fireEvent("click",{element:a.element})){var b=this.getDatePickerSet(a.currentElement);if(b){this._htSelectedDatePickerSet=b,this._linkOnly(b),b.nYear||(b.nYear=b.htOption.nYear),b.nMonth||(b.nMonth=b.htOption.nMonth),b.nDate||(b.nDate=b.htOption.nDate);var c=b.nYear,d=b.nMonth;this.getLayerManager().show(),this.getCalendar().draw(c,d),this.option("bUseLayerPosition")&&("undefined"!=typeof b.elLayerPosition?this.getLayerPosition().setElement(b.elLayerPosition).setPosition():this.getLayerPosition().setElement(b.elInput).setPosition())}}},_getTargetDateElement:function(a){var b=this.getCalendar().option("sClassPrefix"),c=jindo.$Element(a).hasClass(b+"date")?a:jindo.$$.getSingle("."+b+"date",a);return!c||c!=a&&1!=c.length?null:c},_getTargetDateContainerElement:function(a){var b=this.getCalendar().option("sClassPrefix"),c=jindo.$$.getSingle("! ."+b+"week",a);if(c){for(var d=a;!jindo.$Element(d.parentNode).hasClass(b+"week");)d=d.parentNode;return jindo.$Element(d).hasClass(b+"unselectable")?null:d}return null},_setSelectedAgain:function(){if(this._elSelected){var a=this.getCalendar().option("sClassPrefix");jindo.$Element(this._elSelected).addClass(a+"selected"),this._elSelected=null}},_setAsideSelected:function(){if(!this._elSelected){var a=this.getCalendar().option("sClassPrefix");this._elSelected=jindo.$$.getSingle("."+a+"selected",this.elWeekAppendTarget),this._elSelected&&jindo.$Element(this._elSelected).removeClass(a+"selected")}},_onMouseOverDate:function(a){var b=this.getCalendar().option("sClassPrefix"),c=this._getTargetDateContainerElement(a.element);if(c){var d=this.getCalendar().getDateOfElement(c),e={element:a.element,nYear:d.nYear,nMonth:d.nMonth,nDate:d.nDate,bSelectable:!1};this._htSelectedDatePickerSet&&this.isSelectable(this._htSelectedDatePickerSet,d)&&(this._setAsideSelected(),jindo.$Element(c).addClass(b+"over"),e.bSelectable=!0),this.fireEvent("mouseover",e)}},_onMouseOutDate:function(a){var b=this.getCalendar().option("sClassPrefix"),c=this._getTargetDateContainerElement(a.element);if(c){var d=this.getCalendar().getDateOfElement(c),e={element:a.element,nYear:d.nYear,nMonth:d.nMonth,nDate:d.nDate,bSelectable:!1};this._htSelectedDatePickerSet&&this.isSelectable(this._htSelectedDatePickerSet,d)&&(jindo.$Element(c).removeClass(b+"over"),e.bSelectable=!0,this._setSelectedAgain()),this.fireEvent("mouseout",e)}else this._setSelectedAgain()},_onClickDate:function(a){a.stop(jindo.$Event.CANCEL_DEFAULT);var b=a.element,c=this._getTargetDateElement(b);if(c){var d=this._getTargetDateContainerElement(c);if(d){var e=this.getCalendar().getDateOfElement(d);this.isSelectable(this._htSelectedDatePickerSet,e)&&this.setDate(this._htSelectedDatePickerSet,e)}}}}).extend(jindo.UIComponent),jindo.LazyLoading={_waLoading:jindo.$A([]),_waLoaded:jindo.$A([]),_whtScript:jindo.$H({}),_whtCallback:jindo.$H({})},jindo.LazyLoading.load=function(a,b,c){if("function"!=typeof b&&(b=function(){}),a instanceof Array){for(var d=(arguments.callee,!0),e=a.length,f=e,g=0;e>g;g++)d&=this.load(a[g],function(){f--,0===f&&b()},c);return d}if(this._queueCallback(a,b),this._checkIsLoading(a))return!1;if(this._checkAlreadyLoaded(a))return this._doCallback(a),!0;this._waLoading.push(a);var h=this,i=document.getElementsByTagName("head")[0],j=document.createElement("script");return j.type="text/javascript",j.charset=c||"utf-8",j.src=a,this._whtScript.add(a,j),"onload"in j?j.onload=function(){h._waLoaded.push(a),h._waLoading=h._waLoading.refuse(a),h._doCallback(a)}:j.onreadystatechange=function(){("complete"==this.readyState||"loaded"==this.readyState)&&(h._waLoaded.push(a),h._waLoading=h._waLoading.refuse(a),h._doCallback(a),this.onreadystatechange=null)},i.appendChild(j),!0},jindo.LazyLoading._queueCallback=function(a,b){var c=this._whtCallback.$(a);c?c.push(b):this._whtCallback.$(a,[b])},jindo.LazyLoading._doCallback=function(a){for(var b=this._whtCallback.$(a).concat(),c=0;c<b.length;c++)this._whtCallback.$(a).splice(c,1),b[c]()},jindo.LazyLoading.abort=function(a){if(this._checkIsLoading(a)){var b=this.getScriptElement(a);return this._waLoading=this._waLoading.refuse(a),"onload"in b?b.onload=null:b.onreadystatechange=null,jindo.$Element(b).leave(),this._whtScript.remove(a),this._whtCallback.remove(a),!0}return!1},jindo.LazyLoading._checkAlreadyLoaded=function(a){return this._waLoaded.has(a)},jindo.LazyLoading._checkIsLoading=function(a){return this._waLoading.has(a)},jindo.LazyLoading.getLoaded=function(){return this._waLoaded.$value()},jindo.LazyLoading.getLoading=function(){return this._waLoading.$value()},jindo.LazyLoading.getScriptElement=function(a){return this._whtScript.$(a)||null},jindo.ModalDialog=jindo.$Class({$init:function(a){var b={Foggy:{nShowDuration:150,nShowOpacity:.8,nHideDuration:150,nHideOpacity:0,sEffect:"linear",nFPS:30}};this.option(b),this.option(a||{}),this._initFoggy()},_initFoggy:function(){var a=this;this._oFoggy=new jindo.Foggy(this.option("Foggy")).attach({show:function(){a.fireEvent("show",{elLayer:a._elLayer})},hide:function(){a.detachAll("close").detachAll("confirm").detachAll("cancel"),a._detachEvents(),a._welLayer.hide(),a._welLayer.leave(),a._bIsShown=!1,a.fireEvent("hide",{elLayer:a._elLayer})}}),this._oFoggy.getFog().className=this.option("sClassPrefix")+"fog"},getFoggy:function(){return this._oFoggy},show:function(a,b){if(!this.isShown()){this.attach(b),document.body.appendChild(this._elLayer),this._welLayer.html(this._template.process(a||{}));var c={elLayer:this._elLayer};this.fireEvent("beforeShow",c)&&(this._welLayer.show(),this._attachEvents(),this.getLayerPosition().setPosition(),this._bIsShown=!0,this._oFoggy.show(this._elLayer))}},hide:function(){this.fireEvent("beforeHide",{elLayer:this._elLayer})&&this._oFoggy.hide()}}).extend(jindo.Dialog),jindo.Morph=jindo.$Class({$init:function(a){this.option({fEffect:jindo.Effect.linear,bUseTransition:!0}).option(a);var b=document.body.style;this._bTransitionSupport="transition"in b||"webkitTransition"in b||"MozTransition"in b||"OTransition"in b||"msTransition"in b;var c=jindo.$Agent(),d=c.os(),e=c.navigator();this._bHasTransformRenderBug=d.ios&&5===parseInt(d.version,10)&&e.msafari,this._aQueue=[],this._aIngItem=null,this._oRAF=null,this._bPlaying=null,this._nPtr=0,this._nPausePassed=0,this._aRepeat=[],this._sTransitionEnd="webkitTransition"in b&&"webkitTransitionEnd"||"transition"in b&&"transitionend"||"MozTransition"in b&&"transitionend"||"OTransition"in b&&"oTransitionEnd"||"msTransition"in b&&"MSTransitionEnd"},pushAnimate:function(a,b){if(b&&!(b instanceof Array))throw Error("aLists should be a instance of Array");return b=[].concat(b),b.duration=a,this._aQueue.push(b),this},pushKeyframe:function(a,b){return this._aQueue.push({action:"keyframe",args:{duration:a,keyframe:b}}),this},pushWait:function(){for(var a=0,b=arguments.length;b>a;a++){var c=arguments[a];c instanceof this.constructor?this._aQueue.push(c):this.pushAnimate(c,[])}return this},pushCall:function(a){return this._aQueue.push(a),this},pushRepeatStart:function(a){"undefined"==typeof a&&(a=1);var b="L"+Math.round((new Date).getTime()*Math.random());return this._aRepeat.push(b),this._pushLabel(b,a),this},_pushLabel:function(a,b){return"undefined"==typeof b&&(b=1/0),this._aQueue.push({action:"label",args:{label:a,times:b,loops:0}}),this},pushRepeatEnd:function(){var a=this._aRepeat.pop();return this._aQueue.push({action:"goto",args:{label:a}}),this},_waitMorph:function(a){var b=this;if(!a.isPlaying())return!0;var c=function(){a.detach("end",c).detach("pause",c),b._flushQueue()};return a.attach("end",c).attach("pause",c),!1},_getLabelIndex:function(a){for(var b=null,c=0,d=this._aQueue.length;d>c;c++)if(b=this._aQueue[c],"label"===b.action&&b.args.label===a)return c;return-1},_getRepeatEndIndex:function(a,b){for(var c=null,d=b||0,e=this._aQueue.length;e>d;d++)if(c=this._aQueue[d],"goto"===c.action&&c.args.label===a)return d;return-1},_flushQueue:function(){var a,b,c,d,e,f=this;do{if(a=!1,b=this._aIngItem=this._aQueue[this._nPtr],!b)return this._bPlaying=!1,void(b||this.fireEvent("end"));if(this._nPtr++,b instanceof Function)b.call(this),a=!0;else if(b instanceof this.constructor)a=this._waitMorph(b);else if("number"!=typeof b)if("label"!==b.action)if("goto"!==b.action)if("keyframe"!==b.action){if(e=this._aCompiledItem,d=this._nPausePassed){for(var g=0,h=e.length;h>g;g++)e[g].sTimingFunc="";e.allCSS=!1}else e=this._aCompiledItem=this._compileItem(b);0!==e.length?(a=e.duration<0,a?this._processItem(1,!0):(this._playAnimate(d),this._nPausePassed=0)):setTimeout(function(){f._flushQueue()},e.duration)}else{if(c=b.args.keyframe,d=this._nPausePassed,e=this._aCompiledItem=b.args,a=e.duration<0){this._processKeyframe(1,c);continue}this._playKeyframe(d,c),this._nPausePassed=0}else this._goto(b.args.label),a=!0;else{if(++b.args.loops>b.args.times){var i=this._getRepeatEndIndex(b.args.label,this._nPtr);b.args.loops=0,i>-1&&this._goto(i+1)}a=!0}else setTimeout(function(){f._flushQueue()},b)}while(a)},_playKeyframe:function(a,b){var c=this;this._nStart=(new Date).getTime()-a;var d=this._aCompiledItem,e=d.duration;!function f(){c._oRAF=c._requestAnimationFrame(function(){var a=c._nStart;if(null!==c._oRAF){c._oRAF=null;var d=Math.min(1,Math.max(0,((new Date).getTime()-a)/e));b.frame(d),1>d?f():(c.fireEvent("timerEnd"),c._flushQueue())}})}()},_processKeyframe:function(a,b){b.preprocess().frame(a)},_playAnimate:function(a){var b=this;this._nStart=(new Date).getTime()-a,this._nIng=2,a||this._processItem(0,!0,3,!0);var c=this._aCompiledItem;c.allCSS?this._nIng--:this._animationLoop(!0),function(){var a=b._processItem(1,!0,1).transitionCache;if(!a||0===c.duration)return void(0===--b._nIng&&b._flushQueue());var d=a.length,e=d?a[0]:null,f=function(c){for(var d,e=[];d=a.pop();)d.css(b._getCSSKey("transitionDuration"),"0.0001ms"),e.push(d);a=null,(window.requestAnimationFrame||window.setTimeout)(function(){for(;d=e.pop();)d.css(b._getCSSKey("transitionDuration"),"0"),d.css(b._getCSSKey("transitionProperty"),"none");e=null},0),b.fireEvent("transitionEnd"),0!==--b._nIng||c||b._requestAnimationFrame(function(){b._flushQueue()})};if(!e)return void f();var g=e.$value(),h=function(a){g.removeEventListener(b._sTransitionEnd,b._fpOnTransitionEnd,!0),b._fpOnTransitionEnd=null,f(a===!0)};b._fpOnTransitionEnd=function(a){h(a)},g.addEventListener(b._sTransitionEnd,b._fpOnTransitionEnd,!0)}()},_animationLoop:function(a){var b=this;this._oRAF=this._requestAnimationFrame(function(){var c=b._nStart,d=b._aCompiledItem.duration;if(null!==b._oRAF){b._oRAF=null;var e=Math.min(1,Math.max(0,((new Date).getTime()-c)/d));b._processItem(e,a,2),1>e?b._animationLoop():(b.fireEvent("timerEnd"),0===--b._nIng&&b._flushQueue())}})},_processItem:function(a,b,c,d){var e={normalPropsToPause:[],transitionCache:[]},f=e.normalPropsToPause,g=e.transitionCache,h=this._aCompiledItem,i=h.duration;0===i?i=1:0>i&&(i=0);var j,k,l,m,n,o,p=this._bHasTransformRenderBug;if(c=c||3,this.fireEvent("beforeProgress",{nRate:a})){for(var q,r,s=[],t=0;r=h[t];t++){j=r.oObj,k=r.welObj,l=r.oProps;var u=r.sTimingFunc;u&&1&c&&(k&&k.$value().clientHeight,"@transition"in l||d||("@transitionProperty"in l||k.css(this._getCSSKey("transitionProperty"),"all"),"@transitionDuration"in l||k.css(this._getCSSKey("transitionDuration"),(i/1e3).toFixed(3)+"s"),"@transitionTimingFunction"in l||k.css(this._getCSSKey("transitionTimingFunction"),u)),g.push(k)),q={},s.push(j,q),d&&1===a&&"@transform"in l&&/AppleWebKit\/534\.30/.test(navigator.userAgent)&&(k.css(this._getCSSKey("transform"),""),j.clientHeight);for(var v in l)if(l.hasOwnProperty(v)){if(m=l[v],o=/^@(.*)$/.test(v)&&RegExp.$1,n=u&&o?1:2,!(c&n))continue;if("function"==typeof m)m=m(a);else if(!b)continue;o?(/transition/.test(v)&&(m=this._getCSSVal(m)),p&&"@transform"===v&&("@left"in l||"@top"in l)&&j.clientHeight,k.css(this._getCSSKey(o),m)):d?f.push([j,v,m]):j[v]=m,q[v]=m}}return this.fireEvent("progress",{aLists:s,nRate:a}),e}},_compileItem:function(a){var b=0==a.length,c=[];c.duration=a.duration;for(var d,e,f,g,h,i,j,k,l=this.option("fEffect"),m=0,n=a.length;n>m;m+=2){var o=null;d=a[m],e=jindo.$Element(d),f=a[m+1],i={};var p=!1;for(var q in f)if(f.hasOwnProperty(q)){var r,s;if(h=f[q],j=/^@(.*)$/.test(q),k=RegExp.$1,h instanceof Array?(g=h[0],h=h[1]):g=j?e.css(this._getCSSKey(k)):d[q],g=0===g?g:g||"",r="function"==typeof h?h.effectConstructor:l,s=this._getEffectCSS(r)||"",/^@transform$/.test(q)){if("function"==typeof h&&(h=h.end),i[q]=this._getTransformFunction(g,h,r,d),jindo.m){var t=jindo.m.getOsInfo();(/matrix/.test(g)||/matrix/.test(h))&&t.android&&parseFloat(t.version)<3&&(s="")}}else if("function"==typeof h)"setStart"in h&&h.setStart(g),i[q]=h;else try{i[q]=r(g,h)}catch(u){if(!/^unit error/.test(u.message))throw u;i[q]=h}var v=i[q];if("function"==typeof v&&v(0)===v(1)){delete i[q];continue}j?null===o?o=s:o!==s&&(o=""):s="",b=b||!s,p=!0}e.visible()||(o=null,b=!0),p&&c.push({oObj:d,welObj:e,oProps:i,sTimingFunc:o})}return c.allCSS=!b,c},play:function(){return this._bPlaying||(this._bPlaying=!0,this.fireEvent("play"),this._flushQueue()),this},reset:function(){return this._goto(0)},pause:function(a){if(!this._bPlaying)return this;this._cancelAnimationFrame(this._oRAF),this._oRAF=null;var b=this._aCompiledItem,c=b.duration;if("undefined"==typeof a){var d=(new Date).getTime()-this._nStart;a=d/c}a=Math.max(0,Math.min(1,a));var e=null;if(b.keyframe?this._processKeyframe(a,b.keyframe):e=this._processItem(a,!0,3,!0).normalPropsToPause,this._nPtr--,this._nPausePassed=Math.round(c*a),this._fpOnTransitionEnd&&this._fpOnTransitionEnd(!0),e)for(var f=0,g=e.length;g>f;f++){var h=e[f];h[0][h[1]]=h[2]}return this._bPlaying=!1,this.fireEvent("pause"),this},_goto:function(a){var b=a;if("number"==typeof a)a=a||0;else if(a=this._getLabelIndex(b),-1===a)throw"Label not found";return this._nPtr=a,this._nPausePassed=0,this},isPlaying:function(){return this._bPlaying||!1},clear:function(){return this._aQueue.length=0,this._aRepeat.length=0,this._nPtr=0,this._nPausePassed=0,this},_getPointer:function(){return this._nPtr},_getEffectCSS:function(a){var b=this.option("bUseTransition")&&this._bTransitionSupport;if(!b)return null;if(this._htEventHandler.progress&&this._htEventHandler.progress.length||this._htEventHandler.beforeProgress&&this._htEventHandler.beforeProgress.length)return null;if(a.hasOwnProperty("toString"))return a.toString();switch(a){case jindo.Effect.linear:return"linear";case jindo.Effect.cubicEase:return"ease";case jindo.Effect.cubicEaseIn:return"ease-in";case jindo.Effect.cubicEaseOut:return"ease-out";case jindo.Effect.cubicEaseInOut:return"ease-in-out";default:if(a.cubicBezier&&Math.max.apply(Math,a.cubicBezier)<=1&&Math.min.apply(Math,a.cubicBezier)>=0)return"cubic-bezier("+a.cubicBezier.join(",")+")"}return null},_requestAnimationFrame:function(a){var b,c=this,d=function(){b===c._oLastRAF&&(c._oLastRAF=null,a())};return b=window.requestAnimationFrame?requestAnimationFrame(d):setTimeout(d,1e3/60),this._oLastRAF=b},_cancelAnimationFrame:function(a){var b;return b=window.cancelAnimationFrame?cancelAnimationFrame(a):clearTimeout(a),this._oLastRAF=null,b},_oProperPrefix:{},_getProperPrefix:function(a){var b=this._oProperPrefix;if(a in b)return b[a];for(var c,d,e=document.body.style,f=["webkit","","Moz","O","ms"],g=function(a){return a.toUpperCase()},h=0,i=f.length;i>h;h++)if(c=f[h],d=c+(c?a.replace(/^[a-z]/,g):a),d in e)return b[a]=c;return b[a]=""},_getCSSKey:function(a){var b=this,c="",d=a.replace(/^(\-(webkit|o|moz|ms)\-)?([a-z]+)/,function(a,d,e,f){return c=e||b._getProperPrefix(f),c&&(f=f.replace(/^[a-z]/,function(a){return a.toUpperCase()})),f}).replace(/\-(\w)/g,function(a,b){return b.toUpperCase()});return({o:"O",moz:"Moz",webkit:"Webkit"}[c]||c)+d},_getCSSVal:function(a){var b=this,c=a.replace(/(^|\s)(\-(webkit|moz|o|ms)\-)?([a-z]+)/g,function(a,c,d,e,f){return e=e||b._getProperPrefix(f),c+(e&&"-"+e+"-")+f});return c},_getMatrixObj:function(a,b){a=a.replace(/\b(translate(3d)?)\(\s*([^,]+)\s*,\s*([^,\)]+)/g,function(a,c,d,e,f){return/%$/.test(e)&&(e=parseFloat(e)/100*b.offsetWidth+"px"),/%$/.test(f)&&(f=parseFloat(f)/100*b.offsetHeight+"px"),c+"("+e+","+f}).replace(/\b(translate([XY]))\(\s*([^\)]+)/g,function(a,c,d,e){return"X"===d&&/%$/.test(e)?e=parseFloat(e)/100*b.offsetWidth+"px":"Y"===d&&/%$/.test(e)&&(e=parseFloat(e)/100*b.offsetHeight+"px"),c+"("+e});var c,d=window.WebKitCSSMatrix||window.MSCSSMatrix||window.OCSSMatrix||window.MozCSSMatrix||window.CSSMatrix;if(d)c=function(a){return new d(a).toString()};else{var e="M"+Math.round((new Date).getTime()*Math.random()),f=jindo.$Agent().navigator(),g=f.firefox?"moz":f.ie?"ms":"o",h="-"+g+"-transform",i=document.createElement("style");i.type="text/css";var j=document.getElementsByTagName("html")[0];j.insertBefore(i,j.firstChild);var k=i.sheet||i.styleSheet,l=document.createElement("div");l.id=e;var m=window.getComputedStyle(l,null);c=function(a){var b=null;return k.insertRule("#"+e+" { "+h+": "+a+" !important; }",0),document.body.insertBefore(l,document.body.firstChild),b=m.getPropertyValue(h),document.body.removeChild(l),k.deleteRule(0),b}}var n=c(a);return/^([^\(]+)\(([^\)]*)\)$/.test(n)?{key:RegExp.$1,val:RegExp.$2.replace(/\s*,\s*/g," ")}:{key:"matrix",val:"1 0 0 1 0 0"}},_convertMatrix3d:function(a){if("matrix3d"===a.key)return a;var b=a.val.split(" ");return a.key="matrix3d",b.splice(2,0,"0"),b.splice(3,0,"0"),b.splice(6,0,"0"),b.splice(7,0,"0"),b.splice(8,0,"0"),b.splice(9,0,"0"),b.splice(10,0,"1"),b.splice(11,0,"0"),b.splice(14,0,"0"),b.splice(15,0,"1"),a.val=b.join(" "),a},_parseTransformText:function(a){a=a||"";var b={};return a.replace(/([\w\-]+)\(([^\)]*)\)/g,function(a,c,d){var e=d.split(/\s*,\s*/);switch(c){case"translate3d":case"scale3d":case"skew3d":c=c.replace(/3d$/,""),b[c+"Z"]=e[2];case"translate":case"scale":case"skew":b[c+"X"]=e[0],"undefined"==typeof e[1]?"scale"===c&&(b[c+"Y"]=e[0]):b[c+"Y"]=e[1];break;default:b[c]=e.join(",")}}),b},_getTransformFunction:function(a,b,c,d){var e,f,g;if(/matrix/.test(a+b))return f=this._getMatrixObj(a,d),g=this._getMatrixObj(b,d),f.key!==g.key&&(f=this._convertMatrix3d(f),g=this._convertMatrix3d(g)),c=c(f.val,g.val),function(a){return 1===a?b:f.key+"("+c(a).replace(/ /g,",")+")"};f=this._parseTransformText(a),g=this._parseTransformText(b);var h={};for(e in f)f.hasOwnProperty(e)&&(h[e]=c(f[e],g[e]||(/^scale/.test(e)?1:0)));for(e in g)!g.hasOwnProperty(e)||e in f||(h[e]=c(f[e]||(/^scale/.test(e)?1:0),g[e]));var i=function(a){var b=[];for(var c in h)h.hasOwnProperty(c)&&b.push(c+"("+h[c](a)+")");return b.join(" ")};return i}}).extend(jindo.Component),jindo.MouseGesture=jindo.$Class({_elCanvas:null,_oDC:null,_htEventHandler:{},_aPointList:[],_nPointCount:0,_sDrawingType:"",_bMobileSafari:!1,$init:function(a){var b=this;this.option({sLineColor:"#FF0000",nLineThickness:5,nFilteringDistance:10,elTargetWindow:window}),this.option(a);var c=window.navigator.userAgent.toLowerCase();this._bMobileSafari=/mobile/.test(c)&&/safari/.test(c)||/iphone/.test(c);var d=this.option("elTargetWindow").document;d.addEventListener&&d.addEventListener("mousedown",function(){b._htEventHandler.setted_context_menu=d.oncontextmenu,d.oncontextmenu=function(){return!1}},!0),this._htEventHandler.mouse_down=jindo.$Fn(this._onMouseDown,this).attach(d,this._bMobileSafari?"touchstart":"mousedown",!0),this._createCanvas()},_createCanvas:function(){var a=jindo.$("<canvas>");if(a.getContext)this._elCanvas=a,this._oDC=this._elCanvas.getContext("2d"),this._sDrawingType="canvas",this._oDC.globalCompositeOperation="destination-over";else{this.option("elTargetWindow").document.namespaces.vml_nhn||this.option("elTargetWindow").document.namespaces.add("vml_nhn","urn:schemas-microsoft-com:vml");var b=this.option("elTargetWindow").document.createStyleSheet();b.cssText="vml_nhn\\:shape, vml_nhn\\:stroke {behavior:url(#default#VML); display:inline-block; position:absolute;width:1px;height:1px;};",this._elCanvas=jindo.$("<div>"),this._sDrawingType="vml"}jindo.$Element(this._elCanvas).css({position:"absolute",top:"0px",left:"0px"}).hide().prependTo(this.option("elTargetWindow").document.body)},_showCanvas:function(){var a=jindo.$Document(this.option("elTargetWindow").document).clientSize(),b=jindo.$Document(this.option("elTargetWindow").document).scrollPosition();"canvas"==this._sDrawingType&&(this._elCanvas.width=a.width,this._elCanvas.height=a.height),jindo.$Element(this._elCanvas).css({top:b.top+"px",width:a.width+"px",height:a.height+"px",zIndex:999999}).show()},_hideCanvas:function(){this._elCanvas&&("vml"==this._sDrawingType?this._elCanvas.innerHTML="":"canvas"==this._sDrawingType&&(this._oDC.beginPath(),this._oDC.clearRect(0,0,this._elCanvas.offsetWidth,this._elCanvas.offsetHeight),this._oDC.closePath()),jindo.$Element(this._elCanvas).hide())},_drawLine:function(a,b){if("vml"==this._sDrawingType){var c=" m "+(1*a.nX-5)+","+(1*a.nY-5)+" l "+(1*b.nX-5)+","+(1*b.nY-5),d='<vml_nhn:shape coordsize="1 1" strokeweight="'+this.option("nLineThickness")+'pt" strokecolor="'+this.option("sLineColor")+'" path="'+c+'"><vml_nhn:stroke endcap="round" /></vml_nhn:shape>';this._elCanvas.insertAdjacentHTML("BeforeEnd",d)}else"canvas"==this._sDrawingType&&(this._oDC.save(),this._oDC.beginPath(),this._oDC.lineCap="round",this._oDC.lineWidth=this.option("nLineThickness")+2,this._oDC.strokeStyle=this.option("sLineColor"),this._oDC.moveTo(a.nX,a.nY),this._oDC.lineTo(b.nX,b.nY),this._oDC.stroke(),this._oDC.closePath(),this._oDC.restore())},_addPointList:function(a){var b;b=this._bMobileSafari?{pageX:a._event.targetTouches[0].clientX,pageY:a._event.targetTouches[0].clientY}:a.pos();var c={nX:b.clientX,nY:b.clientY};return this._aPointList.push(c),this._nPointCount++,c},_onMouseDown:function(a){(a.mouse().right||this._bMobileSafari)&&(a.stop(),this._addPointList(a),this._htEventHandler.mouse_move=jindo.$Fn(this._onMouseMove,this).attach(this.option("elTargetWindow").document,this._bMobileSafari?"touchmove":"mousemove"),this._htEventHandler.mouse_up=jindo.$Fn(this._onMouseUp,this).attach(this.option("elTargetWindow").document,this._bMobileSafari?"touchend":"mouseup"),"vml"==this._sDrawingType&&this.option("elTargetWindow").document.body.setCapture())},_onMouseMove:function(a){var b=this._addPointList(a);2===this._nPointCount&&this._showCanvas(),this._nPointCount%2&&this._drawLine({nX:this._aPointList[this._nPointCount-3].nX,nY:this._aPointList[this._nPointCount-3].nY},b)},_recognitionGesture:function(){for(var a,b,c,d,e,f,g,h,i=[],j=[],k=Math.tan(22.5*Math.PI/180),l=Math.tan(67.5*Math.PI/180),m=1;m<this._aPointList.length;m++)a=this._aPointList[m].nX,b=this._aPointList[m].nY,c=this._aPointList[m-1].nX,d=this._aPointList[m-1].nY,h=Math.sqrt(Math.pow(b-d,2)+Math.pow(a-c,2)),h>this.option("nFilteringDistance")&&(e=-(b-d)/(a-c),f=Math.abs(e),f>=l?g=d>b?8:4:k>f?g=c>a?6:2:f>=k&&l>f&&(g=e>0?1:3,c>a&&(g+=4)),i.push(g));for(m=1;m<i.length;m++)0===j.length?j.push(i[m]):j[j.length-1]!=i[m]&&j.push(i[m]);return{aCodeList:j,sCode:j.join("")}},_onMouseUp:function(a){if(a.mouse().right||this._bMobileSafari){a.stop(),this._htEventHandler.mouse_move&&this._htEventHandler.mouse_move.detach(this.option("elTargetWindow").document,this._bMobileSafari?"touchmove":"mousemove"),this._htEventHandler.mouse_up&&this._htEventHandler.mouse_up.detach(this.option("elTargetWindow").document,this._bMobileSafari?"touchend":"mouseup"),(this._aPointList.length&&!this._bMobileSafari||"setted_context_menu"in this._htEventHandler)&&("setted_context_menu"in this._htEventHandler||(this._htEventHandler.setted_context_menu=this.option("elTargetWindow").document.oncontextmenu,this.option("elTargetWindow").document.oncontextmenu=function(){return!1}),setTimeout(jindo.$Fn(function(){this.option("elTargetWindow").document.oncontextmenu=this._htEventHandler.setted_context_menu,delete this._htEventHandler.setted_context_menu},this).bind(),1)),"vml"==this._sDrawingType&&this.option("elTargetWindow").document.body.releaseCapture();var b=this._recognitionGesture();b.sCode&&this.fireEvent("gesture",b),this._nPointCount=0,this._aPointList=[],this._hideCanvas()}},destroy:function(){jindo.$Element(this._elCanvas).leave(),this._elCanvas=null,this._oDC=null,this._htEventHandler=null,this._nPointcount=null,this._aPointList=null,this._sDrawingType=null,this._bMobileSafari=null}}).extend(jindo.Component),jindo.MultipleAjaxRequest=jindo.$Class({_bIsRequesting:!1,$init:function(a){var b={sMode:"parallel"};this.option(b),this.option(a)},isRequesting:function(){return this._bIsRequesting},request:function(a,b){if(this.isRequesting())return!1;switch(a instanceof Array||(a=[a]),"undefined"==typeof b&&(b={}),this._htMetaData=b,this.option("sMode")){case"parallel":this._parallelRequest(a);break;case"serial":this._serialRequest(a);break;default:return!1}return!0},_fireEventStart:function(){return this._bIsRequesting=!0,this.fireEvent("start",{aAjax:this._aAjax,htMetaData:this._htMetaData})?!0:(this.abort(),!1)},_fireEventBeforeEachRequest:function(a){return this.fireEvent("beforeEachRequest",{oAjax:this._aAjax[a],nIndex:a})?!0:(this.abort(),!1)},_fireEventAfterEachResponse:function(a){return this.fireEvent("afterEachResponse",{oAjax:this._aAjax[a],nIndex:a})?!0:(this.abort(),!1)},_parallelRequest:function(a){if(this._aAjaxData=a,this._aAjax=[],this._aStatus=[],this._aStatus.length=a.length,this._aResponse=[],this._fireEventStart()){var b=this;jindo.$A(this._aAjaxData).forEach(function(a,c){var d=function(a){a._constructor=b._aAjax[c];var d=b._findAjaxObjectIndexOfResponse(a._constructor);b._aResponse[d]=a,b._aStatus[d]=!0,b._fireEventAfterEachResponse(d)&&b._hasCompletedGotResponsesOfParallelResponses()&&b._complete()};b._aAjax.push(jindo.$Ajax(a.sUrl,a.htOption)),a.htOption.onload=d,a.htOption.onerror=d,a.htOption.ontimeout=d,b._aAjax[c].option(a.htOption),b._fireEventBeforeEachRequest(c)?b._aAjax[c].request(a.htParameter||{}):jindo.$A.Break()})}},_findAjaxObjectIndexOfResponse:function(a){return jindo.$A(this._aAjax).indexOf(a)},_hasCompletedGotResponsesOfParallelResponses:function(){var a=!0;return jindo.$A(this._aStatus).forEach(function(b){b||(a=!1,jindo.$A.Break())}),a},_serialRequest:function(a){this._aAjaxData=a,this._aAjax=[],this._aStatus=[],this._aStatus.length=a.length,this._aResponse=[];var b=this;jindo.$A(this._aAjaxData).forEach(function(a,c){var d=function(a){a._constructor=b._aAjax[c],b._aResponse.push(a),b._serialRequestNext()};b._aAjax.push(jindo.$Ajax(a.sUrl,a.htOption)),a.htOption.onload=d,a.htOption.onerror=d,a.htOption.ontimeout=d,b._aAjax[c].option(a.htOption)}),this._fireEventStart()&&this._fireEventBeforeEachRequest(0)&&(this._aAjax[0].request(this._aAjaxData[0].htParameter||{}),this._aStatus[0]=!0)},_serialRequestNext:function(){for(var a=-1,b=0;b<this._aStatus.length;b++)if(!this._aStatus[b]){this._aStatus[b]=!0,a=b;break}a>0?this._fireEventAfterEachResponse(a-1)&&this._fireEventBeforeEachRequest(a)&&this._aAjax[a].request(this._aAjaxData[a].htParameter||{}):-1==a&&this._fireEventAfterEachResponse(this._aStatus.length-1)&&this._complete()},_reset:function(){this._aAjaxData.length=0,this._aAjax.length=0,this._aStatus.length=0,this._aResponse.length=0,this._htMetaData=null,delete this._aAjaxData,delete this._aAjax,delete this._aStatus,delete this._aResponse,delete this._htMetaData,this._bIsRequesting=!1},abort:function(){jindo.$A(this._aAjax).forEach(function(a){a.abort()}),this._reset()},_complete:function(){var a,b=this._aResponse.concat(),c={};for(a in this._htMetaData)c[a]=this._htMetaData[a];this._reset(),this.fireEvent("complete",{aResponse:b,htMetaData:c})}}).extend(jindo.Component),jindo.Formatter=jindo.$Class({_aMarks:["\x00","￿"],_sPrevValue:null,_oTextRange:null,_bFakeFocus:!1,$init:function(a,b){this._el=jindo.$(a),this.option({bPaintOnload:!0,bActivateOnload:!0}),this.option(b||{}),this.isOpera=jindo.$Agent().navigator.opera;this._wfRealBlur=jindo.$Fn(this._realBlur,this),this._wfRealFocus=jindo.$Fn(this._realFocus,this),this._oTextRange=new jindo.TextRange(a);var c=jindo.$Agent().navigator();jindo.$Fn(this._onInput,this).attach(this._el,c.ie&&c.version<9?"keydown":"input").attach(this._el,"paste"),this.option("bPaintOnload")&&this._onInput(),this.option("bActivateOnload")&&this.activate()},_onInput:function(){var a=this;setTimeout(function(){a.paint()},1)},_splice:function(a,b,c,d){return a.slice(0,b)+d+a.slice(b+c)},setValue:function(a){return this._el.value=a,this.paint(),this},paint:function(){var a,b,c=this._el,d=this._oTextRange,e=this._aMarks,f=c.value.toString(),g=d.hasFocus();if(g){a=[-1,-1];try{a=d.getSelection()}catch(h){}f=this._splice(this._splice(f,a[1],0,e[1]),a[0],0,e[0])}if(b={elInput:c,sText:f,sStartMark:e[0],sEndMark:e[1]},this.fireEvent("beforeChange",b)){var i=b.sText;if(g){var j=i.indexOf(e[0]);j>-1&&(i=this._splice(i,j,1,"")),a=[j],a[1]=i.indexOf(e[1]),a[1]>-1&&(i=this._splice(i,a[1],1,""));var k=this;setTimeout(function(){k._bFakeFocus=!0,!this.isOpera||c.blur()},1),setTimeout(function(){c.blur(),c.value=i,c.focus();try{d.setSelection(a[0],a[1])}catch(b){}k.fireEvent("change",{elInput:c})},2),setTimeout(function(){k._bFakeFocus=!1},20)}else c.value=i,this.fireEvent("change",{elInput:c})}return this},_realBlur:function(){this._bFakeFocus||this.fireEvent("blur",{elInput:this._el})},_realFocus:function(){this._bFakeFocus||this.fireEvent("focus",{elInput:this._el})},_onActivate:function(){this._wfRealBlur.attach(this._el,"blur"),this._wfRealFocus.attach(this._el,"focus")},_onDeactivate:function(){this._wfRealBlur.detach(this._el,"blur"),this._wfRealFocus.detach(this._el,"focus")}}).extend(jindo.UIComponent),jindo.NumericStepper=jindo.$Class({_bIsOnFocus:!1,$init:function(a,b){this._el=jindo.$(a),this.option({sClassPrefix:"ns-",bActivateOnload:!0,bUseMouseWheel:!1,nStep:1,nDecimalPoint:0,nMin:-1/0,nMax:1/0,nDefaultValue:0,bInputReadOnly:!0}),this.option(b||{}),this._assignHTMLElements(),this._wfPlusClick=jindo.$Fn(this._onPlusClick,this),this._wfMinusClick=jindo.$Fn(this._onMinusClick,this),this._wfWheel=jindo.$Fn(this._onWheel,this),this._wfFocus=jindo.$Fn(this._onFocus,this),this._wfBlur=jindo.$Fn(this._onBlur,this),this.option("bActivateOnload")&&this.activate()},_assignHTMLElements:function(){var a=this.option("sClassPrefix");this._elInput=jindo.$$.getSingle("."+a+"input",this._el),this._elPlusButton=jindo.$$.getSingle("."+a+"plus",this._el),this._elMinusButton=jindo.$$.getSingle("."+a+"minus",this._el)
},reset:function(){this._elInput.value=this.option("nDefaultValue").toFixed(this.option("nDecimalPoint"))},getValue:function(){return parseFloat(this._elInput.value)},setValue:function(a){"number"!=typeof a&&(a=this.option("nDefaultValue"));var b=this.option("nMin"),c=this.option("nMax"),d={nValue:a,nMin:b,nMax:c};this.fireEvent("beforeChange",d)&&((d.nValue>c||d.nValue<b)&&(this.fireEvent("overLimit",d),d.nValue=Math.max(b,Math.min(c,d.nValue))),this._elInput.value=d.nValue.toFixed(this.option("nDecimalPoint")),this.fireEvent("change",d))},getBaseElement:function(){return this._el},getInputElement:function(){return this._elInput},getPlusElement:function(){return this._elPlusButton},getMinusElement:function(){return this._elMinusButton},isFocused:function(){return this._bIsOnFocus},_onActivate:function(){var a=this.getInputElement();this._wfPlusClick.attach(this.getPlusElement(),"click"),this._wfMinusClick.attach(this.getMinusElement(),"click"),this._wfFocus.attach(a,"focus"),this._wfBlur.attach(a,"blur"),this.option("bUseMouseWheel")&&this._wfWheel.attach(a,"mousewheel"),this._elInput.readOnly=this.option("bInputReadOnly"),this.reset()},_onDeactivate:function(){var a=this.getInputElement();this._wfPlusClick.detach(this.getPlusElement(),"click"),this._wfMinusClick.detach(this.getMinusElement(),"click"),this._wfFocus.detach(a,"focus"),this._wfBlur.detach(a,"blur"),this._wfWheel.detach(a,"mousewheel")},_onMinusClick:function(){this.setValue(this.getValue()-this.option("nStep"))},_onPlusClick:function(){this.setValue(this.getValue()+this.option("nStep"))},_onWheel:function(a){this.isFocused()&&(a.stop(jindo.$Event.CANCEL_DEFAULT),a.mouse().delta>0?this._onPlusClick():this._onMinusClick())},_onFocus:function(){this._bIsOnFocus=!0},_onBlur:function(){this._bIsOnFocus=!1,this.setValue(this.getValue()),this._elInput.readOnly=this.option("bInputReadOnly")}}).extend(jindo.UIComponent),jindo.Pagination=jindo.$Class({$init:function(a,b){this._elPageList=jindo.$(a),this._welPageList=jindo.$Element(this._elPageList),this._waPage=jindo.$A([]),this._fClickPage=jindo.$Fn(this._onClickPageList,this),this.option({bActivateOnload:!0,nItem:10,nItemPerPage:10,nPagePerPageList:10,nPage:1,sMoveUnit:"pagelist",bAlignCenter:!1,sInsertTextNode:"",sClassPrefix:"",sClassFirst:"first-child",sClassLast:"last-child",sPageTemplate:"<a href='#'>{=page}</a>",sCurrentPageTemplate:"<strong>{=page}</strong>",elFirstPageLinkOn:jindo.$$.getSingle("a."+this._wrapPrefix("pre_end"),this._elPageList),elPrevPageLinkOn:jindo.$$.getSingle("a."+this._wrapPrefix("pre"),this._elPageList),elNextPageLinkOn:jindo.$$.getSingle("a."+this._wrapPrefix("next"),this._elPageList),elLastPageLinkOn:jindo.$$.getSingle("a."+this._wrapPrefix("next_end"),this._elPageList),elFirstPageLinkOff:jindo.$$.getSingle("span."+this._wrapPrefix("pre_end"),this._elPageList),elPrevPageLinkOff:jindo.$$.getSingle("span."+this._wrapPrefix("pre"),this._elPageList),elNextPageLinkOff:jindo.$$.getSingle("span."+this._wrapPrefix("next"),this._elPageList),elLastPageLinkOff:jindo.$$.getSingle("span."+this._wrapPrefix("next_end"),this._elPageList)}),this.option(b||{}),this.option("bActivateOnload")&&this.activate()},option:function(a,b){var c=jindo.Component.prototype.option.apply(this,arguments);if("object"==typeof a||"undefined"!=typeof b){var d=this.option("sMoveUnit"),e=this.option("bAlignCenter");if(e&&"pageunit"===d)throw new Error('Invalid Option : sMoveUnit can\'t be set to "pageunit" when bAlignCenter is true.')}return c},_wrapPrefix:function(a){var b=this.option("sClassPrefix");return b?b+a.replace(/_/g,"-"):a},getBaseElement:function(){return this._elPageList},getItemCount:function(){return this.option("nItem")},setItemCount:function(a){this.option({nItem:a})},getItemPerPage:function(){return this.option("nItemPerPage")},setItemPerPage:function(a){this.option("nItemPerPage",a)},getCurrentPage:function(){return this._nCurrentPage},getFirstItemOfPage:function(a){return this.getItemPerPage()*(a-1)+1},getPageOfItem:function(a){return Math.ceil(a/this.getItemPerPage())},_getLastPage:function(){return Math.ceil(this.getItemCount()/this.getItemPerPage())},_getRelativePage:function(a){var b=null,c="page"==this.option("sMoveUnit"),d=this._getPageList(this.getCurrentPage());switch(a){case"pre_end":b=1;break;case"next_end":b=this._getLastPage();break;case"pre":b=c?this.getCurrentPage()-1:(d-1)*this.option("nPagePerPageList");break;case"next":b=c?this.getCurrentPage()+1:d*this.option("nPagePerPageList")+1}return b},_getPageList:function(a){if(this.option("bAlignCenter")){var b=Math.floor(this.option("nPagePerPageList")/2),c=a-b;return c=Math.max(c,1),c=Math.min(c,this._getLastPage())}return Math.ceil(a/this.option("nPagePerPageList"))},_isIn:function(a,b){return b?a===b?!0:jindo.$Element(a).isChildOf(b):!1},_getPageElement:function(a){for(var b=0,c=this._waPage.$value().length;c>b;b++){var d=this._waPage.get(b);if(this._isIn(a,d))return d}return null},_onClickPageList:function(a){a.stop(jindo.$Event.CANCEL_DEFAULT);var b=null,c=this.option(),d=a.element;if(this._isIn(d,c.elFirstPageLinkOn))b=this._getRelativePage("pre_end");else if(this._isIn(d,c.elPrevPageLinkOn))b=this._getRelativePage("pre");else if(this._isIn(d,c.elNextPageLinkOn))b=this._getRelativePage("next");else if(this._isIn(d,c.elLastPageLinkOn))b=this._getRelativePage("next_end");else{var e=this._getPageElement(d);if(!e)return;b=parseInt(jindo.$Element(e).text(),10)}this.fireEvent("click",{nPage:b,weEvent:a})&&this.movePageTo(b)},_convertToAvailPage:function(a){var b=this._getLastPage();return a=Math.max(a,1),a=Math.min(a,b)},movePageTo:function(a,b){"undefined"==typeof b&&(b=!0),a=this._convertToAvailPage(a),this._nCurrentPage=a,(!b||this.fireEvent("beforeMove",{nPage:a}))&&(this._paginate(a),b&&this.fireEvent("move",{nPage:a}))},reset:function(a){"undefined"==typeof a&&(a=this.option("nItem")),this.setItemCount(a),this.movePageTo(1,!1)},_onActivate:function(){jindo.$Element.prototype.preventTapHighlight&&this._welPageList.preventTapHighlight(!0),this._fClickPage.attach(this._elPageList,"click"),this.setItemCount(this.option("nItem")),this.movePageTo(this.option("nPage"),!1),this._welPageList.addClass(this._wrapPrefix("loaded"))},_onDeactivate:function(){jindo.$Element.prototype.preventTapHighlight&&this._welPageList.preventTapHighlight(!1),this._fClickPage.detach(this._elPageList,"click"),this._welPageList.removeClass(this._wrapPrefix("loaded"))},_addTextNode:function(){var a=this.option("sInsertTextNode");this._elPageList.appendChild(document.createTextNode(a))},_paginate:function(a){this._empty(),this._addTextNode();var b=this.option(),c=b.elFirstPageLinkOn,d=b.elPrevPageLinkOn,e=b.elNextPageLinkOn,f=b.elLastPageLinkOn,g=b.elFirstPageLinkOff,h=b.elPrevPageLinkOff,i=b.elNextPageLinkOff,j=b.elLastPageLinkOff,k=this._getLastPage(),l=this._getPageList(a),m=this._getPageList(k);0===k?this._welPageList.addClass(this._wrapPrefix("no-result")):1==k?this._welPageList.addClass(this._wrapPrefix("only-one")).removeClass(this._wrapPrefix("no-result")):this._welPageList.removeClass(this._wrapPrefix("only-one")).removeClass(this._wrapPrefix("no-result"));var n,o;if(b.bAlignCenter){var p=Math.floor(b.nPagePerPageList/2);n=a-p,n=Math.max(n,1),o=n+b.nPagePerPageList-1,o>k&&(n=k-b.nPagePerPageList+1,n=Math.max(n,1),o=k)}else n=(l-1)*b.nPagePerPageList+1,o=l*b.nPagePerPageList,o=Math.min(o,k);"page"==b.sMoveUnit&&(l=a,m=k),a>1?c&&(this._welPageList.append(c),this._addTextNode()):g&&(this._welPageList.append(g),this._addTextNode()),l>1?d&&(this._welPageList.append(d),this._addTextNode()):h&&(this._welPageList.append(h),this._addTextNode());for(var q,r,s=n;o>=s;s++)s==a?q=jindo.$(jindo.$Template(b.sCurrentPageTemplate).process({page:s.toString()})):(q=jindo.$(jindo.$Template(b.sPageTemplate).process({page:s.toString()})),this._waPage.push(q)),r=jindo.$Element(q),s==n&&r.addClass(this._wrapPrefix(this.option("sClassFirst"))),s==o&&r.addClass(this._wrapPrefix(this.option("sClassLast"))),this._welPageList.append(q),this._addTextNode();m>l?e&&(this._welPageList.append(e),this._addTextNode()):i&&(this._welPageList.append(i),this._addTextNode()),k>a?f&&(this._welPageList.append(f),this._addTextNode()):j&&(this._welPageList.append(j),this._addTextNode())},_empty:function(){var a=this.option();this.option({elFirstPageLinkOn:this._clone(a.elFirstPageLinkOn),elPrevPageLinkOn:this._clone(a.elPrevPageLinkOn),elNextPageLinkOn:this._clone(a.elNextPageLinkOn),elLastPageLinkOn:this._clone(a.elLastPageLinkOn),elFirstPageLinkOff:this._clone(a.elFirstPageLinkOff),elPrevPageLinkOff:this._clone(a.elPrevPageLinkOff),elNextPageLinkOff:this._clone(a.elNextPageLinkOff),elLastPageLinkOff:this._clone(a.elLastPageLinkOff)}),this._waPage.empty(),this._welPageList.empty()},_clone:function(a){return a&&a.cloneNode?a.cloneNode(!0):a}}).extend(jindo.UIComponent),jindo.Rolling=jindo.$Class({_oTransition:null,$init:function(a,b){this.option({nFPS:50,nDuration:800,sDirection:"horizontal",fEffect:jindo.Effect.linear,sClassPrefix:"rolling-"}),this.option(b||{}),this._el=jindo.$(a);var c="."+this.option("sClassPrefix")+"list";this._bUsedClassPrefix=!0,this._elList=jindo.$$.test(this._el,c)?this._el:jindo.$$.getSingle("> "+c,a),this._elList||(this._elList=jindo.$$.test(this._el,"ul, ol")?this._el:jindo.$$.getSingle("> ul, > ol",a),this._bUsedClassPrefix=!1),this._oKeys="horizontal"==this.option("sDirection")?{offsetWidth:"offsetWidth",marginLeft:"marginLeft",marginRight:"marginRight",clientWidth:"clientWidth",scrollLeft:"scrollLeft"}:{offsetWidth:"offsetHeight",marginLeft:"marginTop",marginRight:"marginBottom",clientWidth:"clientHeight",scrollLeft:"scrollTop"},this._initTransition()},_initTransition:function(){var a=this;this._oTransition=(new jindo.Transition).fps(this.option("nFPS")).attach({end:function(){if(a._nItemCount){var b=a._oKeys;a._el[b.scrollLeft]=a._getPosition(a.getIndex()%a._nItemCount)}a.fireEvent("afterMove",{nIndex:a.getIndex()})}})},getTransition:function(){return this._oTransition},getList:function(){return this._elList},getItems:function(){var a="."+this.option("sClassPrefix")+"item";return this._bUsedClassPrefix?jindo.$$("> "+a,this._elList):jindo.$$("> li",this._elList)},_offsetSize:function(a){var b=jindo.$Element(a),c=this._oKeys,d=parseInt(b.css(c.marginLeft),10)||0,e=parseInt(b.css(c.marginRight),10)||0;return a[c.offsetWidth]+d+e},getIndex:function(){if(this.isMoving())return this._nMoveTo;for(var a=this._el,b=this._oKeys,c=a[b.scrollLeft],d=this.getItems(),e=0,f=0,g=99999999,h=0;h<d.length;h++){var i=Math.abs(c-e);g>i&&(g=i,f=h),e+=this._offsetSize(d[h])}return f},_getPosition:function(a){for(var b=this._el,c=this._oKeys,d=this.getItems(),e=0,f=this._getSize(),g=0;a>g;g++)e+=this._offsetSize(d[g]);return e+b[c.clientWidth]>f&&(e=f-b[c.clientWidth]),e},_getSize:function(){for(var a=this.getItems(),b=0,c=0;c<a.length;c++)b+=this._offsetSize(a[c]);return this._nSize=b},_move:function(a){var b=this._el,c=this._oKeys,d=(this.getItems(),this._getPosition(a)),e=(this._getSize(),{element:b,nIndex:a,nScroll:d});if(this.fireEvent("beforeMove",e)&&b[c.scrollLeft]!=e.nScroll){var f={};return f[c.scrollLeft]=this.option("fEffect")(e.nScroll),this._nMoveTo=a,this.getTransition().abort().start(this.option("nDuration"),e.element,f),!0}return!1},moveTo:function(a){return a=Math.min(a,this.getItems().length-1),a=Math.max(a,0),this._move(a)},moveLastTo:function(a){return this.moveTo(this.getItems().length-1-a)},moveBy:function(a){return this.moveTo(this.getIndex()+a)},isMoving:function(){return this._oTransition.isPlaying()},isOverflowed:function(){return this._getSize()>this._el[this._oKeys.clientWidth]},getDisplayedItemCount:function(){for(var a=0,b=this.getItems(),c=0,d=0;d<b.length&&(c+=this._offsetSize(b[d]),c<=this._el[this._oKeys.clientWidth]);d++)a++;return a}}).extend(jindo.Component),jindo.RollingChart=jindo.$Class({_nIndexOfRolling:0,_bIsRolling:!1,$init:function(a,b){var c={sClassPrefix:"rollingchart-",sDirection:"down",nFPS:50,nDuration:300,nRollingInterval:100,sUrl:"",sRequestType:"jsonp",sRequestMethod:"get",htRequestParameter:null,nRequestInterval:1e4,bActivateOnload:!0};this.option(c),this.option(b||{}),this._el=jindo.$(a),this._assignHTMLElements(),this._initTimer(),this._initRolling(),this.option("bActivateOnload")&&this.activate()},_assignHTMLElements:function(){this._elList=jindo.$$.getSingle("ol",this._el),this._aItems=jindo.$$("> li",this._elList)},getList:function(){return this._elList},getItems:function(){return this._aItems},getListOfItem:function(a){return jindo.$$.getSingle("ul",a)},isRolling:function(){return this._bIsRolling},_initTimer:function(){this._oRequestTimer=new jindo.Timer},getTimer:function(){return this._oRequestTimer},_initRolling:function(){var a=this;this._oRollingEventHandler={end:function(){setTimeout(function(){a.fireEvent("afterRolling",{nIndex:a._nIndexOfRolling}),a._roll(a._nIndexOfRolling+1)},a.option("nRollingInterval"))}},this._oRolling=new jindo.Rolling(this._el,{nFPS:this.option("nFPS"),nDuration:this.option("nDuration"),sDirection:"vertical",fEffect:jindo.Effect.linear})},getRolling:function(){return this._oRolling},_setItemIndexToRolling:function(a){var b=this.getListOfItem(this.getItems()[a]),c=this.getRolling();c._el=b,c._elList=b},_onActivate:function(){var a=this;this.getTimer().start(function(){return a._stopRequest(),a._request(),!0},this.option("nRequestInterval"))},_onDeactivate:function(){this.getTimer().abort()},_request:function(){if(!this.isRolling()){var a=this.option(),b=a.sUrl,c=a.htRequestParameter,d=this;this._oAjax=jindo.$Ajax(b,{type:a.sRequestType,method:a.sRequestMethod,onload:function(a){try{var b={htResponseJSON:a.json()};if(!d.fireEvent("response",b))return;if(!d.fireEvent("beforeUpdate"))return;var c=b.htResponseJSON;d._addItemToRolling(c),d.getRolling().getTransition().attach(d._oRollingEventHandler),d._roll(0)}catch(e){}}}),d.fireEvent("request")&&this._oAjax.request(c)}},_stopRequest:function(){try{this._oAjax.abort(),this._oAjax=null}catch(a){}},_addItemToRolling:function(a){var b=this,c=this.option("sDirection");jindo.$A(this.getItems()).forEach(function(d,e){var f=jindo.$Element(jindo.$("<li>"));f.html(a.items[e]);var g=b.getListOfItem(d);"down"==c?(g.insertBefore(f.$value(),g.firstChild),g.scrollTop=9999):(jindo.$Element(g).append(f.$value()),g.scrollTop=0)})},_removeItemRolled:function(){var a=this,b=this.option("sDirection");jindo.$A(this.getItems()).forEach(function(c){if("down"==b)jindo.$Element(jindo.$$("li",a.getListOfItem(c))[1]).leave();else{var d=a.getListOfItem(c);jindo.$Element(jindo.$$.getSingle("li",d)).leave(),d.scrollTop=0}}),this._nIndexOfRolling=0},_roll:function(a){this._bIsRolling=!0,this._nIndexOfRolling=a,this.fireEvent("beforeRolling",{nIndex:a});var b=a;if(b==this.getItems().length)return this._removeItemRolled(),this._nIndexOfRolling=0,this.getRolling().getTransition().detach(this._oRollingEventHandler),this._bIsRolling=!1,void this.fireEvent("afterUpdate");this._setItemIndexToRolling(b);var c=1;"down"==this.option("sDirection")&&(c=-1),this.getRolling().moveBy(c)}}).extend(jindo.UIComponent),jindo.RolloverArea=jindo.$Class({$init:function(a,b){this.option({sClassName:"rollover",sClassPrefix:"rollover-",bCheckMouseDown:!0,bActivateOnload:!0,htStatus:{sOver:"over",sDown:"down"}}),this.option(b||{}),this._elArea=jindo.$(a),this._aOveredElements=[],this._aDownedElements=[],this._wfMouseOver=jindo.$Fn(this._onMouseOver,this),this._wfMouseOut=jindo.$Fn(this._onMouseOut,this),this._wfMouseDown=jindo.$Fn(this._onMouseDown,this),this._wfMouseUp=jindo.$Fn(this._onMouseUp,this),this.option("bActivateOnload")&&this.activate()},_addOvered:function(a){this._aOveredElements.push(a)},_removeOvered:function(a){this._aOveredElements.splice(jindo.$A(this._aOveredElements).indexOf(a),1)},_addStatus:function(a,b){jindo.$Element(a).addClass(this.option("sClassPrefix")+b)},_removeStatus:function(a,b){jindo.$Element(a).removeClass(this.option("sClassPrefix")+b)},_isInnerElement:function(a,b){return a===b?!0:jindo.$Element(a).isParentOf(b)},_onActivate:function(){jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(this._elArea).preventTapHighlight(!0),this._wfMouseOver.attach(this._elArea,"mouseover"),this._wfMouseOut.attach(this._elArea,"mouseout"),this.option("bCheckMouseDown")&&(this._wfMouseDown.attach(this._elArea,"mousedown"),this._wfMouseUp.attach(document,"mouseup"))},_onDeactivate:function(){jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(this._elArea).preventTapHighlight(!1),this._wfMouseOver.detach(this._elArea,"mouseover"),this._wfMouseOut.detach(this._elArea,"mouseout"),this._wfMouseDown.detach(this._elArea,"mousedown"),this._wfMouseUp.detach(document,"mouseup"),this._aOveredElements.length=0,this._aDownedElements.length=0},_findRollover:function(a){var b=this.option("sClassName");return jindo.$$.test(a,"."+b)?a:jindo.$$.getSingle("! ."+b,a)},_onMouseOver:function(a){for(var b,c=a.element,d=a.relatedElement;c=this._findRollover(c);c=c.parentNode)d&&this._isInnerElement(c,d)||(this._addOvered(c),b={element:c,htStatus:this.option("htStatus"),weEvent:a},this.fireEvent("over",b)&&this._addStatus(b.element,b.htStatus.sOver))},_onMouseOut:function(a){for(var b,c=a.element,d=a.relatedElement;c=this._findRollover(c);c=c.parentNode)d&&this._isInnerElement(c,d)||(this._removeOvered(c),b={element:c,htStatus:this.option("htStatus"),weEvent:a},this.fireEvent("out",b)&&this._removeStatus(b.element,b.htStatus.sOver))},_onMouseDown:function(a){for(var b,c=a.element;c=this._findRollover(c);)b={element:c,htStatus:this.option("htStatus"),weEvent:a},this._aDownedElements.push(c),this.fireEvent("down",b)&&this._addStatus(b.element,b.htStatus.sDown),c=c.parentNode},_onMouseUp:function(a){var b,c,d,e=a.element,f=[],g=this._aDownedElements;for(d=0;c=g[d];d++)f.push({element:c,htStatus:this.option("htStatus"),weEvent:a});for(;e=this._findRollover(e);e=e.parentNode)jindo.$A(g).indexOf(e)>-1||f.push({element:e,htStatus:this.option("htStatus"),weEvent:a});for(d=0;b=f[d];d++)this.fireEvent("up",b)&&this._removeStatus(b.element,b.htStatus.sDown);this._aDownedElements=[]}}).extend(jindo.UIComponent),jindo.RolloverClick=jindo.$Class({$init:function(a,b){this.option({bActivateOnload:!0,sCheckEvent:"click",bCheckDblClick:!1,RolloverArea:{sClassName:"rollover",sClassPrefix:"rollover-",bCheckMouseDown:!1,bActivateOnload:!1,htStatus:{sOver:"over",sDown:"down"}}}),this.option(b||{});var c=this;this._oRolloverArea=new jindo.RolloverArea(a,this.option("RolloverArea")).attach({over:function(a){c.fireEvent("over",a)||a.stop()},out:function(a){c.fireEvent("out",a)||a.stop()}}),this._wfClick=jindo.$Fn(this._onClick,this),this._wfDblClick=jindo.$Fn(this._onClick,this),this.option("bActivateOnload")&&this.activate()},_onClick:function(a){var b=a.element,c="click";for("dblclick"==a.type&&(c=a.type);b=this._oRolloverArea._findRollover(b);)this.fireEvent(c,{element:b,htStatus:this._oRolloverArea.option("htStatus"),weEvent:a}),b=b.parentNode},_onActivate:function(){this._wfClick.attach(this._oRolloverArea._elArea,this.option("sCheckEvent")),this.option("bCheckDblClick")&&this._wfDblClick.attach(this._oRolloverArea._elArea,"dblclick"),this._oRolloverArea.activate()},_onDeactivate:function(){this._wfClick.detach(this._oRolloverArea._elArea,this.option("sCheckEvent")),this._wfDblClick.detach(this._oRolloverArea._elArea,"dblclick"),this._oRolloverArea.deactivate()}}).extend(jindo.UIComponent),jindo.Slider=jindo.$Class({_elTrack:null,_aThumbs:null,_aPoses:null,_htSwap:null,$init:function(a,b){this.option({sClassPrefix:"slider-",bVertical:!1,bJump:!0,bDragOnTrack:!0,fAdjustValue:null,nMinValue:0,nMaxValue:1,bActivateOnload:!0}),this.option(b||{}),this._htSwap=this.option("bVertical")?{y:"nX",x:"nY",clientX:"clientY",pageX:"pageY",offsetWidth:"offsetHeight",left:"top"}:{y:"nY",x:"nX",clientX:"clientX",pageX:"pageX",offsetWidth:"offsetWidth",left:"left"},this._elTrack=jindo.$(a),this._aThumbs=jindo.$$("."+this.option("sClassPrefix")+"thumb",this._elTrack),this._sRand="S"+parseInt(1e8*Math.random(),10),jindo.$ElementList(this._aThumbs).addClass(this._sRand),this._aPoses=this.positions(),this._onTrackMouseDownFn=jindo.$Fn(this._onTrackMouseDown,this),this._initDragArea(),this.option("bActivateOnload")&&this.activate()},getTrack:function(){return this._elTrack},getThumb:function(a){return this._aThumbs[a]},_initDragArea:function(){var a=this,b=this._htSwap;this._oDragArea=new jindo.DragArea(this._elTrack,{sClassName:this._sRand,bFlowOut:!1}).attach({beforeDrag:function(c){var d=a._getThumbIndex(c.elHandle),e={nIndex:d,nPos:c[b.x],bJump:!1};return a.fireEvent("beforeChange",e)?(c[b.x]=a._getAdjustedPos(d,e.nPos),void(c[b.y]=null)):(c.stop(),!1)},drag:function(c){var d=a._getThumbIndex(c.elHandle),e=c[b.x];e!=a._aPoses[d]&&(a._aPoses[d]=e,a._fireChangeEvent(d))}})},getDragArea:function(){return this._oDragArea},_fireChangeEvent:function(a){var b=this._getPosition(a);this.fireEvent("change",{nIndex:a,nPos:b,nValue:this._getValue(a,b)})},_onActivate:function(){this.getDragArea().activate(),jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(this._elTrack).preventTapHighlight(!0),this._onTrackMouseDownFn.attach(this._elTrack,"mousedown")},_onDeactivate:function(){this.getDragArea().deactivate(),jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(this._elTrack).preventTapHighlight(!1),this._onTrackMouseDownFn.detach(this._elTrack,"mousedown")},_onTrackMouseDown:function(a){if(this.option("bJump")){a.stop(jindo.$Event.CANCEL_DEFAULT);var b=0,c=this._htSwap,d=a.element,e="."+this.option("sClassPrefix")+"thumb",f=jindo.$$.test(d,e)||jindo.$$.getSingle("! "+e,d);if(!f){var g=a.pos()[c.pageX];g-=jindo.$Element(this._elTrack).offset()[c.left];for(var h,i=9999999,j=0;h=this._aThumbs[j];j++){var k=parseInt(jindo.$Element(h).css(c.left),10)||0;k+=parseInt(h[c.offsetWidth]/2,10);var l=Math.abs(g-k);i>l&&(i=l,b=j)}g-=parseInt(this._aThumbs[b][c.offsetWidth]/2,10),this.positions(b,g),this.option("bDragOnTrack")&&this.getDragArea().startDragging(this._aThumbs[b])}}},_getTrackInfo:function(a){var b=this._htSwap,c=this._aThumbs[a],d=c[b.offsetWidth],e=this._elTrack[b.offsetWidth],f=e-d,g=this.option("nMaxValue"),h=this.option("nMinValue");return{maxPos:f,max:g,min:h}},_getValue:function(a,b){"undefined"==typeof b&&(b=this._getPosition(a));var c=this._getTrackInfo(a),d=0;0!==c.maxPos&&(d=b*(c.max-c.min)/c.maxPos);var e=d+c.min;e=Math.min(Math.max(e,Math.min(c.min,c.max)),Math.max(c.min,c.max));var f=this.option("fAdjustValue");return f&&(e=f.call(this,e)),e},_getAdjustedPos:function(a,b){var c=b,d=this._getTrackInfo(a),e=this.option("fAdjustValue");if(e){var f=Math.min(Math.max(c*(d.max-d.min)/d.maxPos+d.min,d.min),d.max),g=e.call(this,f);f!=g&&(c=d.maxPos*(g-d.min)/(d.max-d.min))}return c=Math.max(c,0),c=Math.min(c,d.maxPos)},_getThumbIndex:function(a){for(var b=0,c=this._aThumbs.length;c>b;b++)if(this._aThumbs[b]==a)return b;return-1},_getPosition:function(a){var b=jindo.$Element(this._aThumbs[a]).css(this._htSwap.left);return"auto"==b?0:parseInt(b,10)},_setPosition:function(a,b){this._aPoses[a]=b,jindo.$Element(this._aThumbs[a]).css(this._htSwap.left,b+"px")},positions:function(a,b,c){switch("undefined"==typeof c&&(c=!0),arguments.length){case 0:var d=[];return jindo.$A(this._aThumbs).forEach(function(a,b){d[b]=this._getPosition(b)},this),d;case 1:return this._getPosition(a);default:if(c){var e={nIndex:a,nPos:b,bJump:!0};if(this.fireEvent("beforeChange",e)){var f=this._getAdjustedPos(a,e.nPos),g=f!=this._aPoses[a];this._setPosition(a,f),g&&this._fireChangeEvent(a)}return this}return this._setPosition(a,this._getAdjustedPos(a,b)),this}},values:function(a,b,c){switch("undefined"==typeof c&&(c=!0),arguments.length){case 0:for(var d=[],e=0,f=this._aThumbs.length;f>e;e++)d[e]=this._getValue(e);return d;case 1:return this._getValue(a,this.positions(a));default:var g=this._getTrackInfo(a);return this.positions(a,(b-g.min)*g.maxPos/(g.max-g.min)||0,c),this}}}).extend(jindo.UIComponent),jindo.ScrollBar=new jindo.$Class({_bMouseEnter:!1,_bIsEventAttachedForCommon:!1,_bIsEventAttachedForVertical:!1,_bIsEventAttachedForHorizontal:!1,$init:function(a,b){this.option({sClassPrefix:"scrollbar-",nDelta:16,sClassNameForRollover:"rollover",bActivateOnload:!0}),this.option(b||{}),this._el=jindo.$(a),this._oOldPos={left:null,top:null},this._oTimer=new jindo.Timer,this._oTransition=(new jindo.Transition).fps(30),this._wfOnMouseEnter=jindo.$Fn(this._onMouseEnter,this),this._wfOnMouseLeave=jindo.$Fn(this._onMouseLeave,this),this._wfOnWheel=jindo.$Fn(this._onWheel,this),this._wfOnMouseUp=jindo.$Fn(this._onMouseUp,this),this._assignHTMLElements(),this._initialize4Tablet(),this.option("bActivateOnload")&&this.activate()},_assignHTMLElements:function(){var a=this._el,b=this.option("sClassPrefix");this._elBox=jindo.$$.getSingle("."+b+"box",a),this._elContent=jindo.$$.getSingle("."+b+"content",a);var c=jindo.$Element(this._elBox),d=jindo.$Element(this._elContent);this._oBoxSize={nWidth:c.width(),nHeight:c.height()},this._oContentSize={nWidth:d.width(),nHeight:d.height()},this._oHorizontal={elScrollBar:jindo.$$.getSingle("."+b+"h",a)};var e=this._oHorizontal;e.elScrollBar&&(e.elTrack=jindo.$$.getSingle("."+b+"track",e.elScrollBar),e.elThumb=jindo.$$.getSingle("."+b+"thumb",e.elTrack),e.elThumbHead=jindo.$$.getSingle("."+b+"thumb-head",e.elThumb),e.elThumbBody=jindo.$$.getSingle("."+b+"thumb-body",e.elThumb),e.elThumbFoot=jindo.$$.getSingle("."+b+"thumb-foot",e.elThumb),e.elButtonLeft=jindo.$$.getSingle("."+b+"button-left",e.elScrollBar),e.elButtonRight=jindo.$$.getSingle("."+b+"button-right",e.elScrollBar)),this._oVertical={elScrollBar:jindo.$$.getSingle("."+b+"v",a)};var f=this._oVertical;f.elScrollBar&&(f.elTrack=jindo.$$.getSingle("."+b+"track",f.elScrollBar),f.elThumb=jindo.$$.getSingle("."+b+"thumb",f.elTrack),f.elThumbHead=jindo.$$.getSingle("."+b+"thumb-head",f.elThumb),f.elThumbBody=jindo.$$.getSingle("."+b+"thumb-body",f.elThumb),f.elThumbFoot=jindo.$$.getSingle("."+b+"thumb-foot",f.elThumb),f.elButtonUp=jindo.$$.getSingle("."+b+"button-up",f.elScrollBar),f.elButtonDown=jindo.$$.getSingle("."+b+"button-down",f.elScrollBar))},getBox:function(){return this._elBox},getContent:function(){return this._elContent},getDefaultBoxSize:function(){return this._oBoxSize},getDefaultContentSize:function(){return this._oContentSize},getScrollBarHorizontal:function(){return this._oHorizontal},getScrollBarVertical:function(){return this._oVertical},getSliderHorizontal:function(){return this._oSliderHorizontal||null},getSliderVertical:function(){return this._oSliderVertical||null},getRolloverArea:function(){return this._oRolloverArea},_attachEvent:function(a){function b(a){if(a.elScrollBar){var b=f.option("sClassNameForRollover");jindo.$Element(a.elTrack).addClass(b),jindo.$Element(a.elThumb).addClass(b),a.elButtonLeft&&jindo.$Element(a.elButtonLeft).addClass(b),a.elButtonRight&&jindo.$Element(a.elButtonRight).addClass(b),a.elButtonUp&&jindo.$Element(a.elButtonUp).addClass(b),a.elButtonDown&&jindo.$Element(a.elButtonDown).addClass(b)}}function c(){f._bIsEventAttachedForHorizontal||b(g),f._bIsEventAttachedForHorizontal=!0}function d(){f._bIsEventAttachedForVertical||b(h),f._bIsEventAttachedForVertical=!0}var e=this.option("sClassPrefix"),f=this,g=this.getScrollBarHorizontal(),h=this.getScrollBarVertical();this._bIsEventAttachedForCommon||(this._initSliders(),this._initRolloverArea(),this._wfOnMouseEnter.attach(this._el,"mouseenter"),this._wfOnMouseLeave.attach(this._el,"mouseleave"),this._wfOnWheel.attach(document,"mousewheel"),this._wfOnMouseUp.attach(document,"mouseup"),this._bIsEventAttachedForCommon=!0,jindo.$Element(this._el).removeClass(e+"noscript")),a||(c(),d()),"horizontal"==a&&c(),"vertical"==a&&d()},_detachEvent:function(a){function b(a){if(a.elScrollBar){var b=f.option("sClassNameForRollover");jindo.$Element(a.elTrack).removeClass(b),jindo.$Element(a.elThumb).removeClass(b),a.elButtonLeft&&jindo.$Element(a.elButtonLeft).removeClass(b),a.elButtonRight&&jindo.$Element(a.elButtonRight).removeClass(b),a.elButtonUp&&jindo.$Element(a.elButtonUp).removeClass(b),a.elButtonDown&&jindo.$Element(a.elButtonDown).removeClass(b)}}function c(){f._bIsEventAttachedForHorizontal&&b(g),f._bIsEventAttachedForHorizontal=!1}function d(){f._bIsEventAttachedForVertical&&b(h),f._bIsEventAttachedForVertical=!1}var e=this.option("sClassPrefix"),f=this,g=this.getScrollBarHorizontal(),h=this.getScrollBarVertical();a?"horizontal"==a?c():"vertical"==a&&d():(c(),d()),!this._bIsEventAttachedForCommon||this._bIsEventAttachedForHorizontal||this._bIsEventAttachedForVertical||(this._wfOnMouseEnter.detach(this._el,"mouseenter"),this._wfOnMouseLeave.detach(this._el,"mouseleave"),this._wfOnWheel.detach(document,"mousewheel"),this._wfOnMouseUp.detach(document,"mouseup"),this._bMouseEnter=!1,this._bIsEventAttachedForCommon=!1,this.getRolloverArea().deactivate(),jindo.$Element(this._el).addClass(e+"noscript"))},_activateH:function(){var a=this.getSliderHorizontal();a&&(a.activate(),this.getBox().scrollLeft=0,this.setScrollLeft(0))},_activateV:function(){var a=this.getSliderVertical();a&&(a.activate(),this.getBox().scrollTop=0,this.setScrollTop(0))},_onActivate:function(a){return this._attachEvent(a||null),this._activate4Tablet(),a?"horizontal"==a?void this._activateH():"vertical"==a?void this._activateV():void 0:(this._activateH(),this._activateV(),void jindo.$Element(this._el).removeClass(this.option("sClassPrefix")+"noscript"))},_deactivateH:function(){var a=this.getSliderHorizontal();a&&(a.deactivate(),this.getContent().style.left="0px",this.getBox().scrollLeft=0)},_deactivateV:function(){var a=this.getSliderVertical();a&&(a.deactivate(),this.getContent().style.top="0px",this.getBox().scrollTop=0)},_onDeactivate:function(a){return this._detachEvent(a||null),this._deactivate4Tablet(),a?"horizontal"==a?void this._deactivateH():"vertical"==a?void this._deactivateV():void 0:(this._deactivateH(),this._deactivateV(),void jindo.$Element(this._el).addClass(this.option("sClassPrefix")+"noscript"))},_initSliders:function(){var a=this,b=this.option("sClassPrefix"),c=this.getScrollBarHorizontal(),d=this.getScrollBarVertical();c.elScrollBar&&(this._nScrollWidth=jindo.$Element(this._elContent).width()-jindo.$Element(this._elBox).width(),this._oSliderHorizontal=new jindo.Slider(c.elTrack,{sClassPrefix:b,bVertical:!1,nMinValue:0,nMaxValue:this._nScrollWidth}),this._oSliderHorizontal._oTransition=(new jindo.Transition).fps(30),this._oSliderHorizontal.attach({beforeChange:function(b){var c=jindo.$Element(this.getTrack()).width(),d=jindo.$Element(this.getThumb(b.nIndex)).width(),e=c-d;b.nPos=Math.min(b.nPos,e),b.nPos=Math.max(b.nPos,0),b.bJump?(b.stop(),this._oTransition.abort().start(200,this.getThumb(b.nIndex),{"@left":jindo.Effect.easeOut(b.nPos+"px")}).attach({playing:function(b){a.setScrollLeft(a._oSliderHorizontal._getValue(0,parseInt(b.sValue,10)))}})):a.setScrollLeft(this._getValue(0,b.nPos))}})),d.elScrollBar&&(this._nScrollHeight=jindo.$Element(this._elContent).height()-jindo.$Element(this._elBox).height(),this._oSliderVertical=new jindo.Slider(d.elTrack,{sClassPrefix:b,bVertical:!0,nMinValue:0,nMaxValue:this._nScrollHeight}),this._oSliderVertical._oTransition=(new jindo.Transition).fps(30),this._oSliderVertical.attach({beforeChange:function(b){var c=jindo.$Element(this.getTrack()).height(),d=jindo.$Element(this.getThumb(b.nIndex)).height(),e=c-d;b.nPos=Math.min(b.nPos,e),b.nPos=Math.max(b.nPos,0),b.bJump?(b.stop(),this._oTransition.abort().start(200,this.getThumb(b.nIndex),{"@top":jindo.Effect.easeOut(b.nPos+"px")}).attach({playing:function(){a.setScrollTop(a._oSliderVertical.values(0))}})):a.setScrollTop(this._getValue(0,b.nPos))}}))},_initRolloverArea:function(){var a=this,b=this.option("sClassPrefix"),c=this.option("sClassNameForRollover");this._oRolloverArea=new jindo.RolloverArea(this._el,{sClassName:c,sClassPrefix:b}).attach({over:function(b){b.stop(),a._onRollover("over",b.element)
},down:function(b){b.stop(),a._onMouseDown(b.element),a._onRollover("down",b.element)},up:function(b){b.stop(),a._onMouseUp(b.element),a._onRollover("up",b.element)},out:function(b){b.stop(),a._onRollover("out",b.element)}})},reset:function(){var a=this.getSliderHorizontal(),b=this.getSliderVertical();a&&(this._nScrollWidth=jindo.$Element(this._elContent).width()-jindo.$Element(this._elBox).width(),a.option("nMaxValue",this._nScrollWidth),this.setScrollLeft(0)),b&&(this._nScrollHeight=jindo.$Element(this._elContent).height()-jindo.$Element(this._elBox).height(),b.option("nMaxValue",this._nScrollHeight),this.setScrollTop(0)),this._elBox.scrollLeft=0,this._elBox.scrollTop=0},hasScrollBarHorizontal:function(){var a=this.option("sClassPrefix"),b=this.getScrollBarHorizontal();if(b.elScrollBar){var c=jindo.$Element(b.elScrollBar);return c.visible()||c.hasClass(a+"show")}return!1},hasScrollBarVertical:function(){var a=this.option("sClassPrefix"),b=this.getScrollBarVertical();if(b.elScrollBar){var c=jindo.$Element(b.elScrollBar);return c.visible()||c.hasClass(a+"show")}return!1},setScrollTop:function(a){a=Math.min(a,this._nScrollHeight||0),a=Math.max(a,0),a=Math.round(a);var b={sDirection:"top",nPosition:a};jindo.$Element(this._elContent).css("top",-1*b.nPosition+"px");var c=this.getSliderVertical();c&&c.values(0,b.nPosition,!1),this._fireScrollEvent(b)},setScrollLeft:function(a){a=Math.min(a,this._nScrollWidth||0),a=Math.max(a,0),a=Math.round(a);var b={sDirection:"left",nPosition:a};jindo.$Element(this._elContent).css("left",-1*b.nPosition+"px");var c=this.getSliderHorizontal();c&&c.values(0,b.nPosition,!1),this._fireScrollEvent(b)},setScrollTopBy:function(a){this.setScrollTop(this.getScrollTop()+a)},setScrollLeftBy:function(a){this.setScrollLeft(this.getScrollLeft()+a)},getScrollTop:function(){return-1*parseInt(jindo.$Element(this._elContent).css("top"),10)},getScrollLeft:function(){return-1*parseInt(jindo.$Element(this._elContent).css("left"),10)},_getElementType:function(a){var b=this.option("sClassPrefix");return a.hasClass(b+"track")?"track":a.hasClass(b+"thumb")?"thumb":a.hasClass(b+"button-up")?"button-up":a.hasClass(b+"button-up")?"button-up":a.hasClass(b+"button-down")?"button-down":a.hasClass(b+"button-left")?"button-left":a.hasClass(b+"button-right")?"button-right":!1},_fireScrollEvent:function(a){this._oOldPos[a.sDirection]!==a.nPosition&&(this._oOldPos[a.sDirection]=a.nPosition,this.fireEvent("scroll",a))},_onWheel:function(a){if(this._bMouseEnter){a.stop(jindo.$Event.CANCEL_DEFAULT);var b=a.mouse().delta,c=0===b?0:b/Math.abs(b)*-1,d=Math.ceil(Math.abs(b))*c*this.option("nDelta"),e=this.hasScrollBarHorizontal(),f=this.hasScrollBarVertical();if(e||f)return this.hasScrollBarVertical()&&this._bIsEventAttachedForVertical?void this.setScrollTop(this.getScrollTop()+d):void this.setScrollLeft(this.getScrollLeft()+d)}},_onMouseDown:function(a){var b,c=jindo.$Element(a),d=this,e=this._getElementType(c);switch(e){case"button-up":b=function(a){d.setScrollTopBy(~~(-1*a))};break;case"button-down":b=function(a){d.setScrollTopBy(a)};break;case"button-left":b=function(a){d.setScrollLeftBy(~~(-1*a))};break;case"button-right":b=function(a){d.setScrollLeftBy(a)};break;default:return}b(16),this._oTimer.start(function(){return b(16),!0},100)},_onMouseUp:function(){this._oTimer.abort()},_onMouseEnter:function(){this._bMouseEnter=!0},_onMouseLeave:function(){this._bMouseEnter=!1},_onRollover:function(a,b){var c=jindo.$Element(b),d=this.option("sClassPrefix"),e=this._getElementType(c);switch(a){case"over":c.addClass(d+e+"-over");break;case"down":c.addClass(d+e+"-hold");break;case"up":c.removeClass(d+e+"-hold");break;case"out":c.removeClass(d+e+"-over")}},_initialize4Tablet:function(){this._fpOnTouchDragStart=jindo.$Fn(function(a){this._oPos4Tablet=a.pos()},this),this._fpOnTouchDragMove=jindo.$Fn(function(a){if(this._oPos4Tablet){var b=this._oPos4Tablet,c=a.pos();this.setScrollLeftBy(b.pageX-c.pageX),this.setScrollTopBy(b.pageY-c.pageY),this._oPos4Tablet=c,a.stopDefault()}},this),this._fpOnTouchDragEnd=jindo.$Fn(function(){this._oPos4Tablet=null},this)},_activate4Tablet:function(){var a=this._elContent;jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(this._el).preventTapHighlight(!0),this._fpOnTouchDragStart.attach(a,"touchstart"),this._fpOnTouchDragMove.attach(a,"touchmove"),this._fpOnTouchDragEnd.attach(a,"touchend")},_deactivate4Tablet:function(){var a=this._elContent;jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(this._el).preventTapHighlight(!1),this._fpOnTouchDragStart.detach(a,"touchstart"),this._fpOnTouchDragMove.detach(a,"touchmove"),this._fpOnTouchDragEnd.detach(a,"touchend")}}).extend(jindo.UIComponent),jindo.SelectArea=jindo.$Class({_waToggleCandidate:null,_waSelected:null,_aSizeInfo:null,$init:function(a,b){this._el=jindo.$(a),this._wel=jindo.$Element(this._el);var c={bActivateOnload:!0,sClassName:"selectable",htStatus:{sSelected:"selected"},bMultiSelection:!0,bDragSelect:!0,nThreshold:5,bDeselectAllOutside:!0,bRemainOne:!1,bToggleSelected:!1};this.option(c),this.option(b||{}),this._waToggleCandidate=jindo.$A([]),this._waSelected=jindo.$A([]),this._sCtrl=jindo.$Agent().os().mac?"meta":"ctrl",this._welRectIndicator=null,this._wfDragStart=jindo.$Fn(this._onDragSelectStart,this),this._wfSelectStart=jindo.$Fn(this._onDragSelectStart,this),this._wfMouseDown=jindo.$Fn(this._onMouseDown,this),this._wfMouseMove=jindo.$Fn(this._onMouseMove,this),this._wfMouseUp=jindo.$Fn(this._onMouseUp,this),this._wfMouseUpWithinSelected=jindo.$Fn(this._onMouseUpWithinSelected,this),this._wfCompute=jindo.$Fn(this._computeSizeAndPos,this),this.option("bActivateOnload")&&this.activate()},getSelectableElement:function(){return jindo.$$("."+this.option("sClassName"),this._el)},isSelectable:function(a){return jindo.$Element(a).isChildOf(this._el)&&jindo.$$.test(a,"."+this.option("sClassName"))},getIndex:function(a){return jindo.$A(this.getSelectableElement()).indexOf(a)},select:function(a,b,c){a=this._convertArray(a),"undefined"==typeof b&&(b=!1),"undefined"==typeof c&&(c=!0),b&&this.option("bMultiSelection")||this.deselectAll(!1);for(var d=this._convertArray(this.getSelected()).concat(),e=this.option("htStatus"),f=0;f<a.length;f++){var g=a[f],h=jindo.$Element(g),i={elSelectable:g,nIndex:this.getIndex(g),bSelectedAgain:1===a.length&&this._vLastSelected===a[0]};this.isSelectable(g)&&!this.isSelected(g)&&this.fireEvent("beforeSelect",i)&&(i={elSelectable:g,nIndex:this.getIndex(g),bSelectedAgain:1===a.length&&this._vLastSelected===a[0]},h.addClass(e.sSelected),this._waSelected.push(g),this.fireEvent("select",i))}return c&&this._fireChangeEvent(d),this},deselect:function(a,b){a=this._convertArray(a),"undefined"==typeof b&&(b=!0);for(var c=this._convertArray(this.getSelected()).concat(),d=this.option("htStatus"),e=0;e<a.length;e++){var f=a[e],g=jindo.$Element(f),h={elSelectable:f,nIndex:this.getIndex(f)};this.isSelectable(f)&&this.isSelected(f)&&this.fireEvent("beforeDeselect",h)&&(g.removeClass(d.sSelected),this._waSelected=this._waSelected.refuse(f),this.fireEvent("deselect",h))}return b&&this._fireChangeEvent(c),this},deselectAll:function(a){return"undefined"==typeof a&&(a=!0),this.deselect(this.getSelected(),a),this},toggle:function(a,b){a=this._convertArray(a),"undefined"==typeof b&&(b=!0);for(var c=0;c<a.length;c++){var d=a[c];this.isSelected(d)?this.deselect(d,b):this.select(d,!0,b)}return this},getSelected:function(){return this._waSelected.length()>0?1===this._waSelected.length()?this._waSelected.get(0):this._waSelected.$value():null},isSelected:function(a){return this._waSelected.has(a)},_getSelectableUntil:function(a){var b=a,c=this._elStartPoint;if(c&&this.isSelected(c)){var d=jindo.$A(this.getSelectableElement()),e=d.indexOf(c),f=d.indexOf(a);b=d.slice(Math.min(e,f),Math.min(e,f)+Math.abs(e-f)+1).$value()}return b},_findSelectableElement:function(a){var b=this.option("sClassName");return jindo.$$.test(a,"."+b)?a:jindo.$$.getSingle("! ."+b,a)},_isChanged:function(a){var b=jindo.$A(a),c=this._convertArray(this.getSelected());if(a.length!=c.length)return!0;for(var d=0;d<c.length;d++)if(!b.has(c[d]))return!0;return!1},_fireChangeEvent:function(a){this._isChanged(a)&&this.fireEvent("change")},_convertArray:function(a){return a instanceof Array||(a=a?[a]:[]),a},_onMouseDown:function(a){var b=a.key(),c=a.mouse(!0);if(!c.scrollbar){var d=this._findSelectableElement(a.element),e=this._convertArray(this.getSelected()).concat();if(this._vLastSelected=this.getSelected(),this._waSelectable=jindo.$A(this.getSelectableElement()),this._waLastSelected=jindo.$A(this._convertArray(this._vLastSelected)),d){var f=jindo.$A(this._convertArray(this._vLastSelected)).has(d);if(this.fireEvent("selectStart",{vLastSelected:this._vLastSelected,elSelectable:d,bWithinSelected:f,weEvent:a}))if(!f||b.shift||b[this._sCtrl]){var g=!1;if(this.option("bMultiSelection"))if(b.shift){b[this._sCtrl]&&(g=!0);var h=this._getSelectableUntil(d);h==d&&(this._elStartPoint=d),this.select(h,g,!1)}else this._elStartPoint=d,b[this._sCtrl]?this.toggle(d,!1):this.select(d,g,!1);else!this.option("bRemainOne")&&this.option("bToggleSelected")&&this.getSelected()==d?this.deselect(d,!1):this.select(d,g,!1);this._fireChangeEvent(e),this.fireEvent("selectEnd",{vSelected:this.getSelected()})}else this._elWaitMouseUp=d,this._wfMouseUpWithinSelected.attach(this._elWaitMouseUp,"mouseup")}else this._wfMouseUp.attach(document,"mouseup"),this._wfCompute.attach(window,"resize").attach(this._el,"scroll"),this.option("bMultiSelection")&&this.option("bDragSelect")&&(this._bOverThreshold=null,this._htDragStartPos=a.pos(!0),this._htDragStartPos.scrollTop=this._el.scrollTop,this._htDragStartPos.scrollLeft=this._el.scrollLeft,this._wfMouseMove.attach(document,"mousemove"))}},_onDragSelectStart:function(a){a.stop(jindo.$Event.CANCEL_DEFAULT)},_getRectangleElement:function(){return!this._welRectIndicator&&this.option("bMultiSelection")&&this.option("bDragSelect")&&(this._welRectIndicator=jindo.$Element(jindo.$('<div style="position:absolute;left:-10px;top:-10px;width:1px;height:1px;margin:0;padding:0;border:1px dotted black;z-index:99999;">')),this._welRectIndicator.appendTo(this._el)),this._welRectIndicator},getRectangleElement:function(){return this._getRectangleElement().$value()},_computeSizeAndPos:function(){var a=this._aSizeInfo=[];jindo.$A(this.getSelectableElement()).forEach(function(b){a.push([b,b.offsetLeft,b.offsetTop,b.offsetLeft+b.offsetWidth,b.offsetTop+b.offsetHeight])})},_onMouseMove:function(a){this._htDragEndPos=a.pos();var b=this._getRectangleElement(),c=b.$value(),d=this._htDragEndPos.pageX-this._htDragStartPos.pageX,e=this._htDragEndPos.pageY-this._htDragStartPos.pageY,f=this._htDragStartPos.layerX||this._htDragStartPos.offsetX||0,g=this._htDragStartPos.layerY||this._htDragStartPos.offsetY||0,h=this.option("nThreshold");if(h&&!this._bOverThreshold){var i=Math.sqrt(d*d+e*e);if(h>i)return;this.fireEvent("dragStart"),this._bOverThreshold=!0,this._computeSizeAndPos(),this._nRectX=f,this._nRectY=g,this._nDragDirectionX=1,this._nDragDirectionY=1,b.offset(g,f),a.key()[this._sCtrl]||this.deselectAll(!1)}var j=d,k=e;this._placeRect(f,g,j,k),this._setToggleCandidate(this._getSelectableByRect([c,c.offsetLeft,c.offsetTop,c.offsetLeft+c.offsetWidth,c.offsetTop+c.offsetHeight]))},_placeRect:function(a,b,c,d){var e=this._getRectangleElement();e.show(),this._nDragDirectionX=a>this._nRectX?1:-1,this._nDragDirectionY=b>this._nRectY?1:-1,c-=(this._el.scrollLeft-this._htDragStartPos.scrollLeft)*this._nDragDirectionX,d-=(this._el.scrollTop-this._htDragStartPos.scrollTop)*this._nDragDirectionY,e.width(Math.max(Math.abs(c),2)).height(Math.max(Math.abs(d),2)),a+=Math.min(c,0),b+=Math.min(d,0),e.css("left",a+"px").css("top",b+"px")},_getSelectableByRect:function(a){var b=[];return jindo.$A(this._aSizeInfo).forEach(function(c){c[1]<a[3]&&c[3]>a[1]&&c[2]<a[4]&&c[4]>a[2]&&(b.push(c[0]),jindo.$A.Continue())}),b},_setToggleCandidate:function(a){a=this._convertArray(a);var b=!1;this._waToggleCandidate.length()!=a.length&&(b=!0);var c=this.option("htStatus"),d=jindo.$A(a),e=jindo.$A([]);this._waToggleCandidate.forEach(function(a){d.has(a)||(e.push(a),b=!0)}),b&&(e.forEach(function(a){this._waToggleCandidate=this._waToggleCandidate.refuse(a),jindo.$Element(a).toggleClass(c.sSelected)},this),d.forEach(function(a){this.isSelected(a)?jindo.$Element(a).removeClass(c.sSelected):jindo.$Element(a).addClass(c.sSelected)},this),this._waToggleCandidate=jindo.$A(this._waToggleCandidate.$value().concat(a)).unique(),this.fireEvent("dragSelecting",{aSelectable:this._waToggleCandidate.$value()}))},_onMouseUp:function(a){var b=!this.isDragging()&&!a.key()[this._sCtrl]&&!this.option("bRemainOne")&&this.option("bDeselectAllOutside"),c=this._waToggleCandidate.length(),d=this._convertArray(this.getSelected()).concat();b&&this.deselectAll(!1),c&&(this._elStartPoint=this._waToggleCandidate.$value()[0],this.toggle(this._waToggleCandidate.$value())),this._fireChangeEvent(d),this._stopDragging()},stopSelecting:function(){return this._wfMouseUpWithinSelected.detach(this._elWaitMouseUp,"mouseup"),this},isDragging:function(){return this._bOverThreshold},_restore:function(){jindo.$ElementList(this._waToggleCandidate.$value()).removeClass(this.option("htStatus").sSelected),this.deselectAll(!1),this._waLastSelected.$value().length&&this.select(this._waLastSelected.$value(),!1,!1)},_stopDragging:function(){this._waToggleCandidate.empty(),this._htDragStartPos=null,this._htDragEndPos=null,this._wfMouseMove.detach(document,"mousemove"),this._wfMouseUp.detach(document,"mouseup"),this._wfCompute.detach(window,"resize").detach(this._el,"scroll"),this.isDragging()&&(this._bOverThreshold=null,this._getRectangleElement().hide(),this.fireEvent("dragEnd"))},stopDragging:function(){return this.isDragging()&&(this._restore(),this._stopDragging()),this},_onMouseUpWithinSelected:function(a){this.stopSelecting();var b=this._findSelectableElement(a.element);b&&b==a.currentElement&&(this.deselectAll(!1),this.select(b,!1,!0))},_onActivate:function(){this._sMozUserSelect=this._wel.css("MozUserSelect"),this._wel.css("MozUserSelect","none"),jindo.$Element.prototype.preventTapHighlight&&this._wel.preventTapHighlight(!0),this._wfMouseDown.attach(this._el,"mousedown"),this._wfDragStart.attach(this._el,"dragstart"),this._wfSelectStart.attach(this._el,"selectstart")},_onDeactivate:function(){this._wel.css("MozUserSelect",this._sMozUserSelect||""),jindo.$Element.prototype.preventTapHighlight&&this._wel.preventTapHighlight(!1),this._wfMouseDown.detach(this._el,"mousedown"),this._wfDragStart.detach(this._el,"dragstart"),this._wfSelectStart.detach(this._el,"selectstart")}}).extend(jindo.UIComponent),jindo.SelectBox=jindo.$Class({sTagName:"select",_bDisabled:!1,_sPrevValue:null,_nSelectedIndex:0,$init:function(a,b){this._aItemData=[],this._aListItem=[],this._aOptions=[],this.option({sClassPrefix:"selectbox-",nWidth:null,nHeight:null,bUseLayerPosition:!0,aOptionHTML:[],aOptionLabel:[],LayerPosition:{sPosition:"outside-bottom",sAlign:"left",nTop:0,nLeft:0},LayerManager:{sCheckEvent:"mousedown",nShowDelay:20,nHideDelay:0}}),this.option(b||{}),this._el=jindo.$(a),this._assignHTMLElements(),this.option("bUseLayerPosition")&&this._initLayerPosition(),this._initLayerManager(),this._initRolloverClick(),this._oTimer=new jindo.Timer,this._wfOnFocusSelect=jindo.$Fn(this._onFocusSelect,this),this._wfOnBlurSelect=jindo.$Fn(this._onBlurSelect,this),this._wfOnMouseDownBox=jindo.$Fn(this._onMouseDownBox,this),this._wfOnMouseDownList=jindo.$Fn(this._onMouseDownList,this),this._wfOnKeyDown=jindo.$Fn(this._onKeyDown,this),this._wfOnMouseWheel=jindo.$Fn(function(a){a.stop(jindo.$Event.CANCEL_DEFAULT),this._elLayer.scrollTop-=16*a.mouse().delta},this);var c=this;this._wfOnMouseWheelOnBody=jindo.$Fn(function(){c.option("bUseLayerPosition")&&setTimeout(function(){c.getLayerPosition().setPosition()},0)},this),this._oAgent=jindo.$Agent(),this.activate()},_assignHTMLElements:function(){var a=this.option("sClassPrefix"),b=this._el;this._wel=jindo.$Element(b),this._elSelect=jindo.$$.getSingle("select."+a+"source",b),this._sSelectInnerHTML=this._elSelect.innerHTML,this._elOptionDefault=jindo.$$.getSingle("option."+a+"default",b),this._elSelectOptionGroup=jindo.$$.getSingle("select."+a+"source-option-group",b),this._elBox=jindo.$$.getSingle("."+a+"box",b),this._elLabel=jindo.$$.getSingle("."+a+"label",b),this._elLayer=jindo.$$.getSingle("."+a+"layer",b),this._elList=jindo.$$.getSingle("."+a+"list",b),this._elList.innerHTML="",this._elSelectList=jindo.$("<ul>"),this._elList.insertBefore(this._elSelectList,this._elList.firstChild)},getSelectElement:function(){return this._elSelect},getBoxElement:function(){return this._elBox},getLabelElement:function(){return this._elLabel},getLayerElement:function(){return this._elLayer},getListElement:function(){return this._elList},getSelectListElement:function(){return this._elSelectList},_limitWidth:function(){var a=this.option("nWidth");a&&(jindo.$Element(this.getBoxElement()).css({width:a+"px",overflowX:"hidden"}),jindo.$Element(this.getLayerElement()).css({width:a+"px",overflowX:"hidden",overflowY:"auto"}))},_limitHeight:function(){var a=this.option("nHeight");if(a){var b,c=jindo.$Element(this.getLayerElement()),d=c.$value().cloneNode(!0),e=jindo.$Element(d);e.opacity(0),c.after(e),e.show(),b=e.height(),e.leave(),b>a&&c.css({height:a+"px",overflowX:"hidden",overflowY:"auto"})}},_initLayerManager:function(){var a=this,b=this.option("sClassPrefix"),c=this.getSelectElement();this._oLayerManager=new jindo.LayerManager(this.getLayerElement(),this.option("LayerManager")).attach({beforeShow:function(d){a.fireEvent("open")?(a._limitWidth(),a._limitHeight(),setTimeout(function(){try{c.focus()}catch(a){}},10),a._wel.addClass(b+"open"),a.option("bUseLayerPosition")&&a.getLayerPosition().setPosition()):d.stop()},show:function(){a._paintSelected()},beforeHide:function(c){a.fireEvent("close")?a._wel.removeClass(b+"open"):c.stop()}}).link(this.getBoxElement()).link(this.getLayerElement())},getLayerManager:function(){return this._oLayerManager},_initRolloverClick:function(){var a=this,b=this.option("sClassPrefix");this._oRolloverClick=new jindo.RolloverClick(this.getSelectListElement(),{sCheckEvent:"mouseup",RolloverArea:{sClassName:b+"item",sClassPrefix:b+"item-"}}).attach({over:function(c){a._welOvered&&a._welOvered.removeClass(b+"item-over");var d=jindo.$Element(c.element);d.addClass(b+"item-over"),a._welOvered=d},out:function(a){a.stop()},click:function(c){var d=a._nSelectedIndex,e=-1;jindo.$A(a._aItemData).forEach(function(a,b){a.elItem===c.element&&(e=b,jindo.$A.Break())}),a.fireEvent("click",{nIndex:e,weEvent:c.weEvent})&&(-1!==e&&a.setValue(a._aItemData[e].sValue),e=a.getSelectedIndex(),e!=d&&(jindo.$Element(a.getSelectElement()).fireEvent("change"),a.fireEvent("change",{nIndex:e,nLastIndex:d})),jindo.$Element(c.element).hasClass(b+"notclose")||a.getLayerManager().hide())}})},getRolloverClick:function(){return this._oRolloverClick},_initLayerPosition:function(){this._oLayerPosition=new jindo.LayerPosition(this.getBoxElement(),this.getLayerElement(),this.option("LayerPosition"))},getLayerPosition:function(){return this._oLayerPosition},_onActivate:function(){jindo.HTMLComponent.prototype._onActivate.apply(this);var a=this.option("sClassPrefix"),b=this.getSelectElement();this._limitWidth(),this._wel.removeClass(a+"noscript"),jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(this.getListElement()).preventTapHighlight(!0),this._wfOnFocusSelect.attach(b,"focus"),this._wfOnBlurSelect.attach(b,"blur"),this._wfOnMouseDownBox.attach(this.getBoxElement(),"mousedown"),this._wfOnMouseDownList.attach(this.getListElement(),"mousedown"),this._wfOnKeyDown.attach(b,"keydown"),this._wfOnMouseWheel.attach(b,"mousewheel"),this._wfOnMouseWheelOnBody.attach(document,"mousewheel"),this.paint(),this._sPrevValue=this.getValue()},_onDeactivate:function(){this.getLayerManager().hide();var a=this.option("sClassPrefix"),b=this.getSelectElement();this._wel.addClass(a+"noscript"),jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(this.getListElement()).preventTapHighlight(!1),this._wfOnFocusSelect.detach(b,"focus"),this._wfOnBlurSelect.detach(b,"blur"),this._wfOnMouseDownBox.detach(this.getBoxElement(),"mousedown"),this._wfOnMouseDownList.detach(this.getListElement(),"mousedown"),this._wfOnKeyDown.detach(b,"keydown"),this._wfOnMouseWheel.detach(b,"mousewheel"),this._wfOnMouseWheelOnBody.detach(document,"mousewheel"),jindo.HTMLComponent.prototype._onDeactivate.apply(this)},getValueOf:function(a){for(var b,c=0;b=this._aItemData[c];c++)if(b.sText==a)return b.sValue;return null},getValue:function(){var a=this.getSelectElement();return-1===a.selectedIndex?"":a.options[a.selectedIndex].value},getText:function(){var a=this._aItemData[this._nSelectedIndex];return a&&a.sText||""},getHTML:function(){return this.getLabelElement().innerHTML},setValue:function(a){this.getSelectElement().value=a,this._sPrevValue=this.getValue(),this._paint()},getSelectedIndex:function(){return this.getSelectElement().selectedIndex},setSelectedIndex:function(a,b){if("undefined"==typeof b&&(b=!0),this._isSelectable(a)){var c=this.getSelectedIndex();return this._setSelectedIndex(a),this._paint(),b&&c!=a&&this.fireEvent("change",{nIndex:a,nLastIndex:c}),!0}return!1},_setSelectedIndex:function(a){this.getSelectElement().selectedIndex=a},_isSelectable:function(a){var b=this._aItemData[a];return!b||b.bDisabled||b.bDefault?!1:!0},getOptions:function(){return this._aOptions},getListItems:function(){return this._aListItem},getDisabled:function(){return this._bDisabled},setOptionGroup:function(a){if(!this._elSelectOptionGroup||!this._elOptionDefault)return!1;var b=this.getSelectElement(),c=this.option("sClassPrefix"),d=jindo.$$("."+c+"option-group-"+a,this._elSelectOptionGroup),e=this._elOptionDefault=this._elOptionDefault.cloneNode(!0);b.innerHTML="",b.appendChild(e),this._nSelectedIndex=0;for(var f=0;f<d.length;f++)b.appendChild(d[f].cloneNode(!0));return this._sPrevValue=this.getValue(),this.paint(),!0},isSelected:function(){return!this._aItemData[this.getSelectedIndex()].bDefault},setDefault:function(){var a=-1;jindo.$A(this._aItemData).forEach(function(b,c){(b.bDefault||b.bSelected)&&(a=c)}),0>a&&(a=0),this._nSelectedIndex=a,this._setSelectedIndex(a),this._sPrevValue=this.getValue(),this._paint()},paint:function(){this._paintList(),this._paintSelected(),this._paintLabel(),this.getLayerManager().setLayer(this.getLayerElement())},_paint:function(){this._paintSelected(),this._paintLabel()},_paintLabel:function(){var a=jindo.$Element(this.getLabelElement()),b=this.option("aOptionHTML")[this._nSelectedIndex]||"",c=this.option("aOptionLabel")[this._nSelectedIndex]||"",d=this.getText();b?a.html(c?c:b):a.text(d),a.attr("unselectable","on")},_paintList:function(){var a=this.option("sClassPrefix");this._aOptions=jindo.$$("option",this.getSelectElement());var b=this._aOptions;this._aItemData=[],this._aListItem=[],this._nSelectedIndex=0;var c=this.getSelectListElement();c.innerHTML="",this.option("nHeight")&&jindo.$Element(this.getLayerElement()).css("height","auto");for(var d,e=[],f=[],g=0;d=b[g];g++){var h=jindo.$Element(d),i=h.hasClass(a+"default"),j="selected"==h.attr("selected"),k=i||d.disabled,l=this.option("aOptionHTML")[g]||"",m=h.text()||"",n=h.attr("value");n||(h.attr("value",m),n=m),this._aItemData[g]={elOption:d,elItem:null,sHTML:l,sText:m,sValue:n,bDisabled:k,bSelected:j,bDefault:i};var o=this._aItemData[g];o.bDefault||(e.push(['<li style="',o.elOption.style.cssText,'" ','class="',o.elOption.className," ",a+(o.bDisabled?"item-disabled":"item"),'" unselectable="on">',o.sHTML||jindo.$S(o.sText).escapeHTML(),"</li>"].join("")),f.push(g))}c.innerHTML=e.join("");for(var p,q=c.childNodes,r=0;p=q[r];r++)this._aListItem.push(p),this._aItemData[f[r]].elItem=p;return jindo.$Element(this.getLayerElement()).visible()&&(this._limitWidth(),this._limitHeight()),this._elSelect.disabled?void this.disable():void this.enable()},_paintSelected:function(){var a,b=this.option("sClassPrefix"),c=this.getSelectedIndex(),d=this._nSelectedIndex;if(this._welSelected&&(this._welSelected.removeClass(b+"item-selected"),this._welSelected=null),this._welOvered&&(this._welOvered.removeClass(b+"item-over"),this._welOvered=null),c=Math.min(c,this._aItemData.length-1),this._nSelectedIndex=c,a=this._aItemData[c],a&&a.elItem){var e=a.elItem,f=jindo.$Element(e);if(this._welSelected=this._welOvered=f,f.addClass(b+"item-selected").addClass(b+"item-over"),this.isLayerOpened()){var g,h=this.getLayerElement(),i=parseInt(jindo.$Element(h).css("height"),10),j=e.offsetTop,k=e.offsetHeight,l=h.scrollTop;g=c>d?!0:!1,(l>j||j>l+i)&&(h.scrollTop=j),g?j+k>i+l&&(h.scrollTop=j+k-i):l>j&&(h.scrollTop=j)}}},isLayerOpened:function(){return this.getLayerManager().getVisible()},disable:function(){this.getLayerManager().hide();var a=this.option("sClassPrefix");this._wel.addClass(a+"disabled"),this.getSelectElement().disabled=!0,this._bDisabled=!0},enable:function(){var a=this.option("sClassPrefix");this._wel.removeClass(a+"disabled"),this.getSelectElement().disabled=!1,this._bDisabled=!1},open:function(){return this._bDisabled||this.getLayerManager().show(),this},close:function(){return this.getLayerManager().hide(),this},_onMouseDownBox:function(a){a.stop(jindo.$Event.CANCEL_DEFAULT),this._bDisabled||this.getLayerManager().toggle()},_onMouseDownList:function(a){jindo.$$.getSingle("! ."+this.option("sClassPrefix")+"notclose",a.element)||a.stop(jindo.$Event.CANCEL_DEFAULT)},_getSelectableIndex:function(a,b){var c,d=-1,e=this._aItemData.length-1;for(c=0;c<this._aItemData.length;c++)this._isSelectable(c)&&(0>d?d=c:e=c);switch(b){case-1:if(a==d)return a;for(c=a-1;c>d;c--)if(this._isSelectable(c))return c;return d;case 1:if(a==e)return a;for(c=a+1;e>c;c++)if(this._isSelectable(c))return c;return e;case 1/0:return e;case-1/0:return d}},_onKeyDown:function(a){var b=a.key();if(this._oAgent.os().mac&&this._oAgent.navigator().safari||this._oAgent.navigator().ie&&6==this._oAgent.navigator().version){var c=b.keyCode;9!=c&&a.stop(jindo.$Event.CANCEL_DEFAULT);var d=this.getSelectedIndex(),e=d;switch(c){case 37:e=this._getSelectableIndex(d,-1);break;case 38:e=this._getSelectableIndex(d,-1);break;case 39:e=this._getSelectableIndex(d,1);break;case 40:e=this._getSelectableIndex(d,1);break;case 33:e=this._getSelectableIndex(d,-1/0);break;case 34:e=this._getSelectableIndex(d,1/0);break;case 13:this.getLayerManager().hide();break;case 9:this.getLayerManager().hide()}var f={nIndex:e,nLastIndex:parseInt(this._nSelectedIndex,10)};this._setSelectedIndex(e),this._paint(),f.nIndex!=f.nLastIndex&&this.fireEvent("change",f)}else this.isLayerOpened()&&(b.enter||9==b.keyCode)&&this.getLayerManager().hide()},_restoreLeftTimer:null,_onFocusSelect:function(){var a=this.option("sClassPrefix"),b=this._wel,c=this.getSelectElement(),d=this;if(!this._restoreLeftTimer){var e=c.style.left||"";c.style.left="auto",this._restoreLeftTimer=setTimeout(function(){c.style.left=e,d._restoreLeftTimer=null},0)}return this.isLayerOpened()||this.fireEvent("focus")?(b.addClass(a+"focused"),void(this._oAgent.os().mac&&this._oAgent.navigator().safari||this._oTimer.start(function(){var a=d.getValue();if(d._sPrevValue&&d._sPrevValue!=a){var b=d.getSelectElement().selectedIndex;if(!d._isSelectable(b)){var c=-(d._nSelectedIndex-b);return c=c>0?1:-1,d._setSelectedIndex(d._getSelectableIndex(d._nSelectedIndex,c,b)),!0}var e={nIndex:b,nLastIndex:parseInt(d._nSelectedIndex,10)};d._paint(),e.nIndex!=e.nLastIndex&&d.fireEvent("change",e),d._sPrevValue=a}return!0},10))):void this.getSelectElement().blur()},_onBlurSelect:function(){var a=this,b=this.option("sClassPrefix");this.fireEvent("blur"),this._wel.removeClass(b+"focused"),setTimeout(function(){a._oTimer.abort()},10)}}).extend(jindo.HTMLComponent),jindo.ScrollBox=new jindo.$Class({$init:function(a,b){this.option({sClassPrefix:"scrollbar-",bActivateOnload:!0,sOverflowX:"auto",sOverflowY:"auto",bAdjustThumbSize:!0,nMinThumbSize:50,nDelta:16}),this.option(b||{}),this._el=jindo.$(a),this.option("bActivateOnload")&&(this.activate(),this.reset())},reset:function(){this._autoToggleScrollBar();var a=this.hasScrollBarHorizontal(),b=this.hasScrollBarVertical();this._adjustBoxSize(),this._adjustContentSize(),this._autoToggleScrollBar(),(a!=this.hasScrollBarHorizontal()||b!=this.hasScrollBarVertical())&&(this._adjustBoxSize(),this._adjustContentSize()),this._autoToggleAvailability(),this._adjustTrackSize(),this._adjustThumbSize(),this.$super.reset()},_onActivate:function(){this.$super._onActivate(),this.reset()},_onDeactivate:function(){this.$super._onDeactivate(),this._adjustBoxSize()},setSize:function(a,b){a&&jindo.$Element(this._el).css("width",a+"px"),b&&jindo.$Element(this._el).css("height",b+"px"),this.setBoxSize(a,b),this._oBoxSize={nWidth:jindo.$Element(this._elBox).width(),nHeight:jindo.$Element(this._elBox).height()},this.reset()},getContentSize:function(){var a=jindo.$Element(this._elContent);return{nWidth:parseInt(a.width(),10),nHeight:parseInt(a.height(),10)}},setContentSize:function(a,b){var c=jindo.$Element(this._elContent);a&&(1/0==a?c.css("width",""):c.css("width",a+"px")),b&&(1/0==b?c.css("height","auto"):c.css("height",b+"px")),this.$super.reset()},getBoxSize:function(){var a=jindo.$Element(this._elBox);return{nWidth:parseInt(a.width(),10),nHeight:parseInt(a.height(),10)}},setBoxSize:function(a,b){var c=jindo.$Element(this._elBox);a&&c.css("width",a+"px"),b&&c.css("height",b+"px"),this.$super.reset()},getTrackSize:function(a){if(!a.elScrollBar)return{nWidth:0,nHeight:0};var b=jindo.$Element(a.elTrack);return{nWidth:parseInt(b.width(),10),nHeight:parseInt(b.height(),10)}},setTrackSize:function(a,b,c){var d=jindo.$Element(a.elTrack);b&&d.css("width",b+"px"),c&&d.css("height",c+"px")},isNeededScrollBarHorizontal:function(){if("scroll"==this.option("sOverflowX"))return!0;var a=this.getContentSize(),b=this.getDefaultBoxSize();if(this.getScrollBarHorizontal().elScrollBar&&"hidden"!=this.option("sOverflowX")){if(this.hasScrollBarVertical()&&a.nWidth>b.nWidth-jindo.$Element(this.getScrollBarVertical().elScrollBar).width())return!0;if(a.nWidth>b.nWidth)return!0}return!1},isNeededScrollBarVertical:function(){if("scroll"==this.option("sOverflowY"))return!0;var a=this.getContentSize(),b=this.getDefaultBoxSize();if(this.getScrollBarVertical().elScrollBar&&"hidden"!=this.option("sOverflowY")){if(this.hasScrollBarHorizontal()&&a.nHeight>b.nHeight-jindo.$Element(this.getScrollBarHorizontal().elScrollBar).height())return!0;if(a.nHeight>b.nHeight)return!0}return!1},_autoToggleScrollBar:function(){if(this.isActivating()){var a,b=this.option("sClassPrefix"),c=this.getScrollBarHorizontal(),d=this.getScrollBarVertical(),e=this.option("bAdjustThumbSize"),f=this.isNeededScrollBarVertical();d.elScrollBar&&(a=jindo.$Element(d.elScrollBar),f?a.addClass(b+"show"):a.removeClass(b+"show"),d.elThumb&&e&&jindo.$Element(d.elThumb).css("height","0px"));var g=this.isNeededScrollBarHorizontal();c.elScrollBar&&(a=jindo.$Element(c.elScrollBar),g?a.addClass(b+"show"):a.removeClass(b+"show"),c.elThumb&&e&&jindo.$Element(c.elThumb).css("width","0px")),d.elScrollBar&&(a=jindo.$Element(d.elScrollBar),this.isNeededScrollBarVertical()?a.addClass(b+"show"):a.removeClass(b+"show"),d.elThumb&&e&&jindo.$Element(d.elThumb).css("height","0px"))}},_adjustTrackSize:function(){if(this.isActivating()){var a=this.getDefaultBoxSize(),b=this.getScrollBarHorizontal(),c=this.getScrollBarVertical(),d=this.isNeededScrollBarHorizontal();if(d&&b.elScrollBar){var e=a.nWidth,f=jindo.$Element(b.elScrollBar);f.css("top",a.nHeight-f.height()+"px");var g=0;this.hasScrollBarVertical()&&c.elScrollBar&&(g=parseInt(jindo.$Element(c.elScrollBar).width(),10),e-=g),f.width(e);var h=0;b.elButtonLeft&&(h=parseInt(jindo.$Element(b.elButtonLeft).width(),10),e-=h),b.elButtonRight&&(e-=parseInt(jindo.$Element(b.elButtonRight).width(),10)),jindo.$Element(b.elTrack).css("left",h+"px"),this.setTrackSize(b,e,null)
}var i=this.isNeededScrollBarVertical();if(i&&c.elScrollBar){var j=a.nHeight,k=0;this.hasScrollBarHorizontal()&&b.elScrollBar&&(k=parseInt(jindo.$Element(b.elScrollBar).height(),10),j-=k),c.elButtonUp&&(j-=parseInt(jindo.$Element(c.elButtonUp).height(),10)),c.elButtonDown&&(j-=parseInt(jindo.$Element(c.elButtonDown).height(),10)),this.setTrackSize(c,null,j)}}},_adjustBoxSize:function(){var a=this.getDefaultBoxSize(),b=this.getScrollBarHorizontal(),c=this.getScrollBarVertical(),d=this.hasScrollBarVertical(),e=this.hasScrollBarHorizontal();if(this.setBoxSize(a.nWidth,a.nHeight),this.isActivating()){if(e&&b.elScrollBar){var f=a.nHeight;f-=parseInt(jindo.$Element(b.elScrollBar).height(),10),this.setBoxSize(null,f)}if(d&&c.elScrollBar){var g=a.nWidth;g-=parseInt(jindo.$Element(c.elScrollBar).width(),10),this.setBoxSize(g,null)}}},_adjustContentSize:function(){if(this.isActivating()){var a,b,c=this.getBoxSize(),d="hidden"!=this.option("sOverflowY"),e="hidden"!=this.option("sOverflowX");d&&!e&&(a=c.nWidth),e&&!d&&(b=c.nHeight),this.setContentSize(a||1/0,b||1/0)}},_adjustThumbSize:function(){if(this.isActivating()&&this.option("bAdjustThumbSize")){var a=this.option("nMinThumbSize");"undefined"==typeof a&&(a=50);var b,c=this.getContentSize(),d=this.getBoxSize(),e=this.getScrollBarHorizontal(),f=this.getScrollBarVertical();if(f.elScrollBar){var g=this.getTrackSize(f),h=Math.floor(parseInt(g.nHeight*d.nHeight/c.nHeight,10));isNaN(h)&&(h=0),a>h&&(h=a),h>=g.nHeight&&(h=g.nHeight),jindo.$Element(f.elThumb).height(h),b=0,f.elThumbHead&&(b+=jindo.$Element(f.elThumbHead).height()),f.elThumbFoot&&(b+=jindo.$Element(f.elThumbFoot).height()),f.elThumbBody&&jindo.$Element(f.elThumbBody).height(h-b)}if(e.elScrollBar){var i=this.getTrackSize(e),j=Math.floor(parseInt(i.nWidth*d.nWidth/c.nWidth,10));isNaN(j)&&(j=0),a>j&&(j=a),j>=i.nWidth&&(j=i.nWidth),jindo.$Element(e.elThumb).width(j),b=0,e.elThumbHead&&(b+=jindo.$Element(e.elThumbHead).width()),e.elThumbFoot&&(b+=jindo.$Element(e.elThumbFoot).width()),e.elThumbBody&&jindo.$Element(e.elThumbBody).width(j-b)}}},_autoToggleAvailability:function(){var a=this.option("sClassPrefix"),b=this.getContentSize(),c=this.getBoxSize(),d=this.getScrollBarHorizontal(),e=this.getScrollBarVertical();d.elScrollBar&&("scroll"==this.option("sOverflowX")&&c.nWidth>=b.nWidth?(jindo.$Element(d.elScrollBar).addClass(a+"disabled"),this.$super._onDeactivate("horizontal"),this.isActivating()&&jindo.$Element(this._el).removeClass(a+"noscript")):(jindo.$Element(d.elScrollBar).removeClass(a+"disabled"),this.isActivating()&&this.$super._onActivate("horizontal"))),e.elScrollBar&&("scroll"==this.option("sOverflowY")&&c.nHeight>=b.nHeight?(jindo.$Element(e.elScrollBar).addClass(a+"disabled"),this.$super._onDeactivate("vertical"),this.isActivating()&&jindo.$Element(this._el).removeClass(a+"noscript")):(jindo.$Element(e.elScrollBar).removeClass(a+"disabled"),this.isActivating()&&this.$super._onActivate("vertical")))}}).extend(jindo.ScrollBar),jindo.StarRating=jindo.$Class({$init:function(a,b){var c={nStep:1,nMaxValue:10,nDefaultValue:0,bSnap:!1,bActivateOnload:!0};this.option(c),this.option(b||{}),this._el=jindo.$(a),this._wel=jindo.$Element(a),this._assignHTMLElements(),this._wfMouseMove=jindo.$Fn(this._onMouseMove,this),this._wfMouseLeave=jindo.$Fn(this._onMouseLeave,this),this._wfClick=jindo.$Fn(this._onClick,this),this.option("bActivateOnload")&&this.activate()},_assignHTMLElements:function(){this._elRatingElement=jindo.$$.getSingle("span",this.getBaseElement()),this._welRatingElement=jindo.$Element(this._elRatingElement)},getBaseElement:function(){return this._el},getRatingElement:function(){return this._elRatingElement},getValue:function(){return this._nValue},getValueByWidth:function(){return this._welRatingElement.width()/this._nBaseWidth*this.option("nMaxValue")},getValueToBeSet:function(a){return a=this._round(a,this.option("nStep")),a=Math.min(a,this.option("nMaxValue")),a=Math.max(a,0)},setValue:function(a,b){"undefined"==typeof b&&(b=!0);var c=this.option("nMaxValue");a=this.getValueToBeSet(a);var d=this._nBaseWidth*a/c;return d=Math.min(d,this._nBaseWidth),this._welRatingElement.width(d),this._nValue=a,b&&this.fireEvent("set",{nValue:this._nValue}),this},reset:function(){var a=this.option("nDefaultValue")||0;return this.setValue(a,!1),this},_round:function(a,b){var c,d,e=a,f=Math.floor(a),g=f+1,h=1;for(d=f;g>=d;d+=b)c=Math.abs(a-d),h>=c&&(h=c,e=d);return e.toFixed(Math.max(b.toString().length-2,0))},_onActivate:function(){var a=this.getBaseElement();this._wfMouseMove.attach(a,"mousemove"),this._wfMouseLeave.attach(a,"mouseleave"),this._wfClick.attach(a,"click"),this._nBaseWidth=this._wel.width(),this.reset()},_onDeactivate:function(){var a=this.getBaseElement();this._wfMouseMove.detach(a,"mousemove"),this._wfMouseLeave.detach(a,"mouseleave"),this._wfClick.detach(a,"click")},_onMouseMove:function(a){var b,c=a.pos(!0).offsetX+1,d=c>this._nBaseWidth?this._nBaseWidth:c;this.option("bSnap")&&(b=c/this._nBaseWidth*this.option("nMaxValue"),d=this._round(b,this.option("nStep"))*this._nBaseWidth/this.option("nMaxValue"),d=Math.min(d,this._nBaseWidth)),this._welRatingElement.css("width",d+"px"),b=this.getValueByWidth(),this.fireEvent("move",{nValue:b,nValueToBeSet:this.getValueToBeSet(b)})},_onMouseLeave:function(){this.setValue(this._nValue,!1),this.fireEvent("out")},_onClick:function(){this.setValue(this.getValueByWidth())}}).extend(jindo.UIComponent),jindo.TabControl=jindo.$Class({_bIsActivating:!1,_nCurrentIndex:null,_welSelectedTab:null,_welSelectedPanel:null,$init:function(a,b){var c={sClassPrefix:"tc-",sCheckEvent:"click",bActivateOnload:!0};this.option(c),this.option(b||{}),this._el=jindo.$(a),this._wfEventTab=jindo.$Fn(this._onEventTab,this),this._assignHTMLElements(),this.option("bActivateOnload")&&(this._selectTab(this._elSelectedTab),this.activate())},_assignHTMLElements:function(){var a=this.option("sClassPrefix"),b=this._el;this._aTab=jindo.$$("."+a+"tab",b),this._aPanel=jindo.$$("."+a+"panel",b),this._elSelectedTab=jindo.$$.getSingle("."+a+"tab."+a+"selected",b)||this.getTab(0),this._waTab=jindo.$A(this._aTab)},getTab:function(a){return this.getTabs()[a]},getTabs:function(){return this._aTab},getPanel:function(a){return this.getPanels()[a]},getPanels:function(){return this._aPanel},selectTab:function(a,b){"undefined"==typeof b&&(b=!0),this._selectTab(this.getTab(a),b)},getIndex:function(a){return this._waTab.indexOf(a)},getCurrentIndex:function(){return this._nCurrentIndex},_selectTab:function(a,b){"undefined"==typeof b&&(b=!0);var c=this.option("sClassPrefix"),d=this.getIndex(a),e=this.getPanel(d);if(!b||this.fireEvent("beforeSelect",{nIndex:d,elTab:a,elPanel:e})){var f=jindo.$Element(a);this._welSelectedTab&&this._welSelectedTab.removeClass(c+"selected"),this._welSelectedTab=f,f.addClass(c+"selected");var g=jindo.$Element(e);this._welSelectedPanel&&this._welSelectedPanel.removeClass(c+"selected"),this._welSelectedPanel=g,g.addClass(c+"selected"),this._nCurrentIndex=d,b&&this.fireEvent("select",{nIndex:d,elTab:a,elPanel:e})}},getBaseElement:function(){return this._el},_onActivate:function(){jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(this._el).preventTapHighlight(!0),this._wfEventTab.attach(this._el,this.option("sCheckEvent"))},_onDeactivate:function(){jindo.$Element.prototype.preventTapHighlight&&jindo.$Element(this._el).preventTapHighlight(!1),this._wfEventTab.detach(this._el,this.option("sCheckEvent"))},_onEventTab:function(a){if(this.fireEvent(a.type,{weEvent:a})){var b=this.option("sClassPrefix"),c=a.element,d=jindo.$$.test(c,"."+b+"tab")?c:jindo.$$.getSingle("! ."+b+"tab",c);d&&this._selectTab(d)}}}).extend(jindo.UIComponent),jindo.NumberFormatter=jindo.$Class({$init:function(a,b){this.option({nDecimalPoint:0}),this.option(b||{}),this.attach("beforeChange",function(a){var b=a.sText,c="",d=this.option("nDecimalPoint"),e=a.sStartMark,f=a.sEndMark;if(0===d)b=b.replace(new RegExp("[^0-9"+e+f+"]","g"),""),b=b.replace(/^0+/,""),b=b.replace(new RegExp("^0*"+e+"0*"+f+"0*"),e+f);else{var g=0,h=[];b.replace(new RegExp("((?:[0-9]|"+e+f+")\\.|[0-9]|"+e+"|"+f+")","g"),function(a){/\.$/.test(a)?0==g?(g++,h.push(a)):h.push(a.replace(".","")):h.push(a)}),b=h?h.join(""):"",new RegExp("^(?:0|[0-9]\\.(?:[0-9]*?))"+e+f+"$").test(b)||(b=b.replace(/^0+/,""))}c=this._convertCurrency(b),d>0&&(c=this._limitDecimalPoint(c,d)),a.sText=c})},getValue:function(){return this._el.value.replace(new RegExp("[,"+this._aMarks[0]+this._aMarks[1]+"]+?","g"),"")},_convertCurrency:function(a){var b=0,c="",d=a.indexOf("."),e=a.length;d>-1&&(e=d-1);for(var f=a.length;f>=0;f--){var g=a.charAt(f);f>e?c=g+c:/[0-9]/.test(g)?(b>=3&&(c=","+c,b=0),b++,c=g+c):(g==this._aMarks[0]||g==this._aMarks[1])&&(c=g+c)}return c},_limitDecimalPoint:function(a,b){var c="",d=a.indexOf("."),e=a.length;if(d>-1&&(e=d-1),d=a.indexOf("."),d>-1&&b>0)for(var f=0,g=0;g<a.length;g++){var h=a.charAt(g),i=/[0-9]/.test(h);if(i){if(f==b)continue;g>d&&f++}c+=h}else c=a;return c}}).extend(jindo.Formatter),jindo.FloatingLayer=jindo.$Class({$init:function(a,b){this._el=jindo.$(a),this._wel=jindo.$Element(a),this.option({nDelay:0,nDuration:500,fEffect:jindo.Effect.easeOut,bActivateOnload:!0}),this.option(b||{}),this._htPos=this._getPosition(),this._oTransition=(new jindo.Transition).fps(60),this._oTimer=new jindo.Timer,this._wfScroll=jindo.$Fn(this._onScroll,this),this.option("bActivateOnload")&&this.activate()},getTransition:function(){return this._oTransition},getTimer:function(){return this._oTimer},_onActivate:function(){var a=this;setTimeout(function(){a._onScroll()},0),this._wfScroll.attach(window,"scroll").attach(window,"resize")},_onDeactivate:function(){this._wfScroll.detach(window,"scroll").detach(window,"resize")},_getPosition:function(){var a=this._el,b=this._wel,c=a.style.left,d=a.style.right,e=a.style.top,f=a.style.bottom,g={sAlignX:c?"left":d?"right":null,sAlignY:e?"top":f?"bottom":null},h=b.offset(),i=jindo.$Document().clientSize();switch(g.sAlignX){case"left":g.nX=h.left;break;case"right":g.nX=Math.max(i.width-h.left-b.width(),parseFloat(d))}switch(g.sAlignY){case"top":g.nY=h.top;break;case"bottom":g.nY=Math.max(i.height-h.top-b.height(),parseFloat(f))}return g},_onScroll:function(){var a=this;this._oTimer.start(function(){a._paint()},this.option("nDelay"))},_paint:function(){var a,b,c=document.documentElement||document,d=document.body,e=this._el,f=this._wel,g=this._htPos,h={},i=jindo.$Element(e).offset(),j={nX:null,nY:null};if(g.sAlignX){switch(g.sAlignX){case"left":h.x=c.scrollLeft||d.scrollLeft,a=i.left-h.x;break;case"right":h.x=(c.scrollLeft||d.scrollLeft)+jindo.$Document().clientSize().width,a=h.x-(i.left+f.width())}j.nX=parseFloat(f.css(g.sAlignX))+(g.nX-a)}if(g.sAlignY){switch(g.sAlignY){case"top":h.y=c.scrollTop||d.scrollTop,b=i.top-h.y;break;case"bottom":h.y=(c.scrollTop||d.scrollTop)+jindo.$Document().clientSize().height,b=h.y-(i.top+f.height())}j.nY=parseFloat(f.css(g.sAlignY))+(g.nY-b)}if(this.fireEvent("beforeMove",j)){var k={},l=this.option("fEffect");null!==j.nX&&(k["@"+g.sAlignX]=l(j.nX+"px")),null!==j.nY&&(k["@"+g.sAlignY]=l(j.nY+"px"));var m=this;this._oTransition.abort().start(this.option("nDuration"),e,k).start(function(){m.fireEvent("move")})}}}).extend(jindo.UIComponent),jindo.CircularRolling=jindo.$Class({$init:function(){this.refresh()},refresh:function(){return this.getTransition().abort(),this._el[this._oKeys.scrollLeft]=0,this._nDuplicateCount=0,this._nItemCount=this.getItems().length,this._nDisplayedCount=this.getDisplayedItemCount(),this.isOverflowed()&&(this._nDuplicateCount=this._nDisplayedCount<=this._nItemCount/2?1:2,this._duplicate(this._nDuplicateCount)),this},_duplicate:function(a){for(var b,c=this._elList,d=jindo.$("<"+c.tagName+">"),e=c.innerHTML,f=">"+(this._bUsedClassPrefix?"."+this.option("sClassPrefix")+"item":"li"),g=0;a>g;g++){d.innerHTML=e,b=jindo.$$(f,d);for(var h=0;h<b.length;h++)c.appendChild(b[h])}},_setStartPosition:function(a,b){var c=this._oKeys,d=a%this._nItemCount||0;if(0>a+b){var e=this._nDuplicateCount;d+this._nDisplayedCount>this._nItemCount&&(e-=1),d+=this._nItemCount*e}this._el[c.scrollLeft]=this._getPosition(d)},moveBy:function(a){if(this.isMoving())return!1;var b=a>=this._nItemCount;a%=this._nItemCount,b&&(a+=this._nItemCount),this._setStartPosition(this.getIndex(),a);var c=this.getIndex()+a;return this._move(c)?!0:!1}}).extend(jindo.Rolling),jindo.DynamicTree=jindo.$Class({$init:function(a,b){var c={sUrl:"",sRequestType:"jsonp",sRequestMethod:"get",htRequestParameter:{}};this.option(c),this.option(b||{}),this._attachEvents(),this._initAjax()},_attachEvents:function(){this.attach("beforeExpand",function(a){var b=a.element,c=this;if(!c.getNodeData(b).hasOwnProperty("_aChildren")||!c.getNodeData(b)._aChildren.length){var d=c.option("htRequestParameter");d.key=c._getNodeDataKey(b);var e={element:b,htRequestParameter:d};c.fireEvent("request",e)?c._request(e.htRequestParameter):a.stop()}})},_initAjax:function(){var a=this.option(),b=this.option("sClassPrefix"),c=a.sUrl,d=this;this._oAjax=jindo.$Ajax(c,{type:a.sRequestType,method:a.sRequestMethod,onload:function(a){try{var c={htResponseJSON:a.json()};if(!d.fireEvent("response",c))return;var e=d.createNode(c.htResponseJSON.aChildren),f=jindo.$$.getSingle("."+c.htResponseJSON.sKey,d.getRootList());if(d.getChildListOfNode(f))return;d.appendNode(f,e),jindo.$A(e).forEach(function(a){jindo.$$.getSingle("."+b+"has-child",a)&&jindo.$Element(a).addClass(b+"collapsed")})}catch(g){}}})},_request:function(a){this._oAjax.abort(),this._oAjax.request(a)},hasChild:function(a){return this._htNodeData[this._getNodeDataKey(a)].bHasChild||this.getChildNodes(a).length>0},_makeNodeData:function(a){var b=this.getNodeData(a);b.bHasChild=!1,jindo.$Element(this.getPartsOfNode(a).elItem).hasClass(this.option("sClassPrefix")+"has-child")&&(b.bHasChild=!0),this.$super._makeNodeData(a)}}).extend(jindo.Tree),jindo.Accordion=jindo.$Class({$init:function(a,b){this._el=jindo.$(a),this._wel=jindo.$Element(this._el),this.option({sClassPrefix:"accordion-",sDirection:"vertical",sExpandEvent:"click",nDefaultIndex:null,bToggle:!1,nDuration:300,nFPS:30,fExpandEffect:jindo.Effect.cubicEaseOut,fContractEffect:jindo.Effect.cubicEaseIn,nExpandDelay:0,nContractDelay:0,bActivateOnload:!0}),this.option(b||{}),this._nExpanded=null,this._oTimer=new jindo.Timer,this._oTransition=new jindo.Transition({bCorrection:!0}).fps(this.option("nFPS")),this._wfOnMouseOver=jindo.$Fn(this._onMouseOver,this),this._wfOnMouseOut=jindo.$Fn(this._onMouseOut,this),this._wfOnExpandEvent=jindo.$Fn(this._onExpandEvent,this),this.option("bActivateOnload")&&this.activate()},getBaseElement:function(){return this._el},_onActivate:function(){jindo.$Element.prototype.preventTapHighlight&&this._wel.preventTapHighlight(!0),this._wfOnExpandEvent.attach(this._el,this.option("sExpandEvent")),this._wfOnMouseOver.attach(this._el,"mouseover"),this._wfOnMouseOut.attach(this._el,"mouseout");var a=this.option("nDefaultIndex");"number"==typeof a&&this.expand(a)},_onDeactivate:function(){jindo.$Element.prototype.preventTapHighlight&&this._wel.preventTapHighlight(!1),this._wfOnExpandEvent.detach(this._el,this.option("sExpandEvent")),this._wfOnMouseOver.detach(this._el,"mouseover"),this._wfOnMouseOut.detach(this._el,"mouseout")},_getBlock:function(a){var b=this.option("sClassPrefix");return jindo.$Element(a).hasClass(b+"block")?a:jindo.$$.getSingle("! ."+b+"block",a)},_onMouseOver:function(a){var b=a.element,c=this._getBlock(b),d=c?jindo.$A(this.getAllBlocks()).indexOf(c):null;if("number"==typeof d){var e=this.getHandler(d);(e===c||b===e||jindo.$Element(b).isChildOf(e))&&this.fireEvent(a.type,{nIndex:d,elBlock:c,elHandler:e,weEvent:a})}},_onExpandEvent:function(a){var b=a.element,c=this._getBlock(b),d=c?jindo.$A(this.getAllBlocks()).indexOf(c):null;if("number"==typeof d){var e=this.getHandler(d);(e===c||b===e||jindo.$Element(b).isChildOf(e))&&(this.option("bToggle")&&this.getExpanded()===d?this.contractAll():this.expand(d))}},_onMouseOut:function(a){var b=a.element,c=this._getBlock(b),d=c?jindo.$Element(c).parent().indexOf(c):null;c&&"number"==typeof d&&this.fireEvent(a.type,{nIndex:d,elBlock:c,elHandler:this.getHandler(d),weEvent:a})},_getHeadSize:function(a){var b=this.getHead(a);return b.style.zoom=1,{width:jindo.$Element(b).width(),height:jindo.$Element(b).height()}},_getBodySize:function(a){var b=this.getBody(a);return b.style.zoom=1,{width:jindo.$Element(b).width(),height:jindo.$Element(b).height()}},getTransition:function(){return this._oTransition},expand:function(a){var b=this.getAllBlocks(),c=this;if(a=Math.max(0,Math.min(b.length,a)),this.getExpanded()===a)return this;var d={nIndex:a,elBlock:b[a],elHandler:this.getHandler(a)};if(this.fireEvent("beforeExpand",d)){var e=c.option("fExpandEffect"),f=[this.option("nDuration")];jindo.$A(b).forEach(function(b,d,g){var h=c._getHeadSize(d),i=c._getBodySize(d);switch(c.option("sDirection")){case"vertical":d==a?f.push(g[d],{"@height":e(i.height+h.height+"px")}):f.push(g[d],{"@height":e(h.height+"px")});break;case"horizontal":d==a?f.push(g[d],{"@width":e(i.width+h.width+"px")}):f.push(g[d],{"@width":e(h.width+"px")})}}),this._oTimer.abort(),this._oTimer.start(function(){c._setExpanded(a),c._oTransition.abort().queue.apply(c._oTransition,f).start(function(){c.fireEvent("expand",d)})},this.option("nExpandDelay"))}return this},expandAll:function(){return this},contractAll:function(){var a=this,b=a.option("fContractEffect"),c=[this.option("nDuration")];return jindo.$A(this.getAllBlocks()).forEach(function(d,e,f){var g=a._getHeadSize(e);switch(a.option("sDirection")){case"vertical":c.push(f[e],{"@height":b(g.height+"px")});break;case"horizontal":c.push(f[e],{"@width":b(g.width+"px")})}}),this.fireEvent("beforeContract")&&this._oTimer.start(function(){a._setExpanded(null),a._oTransition.abort().queue.apply(a._oTransition,c).start(function(){a.fireEvent("contract")})},this.option("nContractDelay")),this},_setExpanded:function(a){this._nExpanded=a},getExpanded:function(){return this._nExpanded},getBlock:function(a){return this.getAllBlocks()[a]},getAllBlocks:function(){return jindo.$$("."+this.option("sClassPrefix")+"block",this._el)},getHead:function(a){return jindo.$$.getSingle("dt",this.getBlock(a))},getBody:function(a){return jindo.$$.getSingle("dd",this.getBlock(a))},getHandler:function(a){var b=this.getHead(a);return jindo.$$.getSingle("."+this.option("sClassPrefix")+"handler",b)||b}}).extend(jindo.UIComponent),jindo.UploadQueue=jindo.$Class({_states:{NONE:"NONE",WAIT:"WAIT",PROGRESS:"PROGRESS",LOAD:"LOAD",ERROR:"ERROR"},_callbackForFlash:{buttonOver:function(){this.fireEvent("buttonOver",{element:this._elCurrentBrowseButton})},buttonOut:function(){this.fireEvent("buttonOut",{element:this._elCurrentBrowseButton})},selectFile:function(a){var b=this;if(jindo.$Agent().navigator().safari){var c=jindo.$Fn(function(){c.detach(window,"focus"),b._addQueue(a)});return c.attach(window,"focus"),window.blur(),void window.focus()}this._addQueue(a)},selectFileError:function(a){this.fireEvent("selectError",{sMessage:a})},start:function(){},progress:function(a){var b=a.sKey,c=this._getFileObj(b,a.oFile);c.state===this._states.PROGRESS&&this.fireEvent("uploadProgress",{oFile:c,sKey:b})},load:function(a){var b=a.sKey,c=this._getFileObj(b,a.oFile),d=a.sResponse;this._setDoneState(b,c,"uploadLoad",c.size,1,this._states.LOAD,d)},error:function(a){var b=a.sKey,c=this._getFileObj(b,a.oFile);this._setDoneState(b,c,"uploadError",0,0,this._states.ERROR)}},_showFlashForFlash:function(a){if(a){var b=a.offset(),c=this._getFlash();this._elDummy.style.left=b.left+"px",this._elDummy.style.top=b.top+"px",this._elDummy.style.width=c.style.width=a.width()+"px",this._elDummy.style.height=c.style.height=a.height()+"px"}else this._elDummy.style.left=this._elDummy.style.top=0,this._elDummy.style.width=this._elDummy.style.height="1px"},_createFlashForFlash:function(a){if(!this._elDummy){var b=this._elDummy=jindo.$("<div>"),c=a,d=this.option("sSwfPath"),e=jindo.$Agent();b.style.cssText="position:absolute !important; border:0 !important; padding:0 !important; margin:0 !important; overflow:hidden !important; z-index:32001 !important;",document.body.insertBefore(b,document.body.firstChild),e.flash().version>=11&&e.navigator().ie&&(d+="?"+Math.floor(1e4*Math.random()));var f={bMultiple:this.option("bMultiple"),sJSFunctionName:"jindo.UploadQueue.__flashCallback."+a,nButtonOpacity:0,sParamName:this.option("sParamName"),sURL:this.url()},g=this._getFlashHTML("UPLOADQUEUE"+c,d,50,50,{flashVars:f,wmode:"transparent"});b.innerHTML=g,this._showFlashForFlash(!1),this._getFlash=function(){return document["UPLOADQUEUE"+c]||document.all["UPLOADQUEUE"+c]}}},_destroyFlashForFlash:function(){this._elDummy.parentNode.removeChild(this._elDummy),this._elDummy=null},_getFlashHTML:function(a,b,c,d,e){var f="https:"==location.protocol?"https:":"http:",g='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"';e=e||{},e.allowScriptAccess=e.allowScriptAccess||"always";var h,i=[],j=[];for(var k in e)e.hasOwnProperty(k)&&(h=e[k],"flashVars"===k&&(h=jindo.$H(h).toQueryString()),i.push('<param name="'+k+'" value="'+h+'" />'),j.push(" "+k+'="'+h+'"'));return['<object tabindex="-1" id="'+a+'" width="'+c+'" height="'+d+'" '+g+' codebase="'+f+'//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0">','<param name="movie" value="'+b+'" />',i.join(""),'<embed tabindex="-1" name="'+a+'" src="'+b+'"',' type="application/x-shockwave-flash" pluginspage="'+f+'://www.macromedia.com/go/getflashplayer"',j.join(""),' width="'+c+'" height="'+d+'">',"</embed>","</object>"].join("")},_sendForFlash:function(a,b){if(this._getFlash){var c=this._getFlash();c[a].apply(c,b||[])}},$init:function(a,b){var c="undefined"!=typeof FormData,d=navigator.userAgent;jindo.$Agent().os().win&&/Version\/([0-9\.]+)\s+Safari\/([0-9\.]+)/.test(d)&&(c=!1),"bSupportHTML5"in b&&(c=!!b.bSupportHTML5),this._methodPostfix=c?"ForHTML5":"ForFlash",this.getMethod=function(){return c?"HTML5":"flash"},this.option({bMultiple:!0,nParallel:1,sParamName:"file",bActivateOnload:!0}),this.option(b||{}),this.url(a),this.option("bActivateOnload")&&this.activate()},_onActivate:function(){this._queue=[],this._uploading=0,this._initialize(),this._attachEvents()},_onDeactivate:function(){if(this._detachEvents(),this._browseButtons)for(var a=this._browseButtons,b=0,c=a.length;c>b;b++)a[b].deactivate();this._browseButtons=null},_getFileObj:function(){var a=this["_getFileObj"+this._methodPostfix];return(this._getFileObj=a).apply(this,arguments)},_getFileObjForHTML5:function(a,b){return b},_getFileObjForFlash:function(a,b){var c=this._flashFiles[a];if(c&&b)for(var d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);return c},_initialize:function(){var a=this["_initialize"+this._methodPostfix];return(this._initialize=a).apply(this,arguments)},_initializeForHTML5:function(){this._xhr={};var a=this.option("aButton")||[this.option("elButton")];this._browseButtons=[];for(var b=null,c=0,d=a.length;d>c;c++)this._browseButtons.push(b=new jindo.BrowseButton(a[c])),b.getFileSelect().multiple=this.option("bMultiple")},_initializeForFlash:function(){this._flashFiles={}},_detachEvents:function(){var a=this["_detachEvents"+this._methodPostfix];return(this._detachEvents=a).apply(this,arguments)},_detachEventsForHTML5:function(){var a,b,c=this._browseButtons;for(a=0,b=c.length;b>a;a++)c[a].detach(this._browseButtonHandlers),this._browseButtonHandlers=null;var d=this._aDropAreas;for(a=0,b=d.length;b>a;a++){var e=d[a];this._wfOnDragEnter.detach(e,"dragenter"),this._wfOnDragOver.detach(e,"dragover"),this._wfOnDragLeave.detach(e,"dragleave"),this._wfOnDrop.detach(e,"drop"),this._aDropAreas=null}},_detachEventsForFlash:function(){var a=this._aButtons;if(a){for(var b=0,c=a.length;c>b;b++){var d=jindo.$Element(a[b]);this._wfOnMouseMove.detach(d,"mousemove")}this._aButtons=null,this._elCurrentBrowseButton=null}var e=this._sUnique;delete jindo.UploadQueue.__flashCallback[e],this._destroyFlashForFlash(e)},_attachEvents:function(){var a=this["_attachEvents"+this._methodPostfix];return(this._attachEvents=a).apply(this,arguments)},_attachEventsForHTML5:function(){var a,b,c=this;this._browseButtonHandlers={sourceChange:function(){c._addQueue(this.getFileSelect().files),this.getFileSelect().value="";var a=jindo.$Agent().navigator();a.ie&&a.version<=10&&(this.getFileSelect().type="radio",this.getFileSelect().type="file")},over:function(){c.fireEvent("buttonOver",{element:this._el})},out:function(){c.fireEvent("buttonOut",{element:this._el})}};var d=this._browseButtons;for(a=0,b=d.length;b>a;a++)d[a].attach(this._browseButtonHandlers);var e=this.option("aDropArea")||[this.option("elDropArea")],f=!1,g=function(a,b){var d=a.currentElement;a.stopDefault(),f!==b&&(c.fireEvent(b?"dragOver":"dragOut",{element:d}),f=b)};for(this._aDropAreas=e,a=0,b=e.length;b>a;a++){var h=jindo.$(e[a]);this._wfOnDragEnter=jindo.$Fn(function(a){a.stopDefault()}).attach(h,"dragenter"),this._wfOnDragOver=jindo.$Fn(function(a){g(a,!0)}).attach(h,"dragover"),this._wfOnDragLeave=jindo.$Fn(function(a){g(a,!1)}).attach(h,"dragleave"),this._wfOnDrop=jindo.$Fn(function(a){g(a,!1),c._addQueue(a.$value().dataTransfer.files)}).attach(h,"drop")}},_attachEventsForFlash:function(){var a=this,b=this._sUnique="UQ"+(new Date).getTime()+Math.floor(1e6*Math.random());jindo.UploadQueue.__flashCallback[b]=function(b,c){var d=a._callbackForFlash[b];d&&d.apply(a,c||[])},this._createFlashForFlash(b);var c=this._aButtons=this.option("aButton")||[this.option("elButton")];this._wfOnMouseMove=jindo.$Fn(function(b){a._elCurrentBrowseButton=b.currentElement,a._showFlashForFlash(jindo.$Element(a._elCurrentBrowseButton))});for(var d=0,e=c.length;e>d;d++){var f=jindo.$Element(c[d]);this._wfOnMouseMove.attach(f,"mousemove")}},_uploadFile:function(){var a=this["_uploadFile"+this._methodPostfix];return(this._uploadFile=a).apply(this,arguments)},_uploadFileForFlash:function(a){var b=a.file,c=a.key;b.state=this._states.PROGRESS,this._uploading++,this._sendForFlash("upload",[[c]])},_uploadFileForHTML5:function(a){var b=this,c=a.file,d=a.key;c.state=this._states.PROGRESS,this._uploading++;var e=new XMLHttpRequest,f=e.upload;f.addEventListener("progress",function(a){a.lengthComputable&&b._xhr[d]&&(c.loaded=a.loaded,c.rate=a.loaded&&a.loaded/c.size,b.fireEvent("uploadProgress",{oFile:c,sKey:d}))},!1),f.addEventListener("load",function(){var a=this,f=arguments.callee;return 4!==e.readyState?void setTimeout(function(){f.call(a)},0):void(200===e.status?b._setDoneState(d,c,"uploadLoad",c.size,1,b._states.LOAD,e.responseText):b._setDoneState(d,c,"uploadError",0,0,b._states.ERROR))},!1),f.addEventListener("error",function(){b._setDoneState(d,c,"uploadError",0,0,b._states.ERROR)},!1),f.addEventListener("abort",function(){b._setDoneState(d,c,"uploadAbort",0,0,b._states.NONE)},!1),e.open("POST",this.url()),e.setRequestHeader("Cache-Control","no-cache"),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),this._xhr[d]=e,this.fireEvent("uploadStart",{oFile:c,sKey:d});var g=new FormData;return g.append(this.option("sParamName"),c),e.send(g),!0},_addQueue:function(a){var b,c;for(b=0,c=a.length;c>b;b++)a[b].ext=/\.([^\.]+)$/.test(a[b].name)&&RegExp.$1||"";if(!this.fireEvent("beforeSelect",{aFiles:a}))return!1;for(b=0,c=a.length;c>b;b++){var d=a[b],e={oFile:d,sKey:"UQ"+(new Date).getTime()+Math.round(1e5*Math.random())};if(this.fireEvent("beforeAdd",e)){var f=e.sKey;this._queue.push({key:e.sKey,file:d}),d.loaded=0,d.rate=0,d.state=this._states.NONE,this._flashFiles&&(this._flashFiles[e.sKey]=d),this._sendForFlash("setUniqueKeyAt",[b,f]),this.fireEvent("add",{oFile:d,sKey:f})}}return!0},_findQueue:function(a){for(var b=0,c=this._queue.length;c>b;b++)if(this._queue[b].key===a)return b;return-1},getInfo:function(){for(var a={size:{none:0,wait:0,progress:0,load:0,error:0,total:0},count:{none:0,wait:0,progress:0,load:0,error:0,total:0}},b=0,c=this._queue.length;c>b;b++){var d=this._queue[b].file,e=d.state.toLowerCase(),f=d.size;a.size[e]+=f,a.count[e]++,a.size.total+=f,a.count.total++}return a},remove:function(a){var b=typeof a;switch(b){case"string":var c=this._findQueue(a);return this._removeFile(c);case"function":default:for(var d=this._queue.length-1;d>=0;d--){var e=this._queue[d];("function"!==b||a.call(this,e.key,e.file))&&this._removeFile(d)}}return!0},_removeFile:function(a){var b=this._queue[a];if(!b)return!1;var c=b.file,d=b.key;return this._abortFile(a),this._queue.splice(a,1),this._flashFiles&&delete this._flashFiles[d],this._sendForFlash("remove",[[d]]),this.fireEvent("remove",{oFile:c,sKey:d}),!0},abort:function(a){var b=typeof a;switch(b){case"string":var c=this._findQueue(a);return this._abortFile(c);case"function":default:for(var d=this._queue.length-1;d>=0;d--){var e=this._queue[d];("function"!==b||a.call(this,e.key,e.file))&&this._abortFile(d)}}return!0},_abortFile:function(a){var b=this._queue[a];if(!b)return!1;var c=b.key,d=b.file;return d.state!==this._states.WAIT&&d.state!==this._states.PROGRESS?!1:(this._xhr&&this._xhr[c]&&this._xhr[c].abort(),this._sendForFlash("abort",[[c]]),this._setDoneState(c,d,"abort",0,0,this._states.NONE),!0)},reset:function(a){var b=typeof a;switch(b){case"string":var c=this._findQueue(a);return this._resetFile(c);case"function":default:for(var d=this._queue.length-1;d>=0;d--){var e=this._queue[d];("function"!==b||a.call(this,e.key,e.file))&&this._resetFile(d)}}return!0},_resetFile:function(a){var b=this._queue[a];if(!b)return!1;var c=b.key,d=b.file;return d.state!==this._states.LOAD&&d.state!==this._states.ERROR?!1:(d.state=this._states.NONE,this.fireEvent("reset",{oFile:d,sKey:c}),!0)},upload:function(a){var b=typeof a,c=a;switch(b){case"string":b="function",a=function(a){return c===a};case"function":default:for(var d=this._queue.length-1;d>=0;d--){var e=this._queue[d];"function"===b&&!a.call(this,e.key,e.file)||e.file.state!==this._states.NONE||(e.file.state=this._states.WAIT,this.fireEvent("wait",{oFile:e.file,sKey:e.key}))}}return this._startUploadFile(),!0},_startUploadFile:function(){var a=this.option("nParallel");if(this._uploading>=a)return!1;for(var b=!0,c=0,d=this._queue.length;d>c;c++){var e=this._queue[c];e.file.state===this._states.WAIT?(b=!1,this._uploading<a&&this._uploadFile(e)):e.file.state===this._states.PROGRESS&&(b=!1)}return b},_setDoneState:function(a,b,c,d,e,f,g){if(b.state!==f){if("uploadLoad"===c&&!this.fireEvent("beforeUploadLoad",{oFile:b,sKey:a,sResponseText:g}))return this._setDoneState(a,b,"uploadError",0,0,this._states.ERROR);var h=b.state===this._states.PROGRESS;b.loaded=d,b.rate=e,b.state=f,this._xhr&&delete this._xhr[a],this.fireEvent(c,{oFile:b,sKey:a}),h&&this._uploading--;var i=this._startUploadFile();this.fireEvent("uploadEnd",{oFile:b,sKey:a,bFinish:i})}},url:function(a){return arguments.length?(this._url=a,this):this._url}}).extend(jindo.UIComponent),jindo.UploadQueue.__flashCallback={},jindo.Visible=jindo.$Class({$init:function(a,b){this._elWrap=jindo.$(a)||document,this._nTimer=null,this.option({sClassName:"check_visible",nExpandSize:0}),this.option(b||{}),this.refresh()},_supportGetElementsByClassName:function(){var a=this.constructor;return"__supportGetElementsByClassName"in a||(a.__supportGetElementsByClassName=function(){var a=document.createElement("div");if(!a.getElementsByClassName)return!1;var b=a.getElementsByClassName("dummy");return a.innerHTML='<span class="dummy"></span>',1===b}()),a.__supportGetElementsByClassName},refresh:function(){return this._supportGetElementsByClassName()?(this._aTargets=this._elWrap.getElementsByClassName(this.option("sClassName")),this.refresh=function(){}):this._aTargets=jindo.$$("."+this.option("sClassName"),this._elWrap),this},check:function(a){var b=this;return"undefined"==typeof a&&(a=-1),this._nTimer&&(clearTimeout(this._nTimer),this._nTimer=null),0>a?this._check():this._nTimer=setTimeout(function(){b._check(),b._nTimer=null},a),this},_check:function(){var a,b=(new Date,null),c=this._elWrap,d=this._aTargets,e=this.option("nExpandSize"),f={"true":0,"false":0};
if(c===document){var g=jindo.$Document(document),h=g.clientSize();b={top:0,left:0,bottom:h.height,right:h.width}}else b=c.getBoundingClientRect(),b={top:b.top,left:b.left,bottom:b.bottom,right:b.right};b.top-=e,b.left-=e,b.bottom+=e,b.right+=e;var i=[];for(a=d.length-1;a>=0;a--){var j=d[a],k=j.getBoundingClientRect();if(this._bSupportQSA||jindo.$Element(j).hasClass(this.option("sClassName"))){var l=!!j.__VISIBLE,m=!(k.bottom<b.top||b.bottom<k.top||k.right<b.left||b.right<k.left);j.__VISIBLE=m,l!==m?(i.push([m,j]),f[!m]++):f[m]++}else delete j.__VISIBLE,d.splice(a,1)}for(a=i.length-1;a>=0;a--){var n=i[a];f[!n[0]]--,f[n[0]]++,this.fireEvent(n[0]?"visible":"invisible",{elTarget:n[1],nVisible:f["true"],nInvisible:f["false"]})}}}).extend(jindo.Component),jindo.WatchInput=jindo.$Class({_bTimerRunning:!1,_bFocused:!1,_sPrevValue:"",$init:function(a,b){var c={nInterval:100,bUseTimerOnIE:!1,sKeyEvent:"keyup",bPermanent:!1,bActivateOnload:!0};this.option(c),this.option(b||{}),this._elInput=jindo.$(a),this._oTimer=new jindo.Timer,this._bIE=jindo.$Agent().navigator().ie,this._wfFocus=jindo.$Fn(this._onFocus,this),this._wfBlur=jindo.$Fn(this._onBlur,this),this._wfKeyEvent=jindo.$Fn(this._onKeyEvent,this),this._wfStartTimer=jindo.$Fn(this._startTimer,this),this._wfStopTimer=jindo.$Fn(this._stopTimer,this),this.option("bActivateOnload")&&this.activate(!0)},getInput:function(){return this._elInput},setInputValue:function(a){return this.getInput().value=a,this.setCompareValue(a),this},getCompareValue:function(){return this._sPrevValue},setCompareValue:function(a){return this._sPrevValue=a,this},fireChangeEvent:function(){var a=this.getInput(),b=a.value;return this.setCompareValue(b),this.fireEvent("change",{elInput:a,sText:b}),this},start:function(a){return this.activate(a||!1)},stop:function(){return this.deactivate()},_onActivate:function(a){this.setCompareValue("");var b=this.getInput();if(this._wfFocus.attach(b,"focus"),this._bIE&&!this.option("bUseTimerOnIE"))this.fireEvent("start"),this._wfKeyEvent.attach(b,this.option("sKeyEvent"));else{if(this._isTimerRunning())return;this.fireEvent("start"),this.option("bPermanent")?this._startTimer():(this._wfStartTimer.attach(b,"focus"),this._wfStopTimer.attach(b,"blur"))}this._wfBlur.attach(b,"blur"),a&&this.compare()},_onDeactivate:function(){var a=this.getInput();this._wfFocus.detach(a,"focus"),this._wfKeyEvent.detach(a,this.option("sKeyEvent")),this._stopTimer(),this._wfStartTimer.detach(a,"focus"),this._wfStopTimer.detach(a,"blur"),this._wfBlur.detach(a,"blur"),this.fireEvent("stop")},getInterval:function(){return this.option("nInterval")},setInterval:function(a){return this.option("nInterval",a),this},_isTimerRunning:function(){return this._bTimerRunning},_startTimer:function(){if(!this._isTimerRunning()){this._bTimerRunning=!0,this.fireEvent("timerStart"),this.compare();var a=this;this._oTimer.start(function(){return a.compare(),!0},this.getInterval())}},_stopTimer:function(){this._isTimerRunning()&&(this._oTimer.abort(),this._bTimerRunning=!1,this.compare(),this.fireEvent("timerStop"))},_onKeyEvent:function(){this.compare()},_onFocus:function(){this._bFocused=!0,this.fireEvent("focus")},_onBlur:function(){this._bFocused=!1,this.fireEvent("blur")},compare:function(){return this.getInput().value!=this.getCompareValue()&&this.fireChangeEvent(),this}}).extend(jindo.UIComponent);